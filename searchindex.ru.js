var relearn_searchindex = [
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è",
    "content": "–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –æ–Ω–∏ –ø–æ—è–≤—è—Ç—Å—è üòÄ",
    "description": "–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –æ–Ω–∏ –ø–æ—è–≤—è—Ç—Å—è üòÄ",
    "tags": [],
    "title": "–°–ø–∏—Å–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤ –∫ —ç–∫–∑–∞–º–µ–Ω—É –ø–æ –∫—É—Ä—Å—É –æ—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –°–ü–±–ì–£, –≤–µ—Å–µ–Ω–Ω–∏–π —Å–µ–º–µ—Å—Ç—Ä, 2025/26 —É—á–µ–±–Ω—ã–π –≥–æ–¥",
    "uri": "/basics/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.",
    "content": "–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —á–∏—Å–µ–ª –§–∏–±–æ–Ω–∞—á—á–∏ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á–∏—Å–µ–ª –§–∏–±–æ–Ω–∞—á—á–∏\n$$ 1,1,2,3,5,8,13,21,34,55,89, \\ldots $$–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:\n–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —á–∏—Å–µ–ª –§–∏–±–æ–Ω–∞—á—á–∏ $F_{n}$ - $n$-–æ–µ —á–∏—Å–ª–æ –§–∏–±–æ–Ω–∞—á—á–∏, –≥–¥–µ $F_{0}=F_{1}=1, F_{n}=F_{n-1}+F_{n-2}, n\u003e1 .$\n–ß–∏—Å–ª–∞ –§–∏–±–æ–Ω–∞—á—á–∏ —Ä–∞—Å—Ç—É—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ:\n–õ–µ–º–º–∞ $2^{\\lfloor n / 2\\rfloor} \\leqslant F_{n} \\leqslant 2^{n}$. –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –î–æ–∫–∞–∂–µ–º —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ –∏–Ω–¥—É–∫—Ü–∏–∏.\n–ë–∞–∑–∞. –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–µ—Ä–Ω–æ –¥–ª—è $n=0,1$.\n–ü–µ—Ä–µ—Ö–æ–¥. –ü—É—Å—Ç—å $n\u003e1$, —Ç–æ–≥–¥–∞ $F_{n}=F_{n-1}+F_{n-2} \\leqslant 2^{n-1}+2^{n-2}\u003c2^{n}$.\n–° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, $F_{n} \\geqslant 2 \\cdot F_{n-2} \\geqslant 2 \\cdot 2^{\\lfloor(n-2) / 2\\rfloor}=2^{\\lfloor n / 2\\rfloor}$.\n–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –°–ª–µ–¥—É—é—â–∏–π —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –≤—ã—á–∏—Å–ª—è–µ—Ç $n$-–æ–µ —á–∏—Å–ª–æ –§–∏–±–æ–Ω–∞—á—á–∏, —Ç–æ—á–Ω–æ —Å–ª–µ–¥—É—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é: ‚Äã python c++ 1 2 3 4 def fib(n: int) -\u003e int: if n \u003c= 1: return 1 return fib(n - 1) + fib(n - 2) 1 2 3 4 5 int fib(int n) { if (n \u003c= 1) return 1; return fib(n - 1) + fib(n - 2); } –ö–∞–∫–æ–≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —ç—Ç–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞? –û—Ü–µ–Ω–∏–º $T(n)$ - —Å—É–º–º–∞—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–∑–æ–≤–æ–≤ fib , –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–∏—Ö –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ $\\mathrm{fib}(\\mathrm{n})$ : –µ—Å–ª–∏ $n \\leqslant 1$, —Ç–æ $T(n)=1$; –∏–Ω–∞—á–µ\n$$ T(n)=1+T(n-1)+T(n-2) . $$–ù–µ—Å–ª–æ–∂–Ω–æ –¥–æ–∫–∞–∑–∞—Ç—å –ø–æ –∏–Ω–¥—É–∫—Ü–∏–∏, —á—Ç–æ $F_{n} \\leqslant T(n)\u003c2 F_{n}$. –í –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ fib —Å–æ–≤–µ—Ä—à–∞–µ—Ç—Å—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ (—Å–∫–∞–∂–µ–º, –Ω–µ –±–æ–ª—å—à–µ –ø—è—Ç–∏) –æ–ø–µ—Ä–∞—Ü–∏–π, –ø–æ—ç—Ç–æ–º—É –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø—Ä–∏–º–µ—Ä–Ω–æ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ $F_{n}$ (—á—É—Ç—å –ø–æ–∑–∂–µ —É –Ω–∞—Å –ø–æ—è–≤–∏—Ç—Å—è —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç—Ç–æ–≥–æ ‚Äú–ø—Ä–∏–º–µ—Ä–Ω–æ‚Äù).\n–ò–∑ –ª–µ–º–º—ã —Å–ª–µ–¥—É–µ—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ, $F_{300} \\geqslant 2^{150}\u003e10^{45}$. –ù–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ, –≤—ã–ø–æ–ª–Ω—è—é—â–µ–º $10^{9}$ –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Å–µ–∫—É–Ω–¥—É, fib(300) –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –±–æ–ª—å—à–µ $10^{36}$ —Å–µ–∫—É–Ω–¥.\n–ü–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –¥–µ—Ä–µ–≤–æ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ fib. –í–∏–¥–Ω–æ, —á—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º –º–Ω–æ–≥–æ —Ä–∞–∑ –≤—ã—á–∏—Å–ª—è–µ—Ç –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ. –î–∞–≤–∞–π—Ç–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤ –º–∞—Å—Å–∏–≤: ‚Äã python c++ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 def fibFast(n: int) -\u003e int: \"\"\" Calculate nth Fibonacci number using dynamic programming. Args: n: Non-negative integer index Returns: nth Fibonacci number (F(0)=1, F(1)=1, F(2)=2, ...) \"\"\" if n \u003c= 1: return 1 # Create array with indices 0..n f = [0] * (n + 1) f[0] = f[1] = 1 for i in range(2, n + 1): f[i] = f[i - 1] + f[i - 2] return f[n] 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 /** * Calculate nth Fibonacci number using dynamic programming. * * @param n Non-negative integer index * @return nth Fibonacci number (F(0)=1, F(1)=1, F(2)=2, ...) */ int fibFast(int n) { if (n \u003c= 1) { return 1; } // Create array with indices 0..n std::vector\u003cint\u003e f(n + 1); f[0] = f[1] = 1; for (int i = 2; i \u003c= n; i++) { f[i] = f[i - 1] + f[i - 2]; } return f[n]; } –ù–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ü–∏–∫–ª–∞ —Å–æ–≤–µ—Ä—à–∞–µ—Ç—Å—è –æ–¥–Ω–æ —Å–ª–æ–∂–µ–Ω–∏–µ, –≤—Å–µ–≥–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –ø—Ä–∏–º–µ—Ä–Ω–æ $n$, –ø–æ—ç—Ç–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–∂–µ–Ω–∏–π, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã—Ö –≤ —Ö–æ–¥–µ –Ω–æ–≤–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞, –ø—Ä–∏–º–µ—Ä–Ω–æ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ $n$. –ï—Å—Ç—å –µ—â—ë –æ–¥–Ω–∞ —Ç–æ–Ω–∫–æ—Å—Ç—å - –∏–∑ –ª–µ–º–º—ã —Å–ª–µ–¥—É–µ—Ç, —á—Ç–æ –¥–≤–æ–∏—á–Ω–∞—è –∑–∞–ø–∏—Å—å $F_{n}$ –∏–º–µ–µ—Ç –¥–ª–∏–Ω—É –ø–æ—Ä—è–¥–∫–∞ $n$. –ß—É—Ç—å –ø–æ–∑–∂–µ –º—ã —É–≤–∏–¥–∏–º, —á—Ç–æ —Å–ª–æ–∂–µ–Ω–∏–µ –¥–≤—É—Ö $n$-–±–∏—Ç–æ–≤—ã—Ö —á–∏—Å–µ–ª —Ç—Ä–µ–±—É–µ—Ç –ø–æ—Ä—è–¥–∫–∞ $n$ —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, –∑–Ω–∞—á–∏—Ç –æ–±—â–µ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –Ω–æ–≤–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø—Ä–∏–º–µ—Ä–Ω–æ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ $n^{2}$. –° –ø–æ–º–æ—â—å—é fibFast –º–æ–∂–Ω–æ —É–∂–µ –∑–∞ —Ä–∞–∑—É–º–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã—á–∏—Å–ª–∏—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ $F_{300}$, –Ω–æ –∏ $F_{100000}$.\n–û-—Å–∏–º–≤–æ–ª–∏–∫–∞ –•–æ—Ä–æ—à–æ —Å–µ–±—è –∑–∞—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–ª –∏ —Å—Ç–∞–ª –æ–±—â–µ–ø—Ä–∏–Ω—è—Ç—ã–º —Å–ª–µ–¥—É—é—â–∏–π –ø–æ–¥—Ö–æ–¥ - –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –Ω–µ–∫–æ—Ç–æ—Ä–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –æ—Ç –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –ø—Ä–∏ —ç—Ç–æ–º –ø—Ä–µ–Ω–µ–±—Ä–µ–≥–∞—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –º–Ω–æ–∂–∏—Ç–µ–ª—è–º–∏. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—ã –º–µ–∂–¥—É —Å–æ–±–æ–π, –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –Ω—É–∂–Ω–æ –∑–∞–Ω–∏–º–∞—Ç—å—Å—è —Ç–æ—á–Ω—ã–º –ø–æ–¥—Å—á—ë—Ç–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π. –ü—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫ –º—ã –∏ —Ä–∞—Å—Å—É–∂–¥–∞–ª–∏ –æ–± –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —á–∏—Å–µ–ª –§–∏–±–æ–Ω–∞—á—á–∏. –í–≤–µ–¥—ë–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –ø—Ä–æ–≤–æ–¥–∏—Ç—å –ø–æ–¥–æ–±–Ω—ã–µ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è –±–æ–ª–µ–µ –∫—Ä–∞—Ç–∫–æ –∏ —Ç–æ—á–Ω–æ.\n‚úçÔ∏è –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ - —ç—Ç–æ, –∫–æ–Ω–µ—á–Ω–æ, –≤—Å–µ–≥–¥–∞ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è. –¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, –º—ã –¥–∞—ë–º —Å–ª–µ–¥—É—é—â–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏—Ö –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –ø–æ—Å–∫–æ–ª—å–∫—É —Ç–∞–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —á–∞—Å—Ç–æ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π.\n–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ $O$, $\\Omega$, $\\Theta$ –†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ñ—É–Ω–∫—Ü–∏–∏ $f, g: \\mathbb{N} \\rightarrow \\mathbb{R}$.\n$f=O(g)$, –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Ç–∞–∫–∏–µ $C\u003e0, N\u003e0$, —á—Ç–æ –¥–ª—è –ª—é–±–æ–≥–æ $n\u003eN$ : $|f(n)| \\leqslant C \\cdot|g(n)|$. $f=\\Omega(g)$, –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Ç–∞–∫–∏–µ $C\u003e0, N\u003e0$, —á—Ç–æ –¥–ª—è –ª—é–±–æ–≥–æ $n\u003eN$ : $|f(n)| \\geqslant C \\cdot|g(n)|$. $f=\\Theta(g)$, –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Ç–∞–∫–∏–µ $C_{1}\u003e0, C_{2}\u003e0, N\u003e0$, —á—Ç–æ –¥–ª—è –ª—é–±–æ–≥–æ $n\u003eN$ : $C_{1} \\cdot|g(n)| \\leqslant|f(n)| \\leqslant C_{2} \\cdot|g(n)|$. ‚úçÔ∏è –ó–∞–ø–∏—Å—å $f=O(g)$ –º–æ–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –∫–∞–∫ \" $|f| \\leqslant|g|$ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã\". –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, $\\Omega(\\cdot)$ –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –∞–Ω–∞–ª–æ–≥–æ–º $\\geqslant$, –∞ $\\Theta(\\cdot)$ - –∞–Ω–∞–ª–æ–≥–æ–º $=$. –ï—â—ë –æ–¥–∏–Ω —Å–ø–æ—Å–æ–± –ø–æ–Ω–∏–º–∞—Ç—å –∑–∞–ø–∏—Å—å $f=O(g)$ - –æ—Ç–Ω–æ—à–µ–Ω–∏–µ $\\frac{|f(n)|}{|g(n)|}$ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ —Å–≤–µ—Ä—Ö—É –Ω–µ–∫–æ—Ç–æ—Ä–æ–π –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π.\n–ú–Ω–æ–≥–∏–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è $\\leqslant,=, \\geqslant$ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∏ –¥–ª—è –∏—Ö –∞—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∏—Ö –∞–Ω–∞–ª–æ–≥–æ–≤. –°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–µ–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ —ç—Ç–∏—Ö —Å–≤–æ–π—Å—Ç–≤:\n–°–≤–æ–π—Å—Ç–≤–∞ $f=\\Theta(g)$ —Ç–æ–≥–¥–∞ –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ $f=O(g)$ –∏ $f=\\Omega(g)$. $f=O(g)$ —Ç–æ–≥–¥–∞ –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ $g=\\Omega(f)$. $f=\\Theta(g)$ —Ç–æ–≥–¥–∞ –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ $g=\\Theta(f)$. –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –î–æ–∫–∞–∂–µ–º –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞ –ø. 2.\n–ü—É—Å—Ç—å $C\u003e0$, —Ç–æ–≥–¥–∞ $|f(n)| \\leqslant C \\cdot|g(n)|$ —Ä–∞–≤–Ω–æ—Å–∏–ª—å–Ω–æ $|g(n)| \\geqslant \\frac{1}{C} \\cdot|f(n)|$.\n–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, $f=O(g)$ —Å –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π $C$ —Ç–æ–≥–¥–∞ –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ $g=\\Omega(f)$ —Å –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π $\\frac{1}{C}$.\n–°—É—â–µ—Å—Ç–≤—É—é—Ç —Ç–∞–∫–∂–µ –∞—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∏–µ –∞–Ω–∞–ª–æ–≥–∏ $\u003c$ –∏ $\u003e: o(\\cdot)$ –∏ $\\omega(\\cdot)$. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ o, $\\omega$ –†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ñ—É–Ω–∫—Ü–∏–∏ $f, g: \\mathbb{N} \\rightarrow \\mathbb{R}$.\n$f=o(g)$, –µ—Å–ª–∏ –¥–ª—è –ª—é–±–æ–≥–æ $C\u003e0$ –Ω–∞–π–¥—ë—Ç—Å—è —Ç–∞–∫–æ–µ $N\u003e0$, —á—Ç–æ –¥–ª—è –ª—é–±–æ–≥–æ $n\u003eN$ : $|f(n)| \\leqslant C \\cdot|g(n)|$.\n$f=\\omega(g)$, –µ—Å–ª–∏ –¥–ª—è –ª—é–±–æ–≥–æ $C\u003e0$ –Ω–∞–π–¥—ë—Ç—Å—è —Ç–∞–∫–æ–µ $N\u003e0$, —á—Ç–æ –¥–ª—è –ª—é–±–æ–≥–æ $n\u003eN$ : $|f(n)| \\geqslant C \\cdot|g(n)|$.\n‚úçÔ∏è –ó–∞–ø–∏—Å—å $f=o(g)$ –º–æ–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –∫–∞–∫ ‚Äú–æ—Ç–Ω–æ—à–µ–Ω–∏–µ $\\frac{|f(n)|}{|g(n)|}$ —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ –Ω—É–ª—é —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º $n$ ‚Äú, –∞ –∑–∞–ø–∏—Å—å $f=\\omega(g)$ - –∫–∞–∫ ‚Äú–æ—Ç–Ω–æ—à–µ–Ω–∏–µ $\\frac{|f(n)|}{|g(n)|}$ —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏ —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º $n$ ‚Äú.\n–°–≤–æ–π—Å—Ç–≤–∞ 1.2.2 $f=o(g)$ —Ç–æ–≥–¥–∞ –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ $g=\\omega(f)$. –ï—Å–ª–∏ $f=O(g)$ –∏ $g=O(h)$, —Ç–æ $f=O(h)$. –¢–æ –∂–µ –≤–µ—Ä–Ω–æ –¥–ª—è $\\Omega, \\Theta, o, \\omega$. –ï—Å–ª–∏ $f=O(g), g=o(h)$, —Ç–æ $f=o(h)$. –ï—Å–ª–∏ $f=\\Omega(g), g=\\omega(h)$, —Ç–æ $f=\\omega(h)$. –ï—Å–ª–∏ $f=O(h)$ –∏ $g=O(h)$, —Ç–æ $f+g=O(h)$. –¢–æ –∂–µ –≤–µ—Ä–Ω–æ –¥–ª—è $o$. –ï—Å–ª–∏ $f, g \\geqslant 0$, —Ç–æ —Ç–æ –∂–µ –≤–µ—Ä–Ω–æ –∏ –¥–ª—è $\\Omega, \\Theta, \\omega$. –ï—Å–ª–∏ $f=o(g)$, —Ç–æ $f+g=\\Theta(g)$. –ï—Å–ª–∏ $f, g \\geqslant 0, f=O(g)$, —Ç–æ $f+g=\\Theta(g)$. –î–ª—è –ª—é–±–æ–≥–æ $C \\neq 0$ –≤–µ—Ä–Ω–æ $C \\cdot f=\\Theta(f)$. ‚úçÔ∏è –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ —É –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ç—Ä—ë—Ö —Å–≤–æ–π—Å—Ç–≤ –Ω–µ—Ç –∞–Ω–∞–ª–æ–≥–æ–≤ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è.\n–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –î–æ–∫–∞–∂–µ–º –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞ –ø. 3 (–≤–∞—Ä–∏–∞–Ω—Ç —Å $O$ –∏ $–æ$).\n–ù—É–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –¥–ª—è –ª—é–±–æ–≥–æ $C\u003e0$ –Ω–∞–π–¥—ë—Ç—Å—è $N\u003e0$, —á—Ç–æ –¥–ª—è –ª—é–±–æ–≥–æ $n\u003eN$ : $|f(n)| \\leqslant C \\cdot|h(n)|$. –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–µ–º $C\u003e0$.\n$f=O(g)$, –ø–æ—ç—Ç–æ–º—É –Ω–∞–π–¥—É—Ç—Å—è $C_{1}\u003e0, N_{1}\u003e0$, —á—Ç–æ –¥–ª—è –ª—é–±–æ–≥–æ $n\u003eN_{1}:|f(n)| \\leqslant C_{1} \\cdot|g(n)|$. $g=o(h)$, –ø–æ—ç—Ç–æ–º—É –Ω–∞–π–¥—ë—Ç—Å—è —Ç–∞–∫–æ–µ $N_{2}\u003e0$, —á—Ç–æ –¥–ª—è –ª—é–±–æ–≥–æ $n\u003eN_{2}:|g(n)| \\leqslant \\frac{C}{C_{1}} \\cdot|h(n)|$.\n–¢–æ–≥–¥–∞ –¥–ª—è –ª—é–±–æ–≥–æ $n\u003e\\max \\left(N_{1}, N_{2}\\right):|f(n)| \\leqslant C_{1} \\cdot|g(n)| \\leqslant C_{1} \\cdot \\frac{C}{C_{1}} \\cdot|h(n)|=C \\cdot|h(n)|$.\n–í–µ—Ä–Ω–µ–º—Å—è –∫ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —á–∏—Å–µ–ª –§–∏–±–æ–Ω–∞—á—á–∏. –ü–æ–ª—å–∑—É—è—Å—å –Ω–æ–≤—ã–º–∏ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è–º–∏, –º—ã –ø–æ–∫–∞–∑–∞–ª–∏, —á—Ç–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã fibFast(n) –º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –∫–∞–∫ $O\\left(n^{2}\\right)$. –ü—Ä–∏ —ç—Ç–æ–º –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã $\\mathrm{fib}(\\mathrm{n})$ –º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å (—Å–≤–µ—Ä—Ö—É) –∫–∞–∫ $O\\left(2^{n} \\cdot n\\right)$, –∏ (—Å–Ω–∏–∑—É) –∫–∞–∫ $\\Omega\\left(2^{\\lfloor n / 2\\rfloor}\\right)$.\n–ú–Ω–æ–≥–æ—á–ª–µ–Ω—ã, —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç—ã –∏ –ª–æ–≥–∞—Ä–∏—Ñ–º—ã –û—á–µ–Ω—å —á–∞—Å—Ç–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —É–¥–∞—ë—Ç—Å—è –æ—Ü–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–µ–π, —è–≤–ª—è—é—â–µ–π—Å—è –∫–æ–º–±–∏–Ω–∞—Ü–∏–µ–π –∫–∞–∫–∏—Ö-—Ç–æ –∏–∑ —Ç—Ä—ë—Ö –±–∞–∑–æ–≤—ã—Ö —Ç–∏–ø–æ–≤: –º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–≤, —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç –∏ –ª–æ–≥–∞—Ä–∏—Ñ–º–æ–≤. –¢–∞–∫, –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã fibFast –º—ã –æ—Ü–µ–Ω–∏–ª–∏ –º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–º $n^{2}$, –∞ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã fib - –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç—ã –Ω–∞ –º–Ω–æ–≥–æ—á–ª–µ–Ω: $2^{n} \\cdot n$. –í —Å–≤—è–∑–∏ —Å —ç—Ç–∏–º –ø–æ–ª–µ–∑–Ω–æ –∏–∑—É—á–∏—Ç—å –∞—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ —ç—Ç–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –Ω–∞—É—á–∏—Ç—å—Å—è —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –∏—Ö –º–µ–∂–¥—É —Å–æ–±–æ–π.\n–õ–µ–º–º–∞ –æ–± –∏–µ—Ä–∞—Ä—Ö–∏–∏ —Ä–æ—Å—Ç–∞ —Å—Ç–µ–ø–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –î–ª—è –ª—é–±—ã—Ö $l\u003ek$ –≤–µ—Ä–Ω–æ $n^{k}=o\\left(n^{l}\\right)$. –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –î–ª—è –ª—é–±–æ–≥–æ $C\u003e0$, –ø—Ä–∏ $n \\geqslant\\left(\\frac{1}{C}\\right)^{\\frac{1}{l-k}}$ –≤–µ—Ä–Ω–æ\n$$ n^{k} \\leqslant C \\cdot \\frac{1}{C} \\cdot n^{k} \\leqslant C \\cdot n^{l-k} \\cdot n^{k}=C \\cdot n^{l} $$ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ú–Ω–æ–≥–æ—á–ª–µ–Ω - —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å –≤ –≤–∏–¥–µ\n$$ f(n)=a_{0}+a_{1} n+a_{2} n^{2}+\\cdots+a_{d} n^{d} $$–¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ $d \\geqslant 0$, —Ç–∞–∫, —á—Ç–æ $a_{d} \\neq 0$. –≠—Ç–æ $d$ –Ω–∞–∑—ã–≤–∞—é—Ç —Å—Ç–µ–ø–µ–Ω—å—é –º–Ω–æ–≥–æ—á–ª–µ–Ω–∞ –∏ –æ–±–æ–∑–Ω–∞—á–∞—é—Ç –∫–∞–∫ $\\operatorname{deg}(f)$.\n–°–ª–µ–¥—Å—Ç–≤–∏–µ –ü—É—Å—Ç—å $f(n)$ - –º–Ω–æ–≥–æ—á–ª–µ–Ω —Å—Ç–µ–ø–µ–Ω–∏ $d$. –¢–æ–≥–¥–∞ $f(n)=\\Theta\\left(n^{d}\\right)$. –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –ü—É—Å—Ç—å $f(n) = a_{0} + a_{1} n + a_{2} n^{2} + \\cdots + a_{d} n^{d}$. –ò–∑ –ª–µ–º–º—ã 1.3.1 –∏ –ø. 6 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è 1.2.2 —Å–ª–µ–¥—É–µ—Ç, —á—Ç–æ $a_{j} n^{j} = o\\left(n^{d}\\right)$ –¥–ª—è –ª—é–±–æ–≥–æ $0 \\leqslant j",
    "description": "–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —á–∏—Å–µ–ª –§–∏–±–æ–Ω–∞—á—á–∏ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á–∏—Å–µ–ª –§–∏–±–æ–Ω–∞—á—á–∏\n$$ 1,1,2,3,5,8,13,21,34,55,89, \\ldots $$–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:\n–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —á–∏—Å–µ–ª –§–∏–±–æ–Ω–∞—á—á–∏ $F_{n}$ - $n$-–æ–µ —á–∏—Å–ª–æ –§–∏–±–æ–Ω–∞—á—á–∏, –≥–¥–µ $F_{0}=F_{1}=1, F_{n}=F_{n-1}+F_{n-2}, n\u003e1 .$\n–ß–∏—Å–ª–∞ –§–∏–±–æ–Ω–∞—á—á–∏ —Ä–∞—Å—Ç—É—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ:\n–õ–µ–º–º–∞ $2^{\\lfloor n / 2\\rfloor} \\leqslant F_{n} \\leqslant 2^{n}$. –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –î–æ–∫–∞–∂–µ–º —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ –∏–Ω–¥—É–∫—Ü–∏–∏.",
    "tags": [],
    "title": "1. –ê–Ω–∞–ª–∏–∑ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤",
    "uri": "/basics/complexity/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.¬†\u003e¬†17. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ",
    "content": "–ü—É—Å—Ç—å –¥–∞–Ω—ã –¥–≤–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —á–∏—Å–µ–ª (—Å–∏–º–≤–æ–ª–æ–≤) $a_{1}, \\ldots, a_{n}$ –∏ $b_{1}, \\ldots, b_{m}$. –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–π—Ç–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å $c$ –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ–π –¥–ª–∏–Ω—ã, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –±—ã –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ $a$, –∏ $b$. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π $2,1,2,3,1,2$ –∏ $2,3,2,2,1$ –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã $-2,2,2 ; 2,3,2 ; 2,3,1$ –∏ $2,2,1$.\n–ü—É—Å—Ç—å $l[i, j]$ - –¥–ª–∏–Ω–∞ –Ω–∞–∏–±–æ–ª—å—à–µ–π –æ–±—â–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–ù–û–ü, longest common subsequence, LCS) –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π $a_{1}, \\ldots, a_{i}$ –∏ $b_{1}, \\ldots, b_{j}$. –ù–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: $l[i, 0]=$ $l[0, j]=0$. –ù–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç $l[n, m]$.\n–ö–∞–∫ –≤—ã—á–∏—Å–ª–∏—Ç—å $l[i, j]$ ? –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ $a_{i}$ –∏ $b_{j}$ : –ª–∏–±–æ –æ–¥–∏–Ω –∏–∑ –Ω–∏—Ö –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ –æ—Ç–≤–µ—Ç (—Ç–æ –µ—Å—Ç—å $l[i, j]=l[i-1, j]$ –∏–ª–∏ $l[i, j]=l[i, j-1]$ ), –ª–∏–±–æ –æ–Ω–∏ –æ–±–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –æ—Ç–≤–µ—Ç–∞, —Ç–æ–≥–¥–∞ $l[i, j]=l[i-1, j-1]+1$. –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–ª—É—á–∞–π –≤–æ–∑–º–æ–∂–µ–Ω –ª–∏—à—å –ø—Ä–∏ $a_{i}=b_{j}$. –ü–æ—Å–∫–æ–ª—å–∫—É –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –Ω–∞–∏–±–æ–ª—å—à–∞—è –æ–±—â–∞—è –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –Ω—É–∂–Ω–æ –≤–∑—è—Ç—å –º–∞–∫—Å–∏–º—É–º –ø–æ –≤—Å–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–º –ø–µ—Ä–µ—Ö–æ–¥–∞–º. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –µ—Å–ª–∏ –º—ã –±—É–¥–µ–º –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –ø–æ—Ä—è–¥–∫–µ —É–≤–µ–ª–∏—á–µ–Ω–∏—è $i$, –∞ –ø–æ—Ç–æ–º $j$, —Ç–æ –∫ –º–æ–º–µ–Ω—Ç—É —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è $(i, j)$ —Å–æ—Å—Ç–æ—è–Ω–∏—è $(i-1, j),(i, j-1)$ –∏ $(i-1, j-1)$ —É–∂–µ –±—É–¥—É—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω—ã. –ü–æ–ª—É—á–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O(n m)$.\n1 2 3 4 5 6 fill(l, 0) for i = 1..n: for j = 1..m: l[i, j] = max(l[i - 1, j], l[i, j - 1]) if a[i] == b[j]: l[i, j] = max(l[i, j], l[i - 1, j - 1] + 1) –ó–Ω–∞—á–µ–Ω–∏—è $l$ –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π $2,1,2,3,1,2$ –∏ $2,3,2,2,1$ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü–µ:\n$$ \\begin{array}{|cc|c|c|c|c|c|c|} \\hline \u0026 \u0026 \u0026 \\color{blue}{2} \u0026 \\color{blue}{3} \u0026 \\color{blue}{2} \u0026 \\color{blue}{2} \u0026 \\color{blue}{1} \\\\ \u0026 \u0026 0 \u0026 1 \u0026 2 \u0026 3 \u0026 4 \u0026 5 \\\\ \\hline \u0026 0 \u0026 0 \u0026 0 \u0026 0 \u0026 0 \u0026 0 \u0026 0 \\\\ \\hline\\color{blue}{2} \u0026 1 \u0026 0 \u0026 1 \u0026 1 \u0026 1 \u0026 1 \u0026 1 \\\\ \\hline\\color{blue}{1} \u0026 2 \u0026 0 \u0026 1 \u0026 1 \u0026 1 \u0026 1 \u0026 2 \\\\ \\hline\\color{blue}{2} \u0026 3 \u0026 0 \u0026 1 \u0026 1 \u0026 2 \u0026 2 \u0026 2 \\\\ \\hline\\color{blue}{3} \u0026 4 \u0026 0 \u0026 1 \u0026 2 \u0026 2 \u0026 2 \u0026 2 \\\\ \\hline\\color{blue}{1} \u0026 5 \u0026 0 \u0026 1 \u0026 2 \u0026 2 \u0026 2 \u0026 3 \\\\ \\hline\\color{blue}{2} \u0026 6 \u0026 0 \u0026 1 \u0026 2 \u0026 3 \u0026 3 \u0026 3 \\\\ \\hline \\end{array} $$–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –ü—É—Å—Ç—å —Ç—Ä–µ–±—É–µ—Ç—Å—è —É–∑–Ω–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –¥–ª–∏–Ω—É –ù–û–ü, –Ω–æ –∏ –Ω–∞–π—Ç–∏ —Å–∞–º—É –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –ö–∞–∫ –º—ã —É–∂–µ –æ–±—Å—É–∂–¥–∞–ª–∏, —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ª—é–±—ã–º –∏–∑ –¥–≤—É—Ö —Å–ø–æ—Å–æ–±–æ–≤: –º–æ–∂–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∫–∞–∫–æ–π –∏–∑ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –≤ –Ω–µ–≥–æ –±—ã–ª –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º, –∞ –º–æ–∂–Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å, –∞ –Ω–∞—Ö–æ–¥–∏—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ –º–µ—Ä–µ –Ω–∞–¥–æ–±–Ω–æ—Å—Ç–∏, –ø–µ—Ä–µ–±–∏—Ä–∞—è –≤—Å–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –∑–∞–Ω–æ–≤–æ. –¢–∞–∫\n–∏–ª–∏ –∏–Ω–∞—á–µ, –±—É–¥–µ–º –æ—Ç–∫–∞—Ç—ã–≤–∞—Ç—å—Å—è –∏–∑ –∫–æ–Ω–µ—á–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è ( $n, m$ ), –ø–µ—Ä–µ—Ö–æ–¥—è –ø–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º –ø–µ—Ä–µ—Ö–æ–¥–∞–º –∏ –¥–æ–±–∞–≤–ª—è—è —Å–∏–º–≤–æ–ª –≤ –æ—Ç–≤–µ—Ç, –∫–æ–≥–¥–∞ –ø–µ—Ä–µ—Ö–æ–¥ –∏–¥—ë—Ç ‚Äú–ø–æ –¥–∏–∞–≥–æ–Ω–∞–ª–∏‚Äù. –û—Å—Ç–∞–Ω–æ–≤–∏–º—Å—è, –∫–æ–≥–¥–∞ –ø—Ä–∏–¥—ë–º –≤ –æ–¥–Ω–æ –∏–∑ –Ω–∞—á–∞–ª—å–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π. –ü—Ä–∏–≤–µ–¥—ë–º –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –≤—Ç–æ—Ä–æ–≥–æ —Å–ø–æ—Å–æ–±–∞.\n1 2 3 4 5 6 7 8 9 10 i = n, j = m while i \u003e 0 and j \u003e 0: if a[i] == b[j] and l[i, j] == l[i - 1, j - 1] + 1: ans.push_back(a[i]) i -=1, j -= 1 else if l[i, j] == l[i - 1, j]: i -= 1 else: # l[i, j] == l[i, j - 1] j -= 1 reverse(ans.begin(), ans.end()) –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ –ü—É—Å—Ç—å –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª–∏–Ω–∞ –ù–û–ü, —Ç–æ–≥–¥–∞ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å $O(\\min (m, n))$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏. –î–ª—è —ç—Ç–æ–≥–æ –∑–∞–º–µ—Ç–∏–º, —á—Ç–æ –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ $i$-–π —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ $i$-—é –∏ ( $i-1$ )-—é —Å—Ç—Ä–æ–∫–∏. –ó–Ω–∞—á–∏—Ç, –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å—Ç—Ä–æ–∫–∏ –º–æ–∂–Ω–æ —É–∂–µ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å - –ø–æ–ª—É—á–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ —Å $O(m)$ –ø–∞–º—è—Ç–∏. –û—Å—Ç–∞—ë—Ç—Å—è –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—Å–µ–≥–¥–∞ –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏, –ø–æ—ç—Ç–æ–º—É —Ö–≤–∞—Ç–∏—Ç –∏ $O(\\min (m, n))$ –ø–∞–º—è—Ç–∏.\nint l[2][m + 1] fill(l, 0) for i = 1..n: cur = i % 2, prev = 1 - cur for j = 1..m: l[cur, j] = max(l[prev, j], l[cur, j - 1]) if a[i] == b[j]: l[cur, j] = max(l[cur, j], l[prev, j - 1] + 1)",
    "description": "–ü—É—Å—Ç—å –¥–∞–Ω—ã –¥–≤–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —á–∏—Å–µ–ª (—Å–∏–º–≤–æ–ª–æ–≤) $a_{1}, \\ldots, a_{n}$ –∏ $b_{1}, \\ldots, b_{m}$. –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–π—Ç–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å $c$ –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ–π –¥–ª–∏–Ω—ã, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –±—ã –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ $a$, –∏ $b$. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π $2,1,2,3,1,2$ –∏ $2,3,2,2,1$ –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã $-2,2,2 ; 2,3,2 ; 2,3,1$ –∏ $2,2,1$.\n–ü—É—Å—Ç—å $l[i, j]$ - –¥–ª–∏–Ω–∞ –Ω–∞–∏–±–æ–ª—å—à–µ–π –æ–±—â–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–ù–û–ü, longest common subsequence, LCS) –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π $a_{1}, \\ldots, a_{i}$ –∏ $b_{1}, \\ldots, b_{j}$. –ù–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: $l[i, 0]=$ $l[0, j]=0$. –ù–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç $l[n, m]$.",
    "tags": [],
    "title": "–ù–∞–∏–±–æ–ª—å—à–∞—è –æ–±—â–∞—è –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å",
    "uri": "/basics/dynamic_programming/longest_common_subsequence/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.",
    "content": "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã —É–º–µ—é—Ç –∑–∞ –æ–¥–Ω—É —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é —Å–∫–ª–∞–¥—ã–≤–∞—Ç—å –¥–≤–∞ 32(–∏–ª–∏ 64)-–±–∏—Ç–Ω—ã—Ö —á–∏—Å–ª–∞. –ß–∞—Å—Ç–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏) –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∫—É–¥–∞ –±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏. –ü–æ–≥–æ–≤–æ—Ä–∏–º –æ —Ç–æ–º, –∫–∞–∫ –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Å –Ω–∏–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.\n–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –Ω–∞ –≤—Ö–æ–¥ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º –¥–∞—é—Ç—Å—è –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–µ —á–∏—Å–ª–∞ –≤ –¥–≤–æ–∏—á–Ω–æ–π –∑–∞–ø–∏—Å–∏. –ú—ã –±—É–¥–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å —á–∏—Å–ª–∞–º–∏, –∏–º–µ—é—â–∏–º–∏ –¥–≤–æ–∏—á–Ω—É—é –∑–∞–ø–∏—Å—å –¥–ª–∏–Ω—ã $n$ (–≤–æ–∑–º–æ–∂–Ω–æ, —Å –≤–µ–¥—É—â–∏–º–∏ –Ω—É–ª—è–º–∏).\n‚úçÔ∏è –í –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º —Å–ª—É—á–∞–µ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è $n$ —Ä–∞–≤–Ω–æ–≥–æ –º–∞–∫—Å–∏–º—É–º—É –∏–∑ –¥–ª–∏–Ω —á–∏—Å–µ–ª, –∞ –≤ –∫–æ–Ω—Ü–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–ª–∏–Ω—É –∑–∞–ø–∏—Å–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ (—É–¥–∞–ª–∏—Ç—å –≤–µ–¥—É—â–∏–µ –Ω—É–ª–∏), —á—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç $O(n)$ –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –Ω–µ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –æ—Ü–µ–Ω–∫—É —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞.\n–°–ª–æ–∂–µ–Ω–∏–µ –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å–µ–º –∑–Ω–∞–∫–æ–º—ã–π —Å–æ —à–∫–æ–ª—ã —Å–ø–æ—Å–æ–± —Å–ª–æ–∂–µ–Ω–∏—è —á–∏—Å–µ–ª –≤ —Å—Ç–æ–ª–±–∏–∫: ‚Äã python c++ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 def add(a: List[int], b: List[int], n: int) -\u003e List[int]: \"\"\" Add two binary numbers represented as lists of digits. Args: a: First binary number as list of digits (LSB at index 0) b: Second binary number as list of digits (LSB at index 0) n: Length of the input arrays Returns: List[int]: Binary sum with length n+1 (LSB at index 0) \"\"\" # Create result array of length n+1, filled with zeros c: List[int] = [0] * (n + 1) # Add digits with carry propagation for i in range(n): c[i] += a[i] + b[i] if c[i] \u003e= 2: c[i + 1] += c[i] // 2 # Carry to next position c[i] = c[i] % 2 # Keep only the remainder return c 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 /** * Add two binary numbers represented as vectors of digits. * * @param a First binary number as vector of digits (LSB at index 0) * @param b Second binary number as vector of digits (LSB at index 0) * @param n Length of the input vectors * @return Binary sum as vector with length n+1 (LSB at index 0) */ std::vector\u003cint\u003e add(const std::vector\u003cint\u003e\u0026 a, const std::vector\u003cint\u003e\u0026 b, int n) { // Create result vector of length n+1, filled with zeros std::vector\u003cint\u003e c(n + 1, 0); // Add digits with carry propagation for (int i = 0; i \u003c n; ++i) { c[i] += a[i] + b[i]; if (c[i] \u003e= 2) { c[i + 1] += c[i] / 2; // Carry to next position c[i] = c[i] % 2; // Keep only the remainder } } return c; } –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ - $O(n)$, —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –±—ã—Å—Ç—Ä–µ–µ –Ω–µ–ª—å–∑—è, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å—Ç–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–Ω–∏–º–∞–µ—Ç —É–∂–µ —Å—á–∏—Ç—ã–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –≤—ã–≤–æ–¥ –æ—Ç–≤–µ—Ç–∞.\n‚úçÔ∏è –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –¥–ª—è —á–∏—Å–µ–ª, –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –≤ $b$-–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ —Å—á–∏—Å–ª–µ–Ω–∏—è. –ï—Å–ª–∏ —Å—É–º–º–∞ —Ç—Ä—ë—Ö $b$-–∏—á–Ω—ã—Ö —á–∏—Å–µ–ª –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ 32(64)-–±–∏—Ç–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö, —Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º –≤—Å—ë –µ—â—ë –±—É–¥–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω. –ü—Ä–∏ —ç—Ç–æ–º $n$-–±–∏—Ç–Ω–æ–µ —á–∏—Å–ª–æ –±—É–¥–µ—Ç –∏–º–µ—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ $\\frac{n}{\\log b}$ —Ü–∏—Ñ—Ä –≤ $b$-–∏—á–Ω–æ–π –∑–∞–ø–∏—Å–∏, —Ç–æ –µ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞ $O\\left(\\frac{n}{\\log b}\\right)=O(n)$, —Ç–∞–∫ –∫–∞–∫ $\\frac{1}{\\log b}$ - —ç—Ç–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞. –¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, —ç—Ç–æ –º–æ–∂–µ—Ç –¥–∞—Ç—å —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–µ—Å—è—Ç–∫–æ–≤ —Ä–∞–∑, —á—Ç–æ –±–µ–∑—É—Å–ª–æ–≤–Ω–æ –±—ã–≤–∞–µ—Ç –ø–æ–ª–µ–∑–Ω–æ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ.\n–£–º–Ω–æ–∂–µ–Ω–∏–µ –í—Å–ø–æ–º–Ω–∏–º —Ç–µ–ø–µ—Ä—å –∏ —à–∫–æ–ª—å–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ —á–∏—Å–µ–ª –≤ —Å—Ç–æ–ª–±–∏–∫ (–∑–∞–º–µ—Ç–∏–º –ª–∏—à—å, —á—Ç–æ –æ—Ç–≤–µ—Ç –∏–º–µ–µ—Ç –¥–ª–∏–Ω—É –Ω–µ –±–æ–ª—å—à–µ $2 n$, –ø–æ—Å–∫–æ–ª—å–∫—É $\\left.\\left(2^{n}-1\\right) \\cdot\\left(2^{n}-1\\right)\u003c2^{2 n}\\right)$ : ‚Äã python c++ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 def multiply(a: List[int], b: List[int], n: int) -\u003e List[int]: \"\"\" Multiply two binary numbers represented as lists of bits. Args: a: First binary number as list of bits (LSB at index 0) b: Second binary number as list of bits (LSB at index 0) n: Number of bits in each input Returns: List[int]: Product as binary number (LSB at index 0) \"\"\" # Initialize result array of size 2n with zeros c: List[int] = [0] * (2 * n) # Multiply each pair of bits for i in range(n): for j in range(n): c[i + j] += a[i] * b[j] # Propagate carries for i in range(2 * n - 1): if c[i] \u003e= 2: c[i + 1] += c[i] // 2 c[i] %= 2 return c 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 std::vector\u003cint\u003e multiply(const std::vector\u003cint\u003e\u0026 a, const std::vector\u003cint\u003e\u0026 b, int n) { // Initialize result array of size 2n with zeros std::vector\u003cint\u003e c(2 * n, 0); // Multiply each pair of bits for (int i = 0; i \u003c n; i++) { for (int j = 0; j \u003c n; j++) { c[i + j] += a[i] * b[j]; } } // Propagate carries for (int i = 0; i \u003c 2 * n - 1; i++) { if (c[i] \u003e= 2) { c[i + 1] += c[i] / 2; c[i] %= 2; } } return c; } –ò–∑-–∑–∞ –¥–≤—É—Ö –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —ç—Ç–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ - —É–∂–µ $O\\left(n^{2}\\right)$. –ü—Ä–∏–≤–µ–¥—ë–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —É–º–Ω–æ–∂–µ–Ω–∏—è –¥–≤—É—Ö —á–∏—Å–µ–ª, –ø–æ–ª—å–∑—É—é—â–∏–π—Å—è —Å–ª–µ–¥—É—é—â–∏–º –ø—Ä–∞–≤–∏–ª–æ–º:\n$$ a \\cdot b= \\begin{cases}2 \\cdot\\left(a \\cdot\\left\\lfloor\\frac{b}{2}\\right\\rfloor\\right), \u0026 \\text { –µ—Å–ª–∏ } b \\text { —á—ë—Ç–Ω–æ, } \\\\ a+2 \\cdot\\left(a \\cdot\\left\\lfloor\\frac{b}{2}\\right\\rfloor\\right), \u0026 \\text { –∏–Ω–∞—á–µ. }\\end{cases} $$ ‚Äã python c++ c++ (optimized) c++ (optimized, iterative) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 def multiply(a: int, b: int) -\u003e int: \"\"\" Multiply two integers using recursive binary multiplication. Args: a: First integer b: Second integer Returns: Product of a and b \"\"\" # Base case if b == 0: return 0 # Recursive case c = multiply(a, b // 2) # Integer division if b % 2 == 0: return 2 * c else: return 2 * c + a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 /** * Multiply two integers using recursive binary multiplication. * * @param a First integer * @param b Second integer * @return Product of a and b */ int multiply(int a, int b) { // Base case if (b == 0) { return 0; } // Recursive case int c = multiply(a, b / 2); // Integer division if (b % 2 == 0) { return 2 * c; } else { return 2 * c + a; } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 /** * Optimized multiplication using bit manipulation. * This implements Russian peasant multiplication using bit operations. * * @param a First integer * @param b Second integer * @return Product of a and b */ int multiplyOptimized(int a, int b) { // Base case if (b == 0) return 0; // Recursive case with bit manipulation int c = multiplyOptimized(a, b \u003e\u003e 1); // b \u003e\u003e 1 is same as b/2 // Check if b is even using bitwise AND if ((b \u0026 1) == 0) { // b is even if LSB is 0 return c \u003c\u003c 1; // Multiply by 2 using left shift } else { return (c \u003c\u003c 1) + a; // (2*c) + a } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 /** * Iterative version using bit manipulation (more efficient). * This avoids recursion overhead. * * @param a First integer * @param b Second integer * @return Product of a and b */ int multiplyIterative(int a, int b) { int result = 0; // Russian peasant multiplication while (b \u003e 0) { // If current bit of b is set, add a to result if (b \u0026 1) { result += a; } // Double a and halve b using bit operations a \u003c\u003c= 1; // a = a * 2 b \u003e\u003e= 1; // b = b / 2 } return result; } –í —ç—Ç–æ–π —Å—Ö–µ–º–∞—Ç–∏—á–Ω–æ–π –∑–∞–ø–∏—Å–∏ –ø–æ–¥ –¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ –¥–≤–∞ –∏–º–µ–µ—Ç—Å—è –≤ –≤–∏–¥—É –±–∏—Ç–æ–≤—ã–π —Å–¥–≤–∏–≥ –≤–ø—Ä–∞–≤–æ (—Ç–æ –µ—Å—Ç—å –≤–∑—è—Ç–∏–µ –¥–≤–æ–∏—á–Ω–æ–π –∑–∞–ø–∏—Å–∏ –±–µ–∑ –º–ª–∞–¥—à–µ–≥–æ –±–∏—Ç–∞), –ø–æ–¥ —É–º–Ω–æ–∂–µ–Ω–∏–µ–º –Ω–∞ –¥–≤–∞ - –±–∏—Ç–æ–≤—ã–π —Å–¥–≤–∏–≥ –≤–ª–µ–≤–æ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω—É–ª—è –≤ –Ω–∞—á–∞–ª–æ –±–∏—Ç–æ–≤–æ–π –∑–∞–ø–∏—Å–∏). –û—Å—Ç–∞—Ç–æ–∫ –ø–æ –º–æ–¥—É–ª—é –¥–≤–∞ - —ç—Ç–æ –º–ª–∞–¥—à–∏–π –±–∏—Ç —á–∏—Å–ª–∞.\n–ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–∏–∑–≤–µ–¥—ë—Ç $O(n)$ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, –ø–æ—Å–∫–æ–ª—å–∫—É –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ –¥–ª–∏–Ω–∞ –±–∏—Ç–æ–≤–æ–π –∑–∞–ø–∏—Å–∏ $b$ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –Ω–∞ –æ–¥–∏–Ω. –í –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –±–∏—Ç–æ–≤—ã–π —Å–¥–≤–∏–≥ –≤–ª–µ–≤–æ, –±–∏—Ç–æ–≤—ã–π —Å–¥–≤–∏–≥ –≤–ø—Ä–∞–≤–æ, –∏, –≤–æ–∑–º–æ–∂–Ω–æ —Å–ª–æ–∂–µ–Ω–∏–µ - –≤—Å–µ–≥–æ $O(n)$ —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ–±—â–µ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–Ω–æ–≤–∞ $O\\left(n^{2}\\right)$.\n–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –µ—Å–ª–∏ –¥–ª–∏–Ω—ã –±–∏—Ç–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π $a$ –∏ $b$ —Ä–∞–≤–Ω—ã $n$ –∏ $m$, —Ç–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –æ–±–æ–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –∫–∞–∫ $O(n m)$.\n–î–µ–ª–µ–Ω–∏–µ –ü—É—Å—Ç—å —Ç–µ–ø–µ—Ä—å –º—ã —Ö–æ—Ç–∏–º –ø–æ–¥–µ–ª–∏—Ç—å $a$ –Ω–∞ $b$, —Ç–æ –µ—Å—Ç—å –Ω–∞–π—Ç–∏ —Ç–∞–∫–∏–µ $q, r$, —á—Ç–æ $a=q b+r$ –∏ $0 \\leqslant r \u003c b$. –ó–¥–µ—Å—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Ö–æ–∂–∞—è –∏–¥–µ—è: –æ–±–æ–∑–Ω–∞—á–∏–º –∑–∞ $q^{\\prime}, r^{\\prime}$ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ–ª–µ–Ω–∏—è $\\left\\lfloor\\frac{a}{2}\\right\\rfloor$ –Ω–∞ $b$, —Ç–æ–≥–¥–∞:\n$$ (q, r)= \\begin{cases}\\left(2 \\cdot q^{\\prime}+\\left\\lfloor\\frac{2 \\cdot r^{\\prime}}{b}\\right\\rfloor, 2 \\cdot r^{\\prime}-\\left\\lfloor\\frac{2 \\cdot r^{\\prime}}{b}\\right\\rfloor \\cdot b\\right), \u0026 \\text { –µ—Å–ª–∏ } a \\text { —á—ë—Ç–Ω–æ, } \\\\ \\left(2 \\cdot q^{\\prime}+\\left\\lfloor\\frac{2 \\cdot r^{\\prime}+1}{b}\\right\\rfloor, 2 \\cdot r^{\\prime}+1-\\left\\lfloor\\frac{2 \\cdot r^{\\prime}+1}{b}\\right\\rfloor \\cdot b\\right), \u0026 \\text { –∏–Ω–∞—á–µ. }\\end{cases} $$–ü—Ä–∏ —ç—Ç–æ–º $\\left\\lfloor\\frac{2 \\cdot r^{\\prime}}{b}\\right\\rfloor,\\left\\lfloor\\frac{2 \\cdot r^{\\prime}+1}{b}\\right\\rfloor \\leqslant 1$. –ü–æ–ª—É—á–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º: ‚Äã python c++ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 def divide(a: int, b: int) -\u003e tuple[int, int]: \"\"\" Divide two binary numbers (represented as integers) recursively. Args: a: Dividend (binary number as integer) b: Divisor (binary number as integer) Returns: tuple[int, int]: (quotient, remainder) such that a = q * b + r, 0 ‚â§ r \u003c b Raises: ZeroDivisionError: If b is zero \"\"\" # Handle division by zero if b == 0: raise ZeroDivisionError(\"Division by zero\") # Handle negative numbers (optional extension) # For simplicity, this implementation assumes non-negative inputs # Base case if a == 0: return 0, 0 # Recursive case: divide a//2 by b q, r = divide(a // 2, b) # Since we divided a by 2, we need to multiply quotient and remainder by 2 q = q * 2 r = r * 2 # If a was odd, add 1 to remainder if a % 2 == 1: r += 1 # If remainder \u003e= divisor, adjust quotient and remainder if r \u003e= b: q += 1 r -= b return q, r 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 /** * Divide two binary numbers (represented as integers) recursively. * * @param a Dividend (binary number as integer) * @param b Divisor (binary number as integer) * @return std::pair\u003cint, int\u003e (quotient, remainder) such that a = q * b + r, 0 ‚â§ r \u003c b * @throws std::invalid_argument if b is zero */ std::pair\u003cint, int\u003e divide(int a, int b) { // Handle division by zero if (b == 0) { throw std::invalid_argument(\"Division by zero\"); } // Handle negative numbers (optional extension) // For simplicity, this implementation assumes non-negative inputs // Base case if (a == 0) { return {0, 0}; } // Recursive case: divide a/2 by b auto [q, r] = divide(a / 2, b); // Since we divided a by 2, we need to multiply quotient and remainder by 2 q = q * 2; r = r * 2; // If a was odd, add 1 to remainder if (a % 2 == 1) { r += 1; } // If remainder \u003e= divisor, adjust quotient and remainder if (r \u003e= b) { q += 1; r -= b; } return {q, r}; } –°–Ω–æ–≤–∞ –∏–º–µ–µ–º $O(n)$ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, –≤ –∫–∞–∂–¥–æ–º –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–µ —á–∏—Å–ª–æ –±–∏—Ç–æ–≤—ã—Ö —Å–¥–≤–∏–≥–æ–≤ –∏ —Å–ª–æ–∂–µ–Ω–∏–π (–≤—ã—á–∏—Ç–∞–Ω–∏–π), –ø–æ—ç—Ç–æ–º—É –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–Ω–æ–≤–∞ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ $O\\left(n^{2}\\right)$.\n–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± - —à–∫–æ–ª—å–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ –≤ —Å—Ç–æ–ª–±–∏–∫: ‚Äã python c++ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 def divide(a: int, b: int) -\u003e tuple[int, int]: \"\"\" Divide two binary numbers (represented as integers) recursively. Args: a: Dividend (binary number as integer) b: Divisor (binary number as integer) Returns: tuple[int, int]: (quotient, remainder) such that a = q * b + r, 0 ‚â§ r \u003c b Raises: ZeroDivisionError: If b is zero \"\"\" # Handle division by zero if b == 0: raise ZeroDivisionError(\"Division by zero\") # Handle negative numbers (optional extension) # For simplicity, this implementation assumes non-negative inputs # Base case if a == 0: return 0, 0 # Recursive case: divide a//2 by b q, r = divide(a // 2, b) # Since we divided a by 2, we need to multiply quotient and remainder by 2 q = q * 2 r = r * 2 # If a was odd, add 1 to remainder if a % 2 == 1: r += 1 # If remainder \u003e= divisor, adjust quotient and remainder if r \u003e= b: q += 1 r -= b return q, r 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 /** * Divide two binary numbers (represented as integers) recursively. * * @param a Dividend (binary number as integer) * @param b Divisor (binary number as integer) * @return std::pair\u003cint, int\u003e (quotient, remainder) such that a = q * b + r, 0 ‚â§ r \u003c b * @throws std::invalid_argument if b is zero */ std::pair\u003cint, int\u003e divide(int a, int b) { // Handle division by zero if (b == 0) { throw std::invalid_argument(\"Division by zero\"); } // Handle negative numbers (optional extension) // For simplicity, this implementation assumes non-negative inputs // Base case if (a == 0) { return {0, 0}; } // Recursive case: divide a/2 by b auto [q, r] = divide(a / 2, b); // Since we divided a by 2, we need to multiply quotient and remainder by 2 q = q * 2; r = r * 2; // If a was odd, add 1 to remainder if (a % 2 == 1) { r += 1; } // If remainder \u003e= divisor, adjust quotient and remainder if (r \u003e= b) { q += 1; r -= b; } return {q, r}; } ‚Äã –ø—Å–µ–≤–¥–æ–∫–æ–¥ 1 2 3 4 5 6 7 8 9 10 divide(a, b): # a –∏ b - –¥–≤–æ–∏—á–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —á–∏—Å–µ–ª n = len(a), m = len(b) q=0 for i = (n - m)..0: # —É–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ 2 ** k - –±–∏—Ç–æ–≤—ã–π —Å–¥–≤–∏–≥ —á–∏—Å–ª–∞ –Ω–∞ k –≤–ª–µ–≤–æ c = b * 2 ** i if a \u003e= c: a = a - c q = q + 2 **i return q, a –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã, –∫–∞–∫ –∏ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —Å–ª—É—á–∞–µ, –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ $O\\left(n^{2}\\right)$. –ï—Å—Ç—å –∏ –±–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö –æ—Ü–µ–Ω–∫–∞: –µ—Å–ª–∏ –¥–ª–∏–Ω—ã –±–∏—Ç–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π $a$ –∏ $b$ —Ä–∞–≤–Ω—ã $n$ –∏ $m$, —Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π —Ü–∏–∫–ª–∞ –Ω–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç $n-m+1$, –ø–æ—ç—Ç–æ–º—É –ø–æ–ª—É—á–∞–µ–º –æ—Ü–µ–Ω–∫—É $O(n(n-m+1))$.\n–ê–ª–≥–æ—Ä–∏—Ç–º –ö–∞—Ä–∞—Ü—É–±—ã –ú–æ–∂–Ω–æ –ª–∏ –ø–µ—Ä–µ–º–Ω–æ–∂–∞—Ç—å —á–∏—Å–ª–∞ –±—ã—Å—Ç—Ä–µ–µ? –û–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ –¥–∞! –°–ª–µ–¥—É—é—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –±—ã–ª –ø—Ä–∏–¥—É–º–∞–Ω —Å–æ–≤–µ—Ç—Å–∫–∏–º –º–∞—Ç–µ–º–∞—Ç–∏–∫–æ–º –ê–Ω–∞—Ç–æ–ª–∏–µ–º –ö–∞—Ä–∞—Ü—É–±–æ–π –≤ 1962 –≥–æ–¥—É.\n–ë—É–¥–µ–º –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –¥–ª–∏–Ω–∞ –±–∏—Ç–æ–≤–æ–π –∑–∞–ø–∏—Å–∏ —á–∏—Å–µ–ª $n$ - —Å—Ç–µ–ø–µ–Ω—å –¥–≤–æ–π–∫–∏ (–µ—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫, –¥–æ–±–∞–≤–∏–º –≤–µ–¥—É—â–∏—Ö –Ω—É–ª–µ–π, –ø—Ä–∏ —ç—Ç–æ–º –¥–ª–∏–Ω–∞ —á–∏—Å–µ–ª —É–≤–µ–ª–∏—á–∏—Ç—Å—è –Ω–µ –±–æ–ª–µ–µ —á–µ–º –≤–¥–≤–æ–µ, —á—Ç–æ –Ω–µ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –∞—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫—É—é –æ—Ü–µ–Ω–∫—É).\n–†–∞–∑–æ–±—å—ë–º –∫–∞–∂–¥–æ–µ –∏–∑ —á–∏—Å–µ–ª –Ω–∞ –¥–≤–µ —Ä–∞–≤–Ω—ã—Ö –ø–æ–ª–æ–≤–∏–Ω—ã: $a=2^{\\frac{n}{2}} a_{l}+a_{r}, b=2^{\\frac{n}{2}} b_{l}+b_{r}$. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ\n$$ a b=\\left(2^{\\frac{n}{2}} a_{l}+a_{r}\\right) \\cdot\\left(2^{\\frac{n}{2}} b_{l}+b_{r}\\right)=2^{n} a_{l} b_{l}+2^{\\frac{n}{2}}\\left(a_{l} b_{r}+a_{r} b_{l}\\right)+a_{r} b_{r} $$–ù–∞–ø–∏—à–µ–º —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º, –ø–æ–ª—å–∑—É—é—â–∏–π—Å—è —ç—Ç–∏–º —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ–º: –Ω–∞–π–¥—ë–º —á–µ—Ç—ã—Ä–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –≤–¥–≤–æ–µ –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏—Ö —á–∏—Å–µ–ª ( $a_{l} b_{l}, a_{l} b_{r}, a_{r} b_{l}, a_{r} b_{r}$ ) —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ, –ø–æ—Å–ª–µ —á–µ–≥–æ –≤—ã—á–∏—Å–ª–∏–º —Å –∏—Ö –ø–æ–º–æ—â—å—é $a b$. –î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–µ —á–∏—Å–ª–æ —Å–ª–æ–∂–µ–Ω–∏–π –∏ –±–∏—Ç–æ–≤—ã—Ö —Å–¥–≤–∏–≥–æ–≤ (–∏ —Ç–æ, –∏ –¥—Ä—É–≥–æ–µ –¥–µ–ª–∞–µ—Ç—Å—è –∑–∞ $\\Theta(n)$ ). –û–±–æ–∑–Ω–∞—á–∏–º –∑–∞ $T(n)$ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –Ω–∞ $n$-–±–∏—Ç–æ–≤—ã—Ö —á–∏—Å–ª–∞—Ö, —Ç–æ–≥–¥–∞ –º—ã –ø–æ–ª—É—á–∞–µ–º —Å–ª–µ–¥—É—é—â–µ–µ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ:\n$$ \\begin{equation*} T(n)=4 \\cdot T\\left(\\frac{n}{2}\\right)+\\Theta(n) \\tag{2.1} \\end{equation*} $$–°–æ–≤—Å–µ–º —Å–∫–æ—Ä–æ –º—ã –¥–æ–∫–∞–∂–µ–º —Ç–µ–æ—Ä–µ–º—É, –∏–∑ –∫–æ—Ç–æ—Ä–æ–π —Å–ª–µ–¥—É–µ—Ç, —á—Ç–æ $T(n)=\\Theta\\left(n^{2}\\right)$. –ü–æ–∫–∞ –º—ã –Ω–µ –ø–æ–ª—É—á–∏–ª–∏ –Ω–∏–∫–∞–∫–æ–≥–æ –≤—ã–∏–≥—Ä—ã—à–∞ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏ —É–º–Ω–æ–∂–µ–Ω–∏—è. –ù–æ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ —ç—Ç–æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –º–æ–∂–Ω–æ —É—Å–∫–æ—Ä–∏—Ç—å, –∑–∞–º–µ—Ç–∏–≤, —á—Ç–æ\n$$ a_{l} b_{r}+a_{r} b_{l}=\\left(a_{l}+b_{l}\\right) \\cdot\\left(a_{r}+b_{r}\\right)-a_{l} b_{l}-a_{r} b_{r} . $$–ó–Ω–∞—á–∏—Ç, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å —Ç—Ä–∏ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è, –∏ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –±—É–¥–µ—Ç —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—Ç—å —É–∂–µ\n$$ \\begin{equation*} T(n)=3 \\cdot T\\left(\\frac{n}{2}\\right)+\\Theta(n) \\tag{2.2} \\end{equation*} $$–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Ç–∞–∫–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø–æ —Ç–æ–π –∂–µ —Ç–µ–æ—Ä–µ–º–µ –º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å —É–∂–µ –∫–∞–∫ $\\Theta\\left(n^{\\log _{2} 3}\\right)=$ $\\Theta\\left(n^{1.585 \\ldots}\\right)$.\n‚úçÔ∏è –°—Ç—Ä–æ–≥–æ –≥–æ–≤–æ—Ä—è, –¥–ª–∏–Ω–∞ —á–∏—Å–µ–ª $a_{l}+b_{l}, a_{r}+b_{r}$ –º–æ–∂–µ—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è —Ä–∞–≤–Ω–∞ $\\frac{n}{2}+1$. –ß—Ç–æ–±—ã —á–µ—Å—Ç–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ 2.2, –º–æ–∂–Ω–æ –∑–∞ –ª–∏–Ω–µ–π–Ω–æ–µ –≤—Ä–µ–º—è —Å–≤–µ—Å—Ç–∏ —É–º–Ω–æ–∂–µ–Ω–∏–µ $\\left(\\frac{n}{2}+1\\right)$-–±–∏—Ç–Ω—ã—Ö —á–∏—Å–µ–ª –∫ —É–º–Ω–æ–∂–µ–Ω–∏—é $\\frac{n}{2}$-–±–∏—Ç–Ω—ã—Ö. –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ $T(n)=3 \\cdot T\\left(\\frac{n}{2}+1\\right)+\\Theta(n)$ –¥–∞—ë—Ç —Ç–∞–∫—É—é –∂–µ –∞—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫—É—é –æ—Ü–µ–Ω–∫—É. ‚Äã –ø—Å–µ–≤–¥–æ–∫–æ–¥ 1 2 3 4 5 6 7 8 9 10 11 multiply(a, b): # a –∏ b - –¥–≤–æ–∏—á–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —á–∏—Å–µ–ª n = max(len(a), len(b)) if n == 1: return [a[0] * b[0]] # —á–∏—Å–ª–æ –∏–∑ –æ–¥–Ω–æ–≥–æ –±–∏—Ç–∞ a --\u003e al, ar # –¥–µ–ª–∏–º —á–∏—Å–ª–æ –∞ –Ω–∞ –¥–≤–µ —Ä–∞–≤–Ω—ã–µ —á–∞—Å—Ç–∏ b --\u003e bl, br # –¥–µ–ª–∏–º —á–∏—Å–ª–æ b –Ω–∞ –¥–≤–µ —Ä–∞–≤–Ω—ã–µ —á–∞—Å—Ç–∏ x = multiply(al, bl) y = multiply(ar, br) z = multiply(al + ar, bl + br) # —É–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ 2 ** k - –±–∏—Ç–æ–≤—ã–π —Å–¥–≤–∏–≥ —á–∏—Å–ª–∞ –Ω–∞ k –≤–ª–µ–≤–æ return x * 2 ** n + (z - x - y) * 2 ** (n / 2) + y –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ, –¥–æ–π–¥—è –≤ —Ä–µ–∫—É—Ä—Å–∏–∏ –¥–æ $16(32)$-–±–∏—Ç–Ω—ã—Ö —á–∏—Å–µ–ª, —É–∂–µ —Å—Ç–æ–∏—Ç –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π —É–º–Ω–æ–∂–µ–Ω–∏—è.\n–°—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã–µ –º–µ—Ç–æ–¥—ã —É–º–Ω–æ–∂–µ–Ω–∏—è —á–∏—Å–µ–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–µ—Ç–æ–¥, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –±—ã—Å—Ç—Ä–æ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –§—É—Ä—å–µ), –Ω–æ –æ –Ω–∏—Ö –º—ã –ø–æ–≥–æ–≤–æ—Ä–∏–º –ø–æ–∑–∂–µ.\n–ü—Ä–∏–º–µ—Ä –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ $1234 * 4321$.\n–ó–∞–¥–∞—á–∞ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ 3 –ø–æ–¥–∑–∞–¥–∞—á–∏:\n$a_{l} b_{l} = 12 \\cdot 43$ $a_{r} b_{r} = 34 \\cdot 21$ $e = \\left(a_{l}+b_{l}\\right) \\cdot\\left(a_{r}+b_{r}\\right)-a_{l} b_{l}-a_{r} b_{r} = \\left(12 + 34\\right) \\cdot \\left(43 + 21\\right) - a_{l} b_{l} - a_{r} b_{r}$ –ü–µ—Ä–≤–∞—è –ø–æ–¥–∑–∞–¥–∞—á–∞ ($a_{l} b_{l} = 12 \\cdot 43$) –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å —Ç–∞–∫–∂–µ —Ä–µ–∑–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ 3 –ø–æ–¥–ø—Ä–æ–±–ª–µ–º—ã:\n$a_{l}^\\prime b_{l}^\\prime = 1 \\cdot 4 = 4$ $a_{r}^\\prime b_{r}^\\prime = 2 \\cdot 3 = 6$ $\\left(a_{l}^\\prime+b_{l}^\\prime\\right) \\cdot\\left(a_{r}^\\prime+b_{r}^\\prime\\right)-a_{l}^\\prime b_{l}^\\prime-a_{r} b_{r}^\\prime = \\left(1 + 2\\right) \\cdot \\left(4 + 3\\right) - 4 - 6 = 11$ –û—Ç–≤–µ—Ç: $4 \\cdot 10^2 + 11 \\cdot 10 + 6 = 516$ –í—Ç–æ—Ä–∞—è –ø–æ–¥–∑–∞–¥–∞—á–∞ ($a_{r} b_{r} = 34 \\cdot 21$):\n$a_{l}^{\\prime\\prime} b_{l}^{\\prime\\prime} = 3 \\cdot 2 = 6$ $a_{r}^{\\prime\\prime} b_{r}^{\\prime\\prime} = 4 \\cdot 1 = 4$ $\\left(a_{l}^{\\prime\\prime}+b_{l}^{\\prime\\prime}\\right) \\cdot\\left(a_{r}^{\\prime\\prime}+b_{r}^{\\prime\\prime}\\right)-a_{l}^{\\prime\\prime} b_{l}^{\\prime\\prime}-a_{r} b_{r}^{\\prime\\prime} = \\left(3 + 4\\right) \\cdot \\left(2 + 1\\right) - 6 - 4 = 11$ –û—Ç–≤–µ—Ç: $6 \\cdot 10^2 + 11 \\cdot 10 + 4 = 714$ –¢—Ä–µ—Ç—å—è –ø–æ–¥–∑–∞–¥–∞—á–∞ ($e = 46 \\cdot 64 - 516 - 714$). –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –≤—ã—á–∏—Å–ª—è–µ–º $46 \\cdot 64$:\n$4 \\cdot 6 = 24$ $6 \\cdot 4 = 24$ $\\left(4 + 6 \\right) \\cdot (6 + 4) - 24 - 24 = 52$ –û—Ç–≤–µ—Ç: $24 \\cdot 10^2 + 52 \\cdot 10 + 24 - 516 - 714 = 1714$ –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: $1234 \\cdot 4321 = 516 \\cdot 10^4 + 1714 \\cdot 10^2 + 714 = 5,332,114$",
    "description": "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã —É–º–µ—é—Ç –∑–∞ –æ–¥–Ω—É —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é —Å–∫–ª–∞–¥—ã–≤–∞—Ç—å –¥–≤–∞ 32(–∏–ª–∏ 64)-–±–∏—Ç–Ω—ã—Ö —á–∏—Å–ª–∞. –ß–∞—Å—Ç–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏) –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∫—É–¥–∞ –±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏. –ü–æ–≥–æ–≤–æ—Ä–∏–º –æ —Ç–æ–º, –∫–∞–∫ –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Å –Ω–∏–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.\n–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –Ω–∞ –≤—Ö–æ–¥ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º –¥–∞—é—Ç—Å—è –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–µ —á–∏—Å–ª–∞ –≤ –¥–≤–æ–∏—á–Ω–æ–π –∑–∞–ø–∏—Å–∏. –ú—ã –±—É–¥–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å —á–∏—Å–ª–∞–º–∏, –∏–º–µ—é—â–∏–º–∏ –¥–≤–æ–∏—á–Ω—É—é –∑–∞–ø–∏—Å—å –¥–ª–∏–Ω—ã $n$ (–≤–æ–∑–º–æ–∂–Ω–æ, —Å –≤–µ–¥—É—â–∏–º–∏ –Ω—É–ª—è–º–∏).\n‚úçÔ∏è –í –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º —Å–ª—É—á–∞–µ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è $n$ —Ä–∞–≤–Ω–æ–≥–æ –º–∞–∫—Å–∏–º—É–º—É –∏–∑ –¥–ª–∏–Ω —á–∏—Å–µ–ª, –∞ –≤ –∫–æ–Ω—Ü–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–ª–∏–Ω—É –∑–∞–ø–∏—Å–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ (—É–¥–∞–ª–∏—Ç—å –≤–µ–¥—É—â–∏–µ –Ω—É–ª–∏), —á—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç $O(n)$ –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –Ω–µ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –æ—Ü–µ–Ω–∫—É —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞.",
    "tags": [],
    "title": "2. –≠–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–∞—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞",
    "uri": "/basics/elementary_arithmetic/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.¬†\u003e¬†17. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ",
    "content": "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ (—Ä–µ–¥–∞–∫—Ü–∏–æ–Ω–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ) –º–µ–∂–¥—É –¥–≤—É–º—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏ —ç—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –≤—Å—Ç–∞–≤–∫–∏, —É–¥–∞–ª–µ–Ω–∏—è –∏ –∑–∞–º–µ–Ω—ã —Å–∏–º–≤–æ–ª–∞, —Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–Ω–æ –∏–∑ –æ–¥–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–ª—É—á–∏—Ç—å –¥—Ä—É–≥—É—é.\n–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ –º–µ–∂–¥—É $a_{1}, \\ldots, a_{n}$ –∏ $b_{1}, \\ldots, b_{m}$ –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–ø–∞–¥–∞—é—â–∏–º —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º –ø–æ–∏—Å–∫–∞ –ù–û–ü: –ø—É—Å—Ç—å $d[i, j]$ - —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ –º–µ–∂–¥—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏ $a_{1}, \\ldots, a_{i}$ –∏ $b_{1}, \\ldots, b_{j}$. –¢–æ–≥–¥–∞ $d[i, 0]=i$, $d[0, j]=j$, –∞ –ø—Ä–∏ $i, j\u003e0$ –≤–µ—Ä–Ω–æ\n$$ d[i, j]=\\min \\left\\{\\begin{array}{l} l[i-1, j]+1 \\\\ l[i, j-1]+1 \\\\ l[i-1, j-1]+\\chi\\left(a_{i}, b_{j}\\right) \\end{array}\\right. $$–≥–¥–µ $\\chi(x, y)=0$ –ø—Ä–∏ $x=y, \\chi(x, y)=1$ –∏–Ω–∞—á–µ. –ü–µ—Ä–≤—ã–π —Å–ª—É—á–∞–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —É–¥–∞–ª–µ–Ω–∏—é $a_{i}$, –≤—Ç–æ—Ä–æ–π - –≤—Å—Ç–∞–≤–∫–µ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å $a$ —Å–∏–º–≤–æ–ª–∞ $b_{j}$ –ø–æ—Å–ª–µ $a_{i}$, —Ç—Ä–µ—Ç–∏–π - –∑–∞–º–µ–Ω–µ $a_{i}$ –Ω–∞ $b_{j}$ (–∏–ª–∏ –±–µ–∑–¥–µ–π—Å—Ç–≤–∏—é –≤ —Å–ª—É—á–∞–µ $a_{i}=b_{j}$ ).\n–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –¥–µ–ª–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é –æ—Ç–≤–µ—Ç–∞ –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–µ –ø–æ–∏—Å–∫–∞ –ù–û–ü. –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–π—Ç–∏ –ª–∏—à—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, –Ω–æ –Ω–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π, —Ç–æ —Å–Ω–æ–≤–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ $O(\\min (m, n))$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏.\n1 2 3 4 5 6 7 8 9 10 for i = 0..n: for j = 0..m: if i == 0 or j == 0: d[i, j] = max(i, j) continue d[i, j] = min(d[i - 1, j], d[i, j - 1]) + 1 if a[i] == b[j]: d[i, j] = min(d[i, j], d[i - 1, j - 1]) else: d[i, j] = min(d[i, j], d[i - 1, j - 1] + 1) –ó–Ω–∞—á–µ–Ω–∏—è $d$ –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π $2,1,2,3,1,2$ –∏ $2,3,2,2,1$:\n$$ \\begin{array}{|cc|c|c|c|c|c|c|} \\hline \u0026 \u0026 \u0026 \\color{blue}{2} \u0026 \\color{blue}{3} \u0026 \\color{blue}{2} \u0026 \\color{blue}{2} \u0026 \\color{blue}{1} \\\\ \u0026 \u0026 0 \u0026 1 \u0026 2 \u0026 3 \u0026 4 \u0026 5 \\\\ \\hline \u0026 0 \u0026 0 \u0026 1 \u0026 2 \u0026 3 \u0026 4 \u0026 5 \\\\ \\hline\\color{blue}{2} \u0026 1 \u0026 1 \u0026 0 \u0026 1 \u0026 2 \u0026 3 \u0026 4 \\\\ \\hline\\color{blue}{1} \u0026 2 \u0026 2 \u0026 1 \u0026 1 \u0026 2 \u0026 3 \u0026 4 \\\\ \\hline\\color{blue}{2} \u0026 3 \u0026 3 \u0026 2 \u0026 2 \u0026 1 \u0026 2 \u0026 3 \\\\ \\hline\\color{blue}{3} \u0026 4 \u0026 4 \u0026 3 \u0026 2 \u0026 2 \u0026 2 \u0026 3 \\\\ \\hline\\color{blue}{1} \u0026 5 \u0026 5 \u0026 4 \u0026 3 \u0026 3 \u0026 3 \u0026 2 \\\\ \\hline\\color{blue}{2} \u0026 6 \u0026 6 \u0026 5 \u0026 4 \u0026 3 \u0026 3 \u0026 3 \\\\ \\hline \\end{array} $$–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞:\n$$ \\begin{array}{|cccccc|} \\hline 2 \u0026 \\color{blue}{1} \u0026 2 \u0026 3 \u0026 1 \u0026 2 \\\\ \\hline 2 \u0026 \\color{blue}{3} \u0026 2 \u0026 \\color{blue}{3} \u0026 1 \u0026 2 \\\\ \\hline 2 \u0026 3 \u0026 2 \u0026 \\color{blue}{2} \u0026 1 \u0026 \\color{blue}{2} \\\\ \\hline 2 \u0026 3 \u0026 2 \u0026 2 \u0026 1 \u0026 \\\\ \\hline \\end{array} $$",
    "description": "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ (—Ä–µ–¥–∞–∫—Ü–∏–æ–Ω–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ) –º–µ–∂–¥—É –¥–≤—É–º—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏ —ç—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –≤—Å—Ç–∞–≤–∫–∏, —É–¥–∞–ª–µ–Ω–∏—è –∏ –∑–∞–º–µ–Ω—ã —Å–∏–º–≤–æ–ª–∞, —Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–Ω–æ –∏–∑ –æ–¥–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–ª—É—á–∏—Ç—å –¥—Ä—É–≥—É—é.\n–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ –º–µ–∂–¥—É $a_{1}, \\ldots, a_{n}$ –∏ $b_{1}, \\ldots, b_{m}$ –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–ø–∞–¥–∞—é—â–∏–º —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º –ø–æ–∏—Å–∫–∞ –ù–û–ü: –ø—É—Å—Ç—å $d[i, j]$ - —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ –º–µ–∂–¥—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏ $a_{1}, \\ldots, a_{i}$ –∏ $b_{1}, \\ldots, b_{j}$. –¢–æ–≥–¥–∞ $d[i, 0]=i$, $d[0, j]=j$, –∞ –ø—Ä–∏ $i, j\u003e0$ –≤–µ—Ä–Ω–æ",
    "tags": [],
    "title": "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞",
    "uri": "/basics/dynamic_programming/levenshtein_distance/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.¬†\u003e¬†17. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ",
    "content": "–í –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –¥–≤—É—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö –º—ã –∏–º–µ–ª–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É: –ª–∏–±–æ –º—ã —É–º–µ–µ–º –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –æ—Ç–≤–µ—Ç, –ª–∏–±–æ –º–æ–∂–µ–º —Å–µ–±–µ –ø–æ–∑–≤–æ–ª–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å $O(\\min (m, n))$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏. –ê–ª–≥–æ—Ä–∏—Ç–º –•–∏—Ä—à–±–µ—Ä–≥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –æ—Ç–≤–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É—è $O(\\min (m, n)+$ $\\log (\\max (m, n)))$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏. –ò–¥–µ—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø—Ä–∏–º–µ–Ω–∏–º–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –≤ —ç—Ç–∏—Ö –¥–≤—É—Ö, –Ω–æ –∏ –≤–æ –º–Ω–æ–≥–∏—Ö –¥—Ä—É–≥–∏—Ö –∑–∞–¥–∞—á–∞—Ö.\n–î–ª—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏ –±—É–¥–µ–º —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á—É –æ –ø–æ–∏—Å–∫–µ –ù–û–ü. –í –æ—á–µ—Ä–µ–¥–Ω–æ–π —Ä–∞–∑ –ø—Ä–∏–º–µ–Ω–∏–º –º–µ—Ç–æ–¥ ‚Äú—Ä–∞–∑–¥–µ–ª—è–π –∏ –≤–ª–∞—Å—Ç–≤—É–π‚Äù: –æ—Ç–¥–µ–ª—å–Ω–æ —Ä–µ—à–∏–º –∑–∞–¥–∞—á—É –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π $a_{1}, \\ldots, a_{n / 2}$ –∏ $b_{1}, \\ldots, b_{m}$, –∏ –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π $a_{n}, \\ldots, a_{n / 2+1}$ –∏ $b_{m}, \\ldots, b_{1}$. –ò —Ç—É, –∏ –¥—Ä—É–≥—É—é –∑–∞–¥–∞—á—É —Ä–µ—à–∏–º, –∏—Å–ø–æ–ª—å–∑—É—è $O(m)$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏.\n–ü—É—Å—Ç—å –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ $l[j]$ - –¥–ª–∏–Ω–∞ –ù–û–ü $a_{1}, \\ldots, a_{n / 2}$ –∏ $b_{1}, \\ldots, b_{j} ; r[j]$ - –¥–ª–∏–Ω–∞ –ù–û–ü $a_{n}, \\ldots, a_{n / 2+1}$ –∏ $b_{m}, \\ldots, b_{m+1-j}$. –¢–æ–≥–¥–∞ –¥–ª–∏–Ω–∞ –ù–û–ü $a_{1}, \\ldots, a_{n}$ –∏ $b_{1}, \\ldots, b_{m}$ - —ç—Ç–æ –º–∞–∫—Å–∏–º—É–º $l[j]+r[m-j]$ –ø–æ $0 \\leqslant j \\leqslant m$.\n–ü—É—Å—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –Ω–∞ $j_{\\max }$. –°–¥–µ–ª–∞–µ–º —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –∑–∞–ø—É—Å–∫–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –æ—Ç $a_{1}, \\ldots, a_{n / 2}$ –∏ $b_{1}, \\ldots, b_{j_{\\max }}$ –∏ –æ—Ç $a_{n / 2+1}, \\ldots, a_{n}$ –∏ $b_{j_{\\max }+1}, \\ldots, b_{m}$, —á—Ç–æ–±—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–ª–æ–≤–∏–Ω–∫–∏ –æ—Ç–≤–µ—Ç–∞.\n–ì–ª—É–±–∏–Ω–∞ —Ä–µ–∫—É—Ä—Å–∏–∏ —Å–æ—Å—Ç–∞–≤–∏—Ç $O(\\log n)$, –∫–∞–∂–¥—ã–π —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ $O(m)$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏, –∑–Ω–∞—á–∏—Ç, –≤—Å–µ–≥–æ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è $O(m+\\log n)$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏.\n–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É –æ—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Ä–∞–≤–Ω–∞ $O(m n)$. –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –≤—Å–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –≤—ã–∑–æ–≤—ã –Ω–∞ –≥–ª—É–±–∏–Ω–µ $k$. –í–æ –≤—Å–µ—Ö –Ω–∏—Ö –ø–µ—Ä–≤–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–º–µ–µ—Ç –¥–ª–∏–Ω—É $O\\left(n / 2^{k}\\right)$, –∞ —Å—É–º–º–∞ –¥–ª–∏–Ω –≤—Ç–æ—Ä—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –ø–æ –≤—Å–µ–º –≤—ã–∑–æ–≤–∞–º –Ω–∞ –≥–ª—É–±–∏–Ω–µ $k$ —Ä–∞–≤–Ω–∞ $m$. –ó–Ω–∞—á–∏—Ç, —Å—É–º–º–∞—Ä–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –Ω–∞ –≥–ª—É–±–∏–Ω–µ $k$ —Ä–∞–≤–Ω–æ $O\\left(m n / 2^{k}\\right)$. –¢–æ–≥–¥–∞ —Å—É–º–º–∞—Ä–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö –≤—ã–∑–æ–≤–æ–≤ –µ—Å—Ç—å\n$$ \\sum_{k} O\\left(m n / 2^{k}\\right)=O(m n) $$ 1 2 3 4 5 6 7 8 9 10 11 hirschberg(a, b): n = len(a), m = len(b) if n \u003c= 1 or m \u003c= 1: # –µ—Å–ª–∏ –æ–¥–Ω–∞ –∏–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –∏–º–µ–µ—Ç –¥–ª–∏–Ω—É –Ω–µ –±–æ–ª—å—à–µ 1, # —Ä–µ—à–∏–º –∑–∞–¥–∞—á—É –æ–±—ã—á–Ω—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º return naiveLCS(a, b) l= getLCS (a[0, n / 2), b) r = getLCS(reverse(a[n / 2, n)), reverse(b)) j = argmax (l[j] + r[m - j], j = 0..m) return hirschberg(a[0, n / 2), b[0, j)) + hirschberg(a[n / 2, n), b[j, m)) –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –î—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–±, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –ø–æ —Ç–µ–º –∂–µ –ø—Ä–∏—á–∏–Ω–∞–º: –±—É–¥–µ–º –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å, –∫–∞–∫ –æ–±—ã—á–Ω–æ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –æ—Ç–≤–µ—Ç–∞, –Ω–æ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –±—É–¥–µ–º –Ω–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–º –ø—É—Ç–∏ –æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å $i=n / 2$.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 int l[2][m + 1] int mid[2][m + 1] relax(i, j, newL, newMid): if l[i, j] \u003c newL: l[i, j] = newL, mid[i, j] = newMid hirschberg(a, b): n = len(a), m = len(b) if n \u003c= 1 or m \u003c= 1: return naiveLCS(a, b) fill(l, 0), fill(mid, 0) for i = 1..n: cur = i % 2, prev = 1 - cur for j = 1..m: relax(cur, j, l[prev, j], mid[prev, j]) relax(cur, j, l[cur, j - 1], mid[cur, j - 1]) if a[i] == b[j]: relax(cur, j, l[prev, j - 1] + 1, mid[prev, j - 1]) if i == n / 2: mid[cur, j] = j j = mid[n, m] return hirschberg(a[0, n / 2), b[0, j)) + hirschberg(a[n / 2, n), b[j, m))",
    "description": "–í –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –¥–≤—É—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö –º—ã –∏–º–µ–ª–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É: –ª–∏–±–æ –º—ã —É–º–µ–µ–º –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –æ—Ç–≤–µ—Ç, –ª–∏–±–æ –º–æ–∂–µ–º —Å–µ–±–µ –ø–æ–∑–≤–æ–ª–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å $O(\\min (m, n))$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏. –ê–ª–≥–æ—Ä–∏—Ç–º –•–∏—Ä—à–±–µ—Ä–≥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –æ—Ç–≤–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É—è $O(\\min (m, n)+$ $\\log (\\max (m, n)))$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏. –ò–¥–µ—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø—Ä–∏–º–µ–Ω–∏–º–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –≤ —ç—Ç–∏—Ö –¥–≤—É—Ö, –Ω–æ –∏ –≤–æ –º–Ω–æ–≥–∏—Ö –¥—Ä—É–≥–∏—Ö –∑–∞–¥–∞—á–∞—Ö.\n–î–ª—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏ –±—É–¥–µ–º —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á—É –æ –ø–æ–∏—Å–∫–µ –ù–û–ü. –í –æ—á–µ—Ä–µ–¥–Ω–æ–π —Ä–∞–∑ –ø—Ä–∏–º–µ–Ω–∏–º –º–µ—Ç–æ–¥ ‚Äú—Ä–∞–∑–¥–µ–ª—è–π –∏ –≤–ª–∞—Å—Ç–≤—É–π‚Äù: –æ—Ç–¥–µ–ª—å–Ω–æ —Ä–µ—à–∏–º –∑–∞–¥–∞—á—É –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π $a_{1}, \\ldots, a_{n / 2}$ –∏ $b_{1}, \\ldots, b_{m}$, –∏ –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π $a_{n}, \\ldots, a_{n / 2+1}$ –∏ $b_{m}, \\ldots, b_{1}$. –ò —Ç—É, –∏ –¥—Ä—É–≥—É—é –∑–∞–¥–∞—á—É —Ä–µ—à–∏–º, –∏—Å–ø–æ–ª—å–∑—É—è $O(m)$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏.",
    "tags": [],
    "title": "–ê–ª–≥–æ—Ä–∏—Ç–º –•–∏—Ä—à–±–µ—Ä–≥–∞",
    "uri": "/basics/dynamic_programming/hirschbergs_algorithm/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.",
    "content": "–û—Å–Ω–æ–≤–Ω–∞—è —Ç–µ–æ—Ä–µ–º–∞ –æ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –ê–ª–≥–æ—Ä–∏—Ç–º –ö–∞—Ä–∞—Ü—É–±—ã - –ø—Ä–∏–º–µ—Ä –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–µ—Ç–æ–¥–∞ ‚Äú—Ä–∞–∑–¥–µ–ª—è–π –∏ –≤–ª–∞—Å—Ç–≤—É–π‚Äù (‚Äúdivide-and-conquer‚Äù), —Å –∫–æ—Ç–æ—Ä—ã–º –º—ã –µ—â—ë –Ω–µ —Ä–∞–∑ –≤—Å—Ç—Ä–µ—Ç–∏–º—Å—è.\n–ò–¥–µ—è —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã —Å–≤–µ—Å—Ç–∏ —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∫ —Ä–µ—à–µ–Ω–∏—é –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–¥–∑–∞–¥–∞—á –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –º–µ–Ω—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, –ø–æ—Å–ª–µ —á–µ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏ —Å –ø–æ–º–æ—â—å—é —Ä–µ—à–µ–Ω–∏–π –ø–æ–¥–∑–∞–¥–∞—á. –°–µ–π—á–∞—Å –º—ã –¥–æ–∫–∞–∂–µ–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–±—â—É—é —Ç–µ–æ—Ä–µ–º—É, –ø—Ä–∏–º–µ–Ω–∏–º—É—é –∫ –æ—Ü–µ–Ω–∫–µ –º–Ω–æ–≥–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö –º–µ—Ç–æ–¥ ‚Äú—Ä–∞–∑–¥–µ–ª—è–π –∏ –≤–ª–∞—Å—Ç–≤—É–π‚Äù.\n–û—Å–Ω–æ–≤–Ω–∞—è —Ç–µ–æ—Ä–µ–º–∞ –æ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –ü—É—Å—Ç—å $T(n)=a \\cdot T\\left(\\left\\lceil\\frac{n}{b}\\right\\rceil\\right)+\\Theta\\left(n^{c}\\right)$, –≥–¥–µ $a\u003e0, b\u003e1, c \\geqslant 0$. –¢–æ–≥–¥–∞\n$$T(n)= \\begin{cases}\\Theta\\left(n^{c}\\right), \u0026 \\text { –µ—Å–ª–∏ } c \u003e \\log_{b} a \\\\ \\Theta\\left(n^{c} \\log n\\right), \u0026 \\text { –µ—Å–ª–∏ } c=\\log _{b} a \\\\ \\Theta\\left(n^{\\log _{b} a}\\right), \u0026 \\text { –µ—Å–ª–∏ } c \u003c \\log_{b} a\\end{cases}$$ –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –ü—É—Å—Ç—å –º—ã —É–∂–µ –¥–æ–∫–∞–∑–∞–ª–∏ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç–µ–æ—Ä–µ–º—ã –¥–ª—è —á–∏—Å–µ–ª –≤–∏–¥–∞ $n=b^{k}$. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç–∞–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é $k(n)$, —á—Ç–æ –¥–ª—è –ª—é–±–æ–≥–æ $n$ –≤–µ—Ä–Ω–æ $b^{k(n)-1} \u003c n \\leqslant b^{k(n)}$. –ü—Ä–∏ —É–º–µ–Ω—å—à–µ–Ω–∏–∏ $n$ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ—Ç–æ–∫ –≤ –¥–µ—Ä–µ–≤–µ —Ä–µ–∫—É—Ä—Å–∏–∏ –∏ –∏—Ö —Ä–∞–∑–º–µ—Ä –º–æ–≥–ª–∏ —Ç–æ–ª—å–∫–æ —É–º–µ–Ω—å—à–∏—Ç—å—Å—è, –ø–æ—ç—Ç–æ–º—É\n$$ T(n) = O \\left(T\\left(b^{k(n)}\\right)\\right)= \\begin{cases}O\\left(b^{k(n) c}\\right)=O\\left(n^{c}\\right), \u0026 \\text { –µ—Å–ª–∏ } c\u003e\\log _{b} a \\\\ O\\left(b^{k(n) c} \\log \\left(b^{k(n)}\\right)\\right)=O\\left(n^{c} \\log n\\right), \u0026 \\text { –µ—Å–ª–∏ } c=\\log _{b} a \\\\ O\\left(b^{k(n) \\log _{b} a}\\right)=O\\left(n^{\\log _{b} a}\\right), \u0026 \\text { –µ—Å–ª–∏ } c \u003c \\log _{b} a\\end{cases} $$(–º—ã –ø–æ–ª—å–∑—É–µ–º—Å—è —Ç–µ–º, —á—Ç–æ $b^{k(n)} = b \\cdot b^{k(n)-1} \u003c b n = O(n)$ ). –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –∂–µ —Ç–æ—á–Ω–æ–π –∞—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–æ–π –æ—Ü–µ–Ω–∫–∏ $(\\Theta)$ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ $n$ —Ç—Ä–µ–±—É–µ—Ç –µ—â—ë –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –≤—ã–∫–ª–∞–¥–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –æ–ø—É—Å—Ç–∏–º. –ñ–µ–ª–∞—é—â–∏–µ –º–æ–≥—É—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∏—Ö –≤ –≥–ª–∞–≤–µ 4.6 –≤ –ö–æ—Ä–º–µ–Ω–µ1.\n–¢–µ–ø–µ—Ä—å —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ $n=b^{k}$ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ $k$. –†–∞—Å–∫—Ä–æ–µ–º —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å:\n$$ \\begin{gathered} T(n)=a \\cdot T\\left(\\frac{n}{b}\\right)+\\Theta\\left(n^{c}\\right)=\\Theta\\left(n^{c}+a \\cdot\\left(\\frac{n}{b}\\right)^{c}\\right)+a^{2} T\\left(\\frac{n}{b^{2}}\\right)= \\\\ =\\cdots=\\Theta\\left(n^{c} \\cdot\\left(1+\\frac{a}{b^{c}}+\\left(\\frac{a}{b^{c}}\\right)^{2}+\\cdots+\\left(\\frac{a}{b^{c}}\\right)^{k-1}\\right)\\right)+a^{k} T(1)= \\\\ =\\Theta\\left(n^{c} \\cdot\\left(1+\\frac{a}{b^{c}}+\\left(\\frac{a}{b^{c}}\\right)^{2}+\\cdots+\\left(\\frac{a}{b^{c}}\\right)^{k}\\right)\\right) \\end{gathered} $$(–ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–ª–∞–≥–∞–µ–º–æ–µ $a^{k} T(1)=\\Theta\\left(a^{k}\\right)=\\Theta\\left(n^{c} \\cdot\\left(\\frac{a}{b^{c}}\\right)^{k}\\right)$, —Ç–∞–∫ –∫–∞–∫ $\\left.T(1)=\\Theta(1), n=b^{k}\\right)$. –ü–æ–ª—É—á–∞–µ–º –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—é —Å–æ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª–µ–º $q=\\frac{a}{b^{c}}$.\n–ï—Å–ª–∏ $c\u003e\\log _{b} a$, —Ç–æ $q \u003c 1$, —Ç–æ–≥–¥–∞\n$$ T(n)=\\Theta\\left(n^{c} \\cdot \\frac{1-q^{k+1}}{1-q}\\right)=\\Theta\\left(n^{c} \\cdot \\frac{1}{1-q}\\right)=\\Theta\\left(n^{c}\\right) $$–ï—Å–ª–∏ $c=\\log _{b} a$, —Ç–æ $q=1$, —Ç–æ–≥–¥–∞\n$$ T(n)=\\Theta\\left(n^{c} \\cdot(k+1)\\right)=\\Theta\\left(n^{c} \\log _{b} n\\right)=\\Theta\\left(n^{c} \\log n\\right) $$–ù–∞–∫–æ–Ω–µ—Ü, –µ—Å–ª–∏ $c \u003c \\log _{b} a$, —Ç–æ $q\u003e1$, —Ç–æ–≥–¥–∞\n$$ T(n)=\\Theta\\left(n^{c} \\cdot\\left(q^{k}+\\frac{q^{k}-1}{q-1}\\right)\\right)=\\Theta\\left(n^{c} q^{k}\\right)=\\Theta\\left(a^{k}\\right)=\\Theta\\left(a^{\\log _{b} n}\\right)=\\Theta\\left(n^{\\log _{b} a}\\right) $$ Introduction to Algorithms (Fourth Edition)¬†‚Ü©Ô∏é\n–í –∞–ª–≥–æ—Ä–∏—Ç–º–µ –ö–∞—Ä–∞—Ü—É–±—ã $a=3, b=2, c=1$, —ç—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ—Ç—å–µ–º—É —Å–ª—É—á–∞—é —Ç–µ–æ—Ä–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–π –∏ –¥–∞—ë—Ç $T(n)=\\Theta\\left(n^{\\log _{2} 3}\\right)$.\n–û—Ü–µ–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –ü—Ä–∏–º–µ—Ä 1 1 2 3 4 5 6 7 8 9 10 11 12 void foo(int* array, int n) { int sum = 0; int product = 1; for (int i = 0; i \u003c n; i++) { sum += array[i]; } for (int i = 0; i \u003c n; i++) { product += array[i]; } std::cout \u003c\u003c sum \u003c\u003c \", \" \u003c\u003c product; } –ü—Ä–∏–º–µ—Ä 2 1 2 3 4 5 6 7 void printPairs(int* arr, int n) { for (int i = 0; i \u003c n; i++) { for (int j = 0; j \u003c n; j++) { std::cout \u003c\u003c arr[i] \u003c\u003c \", \" \u003c\u003c arr[j] \u003c\u003c std::endl; } } } –ü—Ä–∏–º–µ—Ä 3 1 2 3 4 5 6 7 void printPairs(int* arr, int n) { for (int i = 0; i \u003c n; i++) { for (int j = i + 1; j \u003c n; j++) { std::cout \u003c\u003c arr[i] \u003c\u003c \", \" \u003c\u003c arr[j] \u003c\u003c std::endl; } } } –ü—Ä–∏–º–µ—Ä 4 1 2 3 4 5 6 7 8 9 void printUnorderedPairs(int* arrA, int n, int* arrB, int m) { for (int i = 0; i \u003c n; i++) { for (int j = 0; j \u003c m; j++) { if (arrA[i] \u003c arrB[j]) { std::cout \u003c\u003c arr[i] \u003c\u003c \", \" \u003c\u003c arr[j] \u003c\u003c std::endl; } } } } –ü—Ä–∏–º–µ—Ä 5 1 2 3 4 5 6 7 8 9 void printUnorderedPairs(int* arrA, int n, int* arrB, int m) { for (int i = 0; i \u003c n; i++) { for (int j = 0; j \u003c m; j++) { for (int j = 0; j \u003c 100000; j++) { std::cout \u003c\u003c arr[i] \u003c\u003c \", \" \u003c\u003c arr[j] \u003c\u003c std::endl; } } } } –ü—Ä–∏–º–µ—Ä 6 1 2 3 4 5 6 7 8 void reverse(int* arr, int n) { for (int i = 0; i \u003c n / 2; i++) { int other = n - i - 1; int temp = arr[i]; arr[i] = arr[other]; arr[other] = temp } } –ü—Ä–∏–º–µ—Ä 7 1 2 3 4 5 6 7 8 9 bool isPrime(int n) { for (int x = 2; x * x \u003c= n; x++) { if (n % x == 0) { return false; } } return true; } –ü—Ä–∏–º–µ—Ä 8 1 2 3 4 5 6 7 8 9 int factorial(int n) { if (n \u003c 0) { return -1; } else if (n == 0) { return 1; } else { return n * factorial(n - 1); } } –ü—Ä–∏–º–µ—Ä 9 1 2 3 4 5 int fib(int n) { if (n \u003c= 0) return 0; else if (n == 1) return 1; else fib(n - 1) + fib(n - 2); }",
    "description": "–û—Å–Ω–æ–≤–Ω–∞—è —Ç–µ–æ—Ä–µ–º–∞ –æ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –ê–ª–≥–æ—Ä–∏—Ç–º –ö–∞—Ä–∞—Ü—É–±—ã - –ø—Ä–∏–º–µ—Ä –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–µ—Ç–æ–¥–∞ ‚Äú—Ä–∞–∑–¥–µ–ª—è–π –∏ –≤–ª–∞—Å—Ç–≤—É–π‚Äù (‚Äúdivide-and-conquer‚Äù), —Å –∫–æ—Ç–æ—Ä—ã–º –º—ã –µ—â—ë –Ω–µ —Ä–∞–∑ –≤—Å—Ç—Ä–µ—Ç–∏–º—Å—è.\n–ò–¥–µ—è —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã —Å–≤–µ—Å—Ç–∏ —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∫ —Ä–µ—à–µ–Ω–∏—é –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–¥–∑–∞–¥–∞—á –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –º–µ–Ω—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, –ø–æ—Å–ª–µ —á–µ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏ —Å –ø–æ–º–æ—â—å—é —Ä–µ—à–µ–Ω–∏–π –ø–æ–¥–∑–∞–¥–∞—á. –°–µ–π—á–∞—Å –º—ã –¥–æ–∫–∞–∂–µ–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–±—â—É—é —Ç–µ–æ—Ä–µ–º—É, –ø—Ä–∏–º–µ–Ω–∏–º—É—é –∫ –æ—Ü–µ–Ω–∫–µ –º–Ω–æ–≥–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö –º–µ—Ç–æ–¥ ‚Äú—Ä–∞–∑–¥–µ–ª—è–π –∏ –≤–ª–∞—Å—Ç–≤—É–π‚Äù.",
    "tags": [],
    "title": "3. –†–µ–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è",
    "uri": "/basics/recurrence_relation/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.",
    "content": "–ú–∞—Å—Å–∏–≤ –ú–∞—Å—Å–∏–≤ (array) - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è —Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞–±–æ—Ä –∑–Ω–∞—á–µ–Ω–∏–π –≤ —è—á–µ–π–∫–∞—Ö, –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–∞–º–∏ (–∏–ª–∏ –Ω–∞–±–æ—Ä–æ–º –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ —Å–ª—É—á–∞–µ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞) –∏–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –æ—Ç—Ä–µ–∑–∫–∞ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª. –í—Å—Ç—Ä–æ–µ–Ω –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —è–∑—ã–∫–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.\n–ú–∞—Å—Å–∏–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–µ $(O(1))$ –≤—Ä–µ–º—è –ø–æ–ª—É—á–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ —ç–ª–µ–º–µ–Ω—Ç—É –ø–æ –∏–Ω–¥–µ–∫—Å—É, –∞ —Ç–∞–∫–∂–µ –∏–∑–º–µ–Ω—è—Ç—å —ç—Ç–æ—Ç —ç–ª–µ–º–µ–Ω—Ç. –ü—Ä–∏ —ç—Ç–æ–º –º–∞—Å—Å–∏–≤ –∏–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä, –ø–æ—ç—Ç–æ–º—É –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π –≤—Å—Ç–∞–≤–∫–∏ –∏ —É–¥–∞–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –ï—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –≤—Å—Ç–∞–≤–∏—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –º–∞—Å—Å–∏–≤ –Ω—É–∂–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –Ω–µ–≥–æ, –Ω–æ —ç—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç $\\Theta(n)$ –æ–ø–µ—Ä–∞—Ü–∏–π, –≥–¥–µ $n$ - –¥–ª–∏–Ω–∞ –º–∞—Å—Å–∏–≤–∞.\n–ü–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –º–∞—Å—Å–∏–≤–µ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é —Ç–∞–∫–∂–µ –∏–º–µ–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å $\\Theta(n)$, —Ç–∞–∫ –∫–∞–∫ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Å—Å–∏–≤–∞. –ï—Å–ª–∏ –º–∞—Å—Å–∏–≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Å—Å–∏–≤–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ), —Ç–æ –ø–æ–∏—Å–∫ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ (—Å–∫–æ—Ä–æ –º—ã –∏–∑—É—á–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º –¥–≤–æ–∏—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞).\n–ù–µ–º–Ω–æ–≥–æ –Ω–∞–ø–æ–º–Ω–∏–º –æ —Ä–∞–±–æ—Ç–µ —Å –º–∞—Å—Å–∏–≤–æ–º –≤ Python/C++: ‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 12 13 # –û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–º–µ—Ä–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –¥–ª–∏–Ω—ã n a = [0] * n # —Å–æ–∑–¥–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∏–∑ n –Ω—É–ª–µ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ # –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ i-–º—É —ç–ª–µ–º–µ–Ω—Ç—É element = a[i] # –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è a[i] = x # –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è # –û–±—ä—è–≤–ª–µ–Ω–∏–µ –¥–≤—É–º–µ—Ä–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ —Ä–∞–∑–º–µ—Ä–æ–º n x m b = [[0] * m for _ in range(n)] # —Å–æ–∑–¥–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∏–∑ n —Å—Ç—Ä–æ–∫, –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ - —Å–ø–∏—Å–æ–∫ –∏–∑ m –Ω—É–ª–µ–π # –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ —ç–ª–µ–º–µ–Ω—Ç—É –ø–æ –∏–Ω–¥–µ–∫—Å–∞–º value = b[i][j] # –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è b[i][j] = y # –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è 1 2 3 4 5 6 7 int a[n]; // –æ–±—ä—è–≤–∏—Ç—å –º–∞—Å—Å–∏–≤ –¥–ª–∏–Ω—ã n, –Ω—É–º–µ—Ä–∞—Ü–∏—è —è—á–µ–µ–∫ –æ—Ç 0 –¥–æ n-1 a[i]; // –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ i-–º—É —ç–ª–µ–º–µ–Ω—Ç—É –º–∞—Å—Å–∏–≤–∞ a[i] = x; // –ø—Ä–∏—Å–≤–æ–∏—Ç—å x –≤ i-—é —è—á–µ–π–∫—É –º–∞—Å—Å–∏–≤–∞ int b[n][m]; // –æ–±—ä—è–≤–∏—Ç—å –¥–≤—É–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤, –Ω—É–º–µ—Ä–∞—Ü–∏—è —è—á–µ–µ–∫ –¥–≤—É–º—è –∏–Ω–¥–µ–∫—Å–∞–º–∏, // –æ—Ç 0 –¥–æ n-1 –∏ –æ—Ç 0 –¥–æ m-1 b[i][j]; // –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ j-–º—É —ç–ª–µ–º–µ–Ω—Ç—É i-–π —Å—Ç—Ä–æ–∫–∏ –º–∞—Å—Å–∏–≤–∞ b[i][j] = y; // –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ –°–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫ –°–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫ (linked list) —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —É–∑–ª–æ–≤, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–æ—Å–µ–¥–Ω–∏–µ —É–∑–ª—ã. –í –¥–≤—É—Å–≤—è–∑–Ω–æ–º —Å–ø–∏—Å–∫–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —É–∑–µ–ª, –≤ –æ–¥–Ω–æ—Å–≤—è–∑–Ω–æ–º —Å–ø–∏—Å–∫–µ - —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π. –¢–∞–∫–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Å—Å—ã–ª–∫–∏ –Ω–∞ –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞ (–∏—Ö —á–∞—Å—Ç–æ –Ω–∞–∑—ã–≤–∞—é—Ç –≥–æ–ª–æ–≤–æ–π –∏ —Ö–≤–æ—Å—Ç–æ–º). –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ—Å–µ—Ç–∏—Ç—å –≤—Å–µ —É–∑–ª—ã, –º–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å —Å –≥–æ–ª–æ–≤—ã –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –ø–æ —Å—Å—ã–ª–∫–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —É–∑–µ–ª, –ø–æ–∫–∞ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.\n–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ —Å–ø–∏—Å–∫–∞ –ø–µ—Ä–µ–¥ –º–∞—Å—Å–∏–≤–æ–º - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—Å—Ç–∞–≤–ª—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∑–∞ $O(1)$.\n–ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ —Å–ø–∏—Å–∫–∞ - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É. –¢–∞–∫, –¥–æ—Å—Ç—É–ø –∫ $i$-–º—É —ç–ª–µ–º–µ–Ω—Ç—É –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –ª–∏—à—å $i$ —Ä–∞–∑ –ø—Ä–æ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ –≤–ø–µ—Ä—ë–¥, –Ω–∞—á–∏–Ω–∞—è –∏–∑ –≥–æ–ª–æ–≤—ã —Å–ø–∏—Å–∫–∞ (—Ç–æ –µ—Å—Ç—å –∑–∞ $\\Theta(i)$ ).\n–£–¥–æ–±–Ω–æ –¥–µ–ª–∞—Ç—å –≥–æ–ª–æ–≤—É –∏ —Ö–≤–æ—Å—Ç —Ñ–∏–∫—Ç–∏–≤–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∏ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å –≤ –Ω–∏—Ö –Ω–∏–∫–∞–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö, —Ç–æ–≥–¥–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –≤—Å—Ç–∞–≤–∫–∏ –∏ —É–¥–∞–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–∏—à—É—Ç—Å—è –ø—Ä–æ—â–µ.\n–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–≤—É—Å–≤—è–∑–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –Ω–∞ Python/C++: ‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 class Node: \"\"\"–û–¥–∏–Ω —É–∑–µ–ª —Å–ø–∏—Å–∫–∞\"\"\" def __init__(self, x=None): self.next = None # —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —É–∑–µ–ª self.prev = None # —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —É–∑–µ–ª self.x = x # –¥–∞–Ω–Ω—ã–µ, —Ö—Ä–∞–Ω—è—â–∏–µ—Å—è –≤ —É–∑–ª–µ class List: \"\"\"–î–≤—É—Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å —Ñ–∏–∫—Ç–∏–≤–Ω—ã–º–∏ –≥–æ–ª–æ–≤–æ–π –∏ —Ö–≤–æ—Å—Ç–æ–º\"\"\" def __init__(self): \"\"\"–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞ - —Å–æ–∑–¥–∞—ë–º —Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ head –∏ tail –∏ —Å–≤—è–∑—ã–≤–∞–µ–º –∏—Ö –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º\"\"\" self.head = Node() self.tail = Node() self.head.next = self.tail self.tail.prev = self.head def pushBack(self, x): \"\"\"–í—Å—Ç–∞–≤–∏—Ç—å x –≤ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞\"\"\" v = Node(x) v.prev = self.tail.prev v.next = self.tail v.prev.next = v self.tail.prev = v def insert(self, v, x): \"\"\"–í—Å—Ç–∞–≤–∏—Ç—å x –ø–æ—Å–ª–µ —É–∑–ª–∞ v\"\"\" w = Node(x) w.next = v.next w.prev = v v.next = w w.next.prev = w def erase(self, v): \"\"\"–£–¥–∞–ª–∏—Ç—å —É–∑–µ–ª v\"\"\" v.prev.next = v.next v.next.prev = v.prev # –í Python –Ω–µ—Ç —è–≤–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è, —Å–±–æ—Ä—â–∏–∫ –º—É—Å–æ—Ä–∞ –æ—Å–≤–æ–±–æ–¥–∏—Ç –ø–∞–º—è—Ç—å def find(self, x): \"\"\"–ù–∞–π—Ç–∏ x –≤ —Å–ø–∏—Å–∫–µ, –≤–µ—Ä–Ω—É—Ç—å —É–∑–µ–ª –∏–ª–∏ None\"\"\" v = self.head.next while v != self.tail: if v.x == x: return v v = v.next return None 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 struct Node { // –æ–¥–∏–Ω —É–∑–µ–ª —Å–ø–∏—Å–∫–∞ Node *next, *prev; // —É–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —É–∑–ª—ã int x; // –¥–∞–Ω–Ω—ã–µ, —Ö—Ä–∞–Ω—è—â–∏–µ—Å—è –≤ —É–∑–ª–µ }; struct List { Node *head, *tail; // —É–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞ List() { // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ - —Å–æ–∑–¥–∞—ë–º —Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ head –∏ tail // –∏ —Å–≤—è–∑—ã–≤–∞–µ–º –∏—Ö –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º head = new Node(); tail = new Node(); head-\u003enext = tail; tail-\u003eprev = head; } void pushBack(int x) { // –≤—Å—Ç–∞–≤–∏—Ç—å x –≤ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞ Node *v = new Node(); v-\u003ex = x, v-\u003eprev = tail-\u003eprev, v-\u003enext = tail; v-\u003eprev-\u003enext = v, tail-\u003eprev = v; } void insert(Node *v, int x) { // –≤—Å—Ç–∞–≤–∏—Ç—å x –ø–æ—Å–ª–µ v Nove *w = new Node(); w-\u003ex = x, w-\u003enext = v-\u003enext, w-\u003eprev = v; v-\u003enext = w, w-\u003enext-\u003eprev = w; } void erase(Node *v) { // —É–¥–∞–ª–∏—Ç—å —É–∑–µ–ª v v-\u003eprev-\u003enext = v-\u003enext; v-\u003enext-\u003eprev = v-\u003eprev; delete v; } Node *find(int x) { // –Ω–∞–π—Ç–∏ x –≤ —Å–ø–∏—Å–∫–µ for (Node *v = head-\u003enext; v != tail; v = v-\u003enext) { if (v-\u003ex == x) { return v; } } return nullptr; } }; –ú–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å —É–∑–ª—ã —Å–ø–∏—Å–∫–∞ –≤ –º–∞—Å—Å–∏–≤–µ, —Ç–æ–≥–¥–∞ –≤–º–µ—Å—Ç–æ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á–∏—Å–ª–∞ - –Ω–æ–º–µ—Ä–∞ —è—á–µ–µ–∫ –º–∞—Å—Å–∏–≤–∞. –ù–æ —Ç–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ª–∏–±–æ –∑–∞—Ä–∞–Ω–µ–µ –∑–Ω–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Å–ø–∏—Å–∫–µ, –ª–∏–±–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –º–∞—Å—Å–∏–≤ (–∫–æ—Ç–æ—Ä—ã–π –º—ã —Å–∫–æ—Ä–æ –∏–∑—É—á–∏–º).\n–ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ C++ –¥–≤—É—Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫ - std::list. –û–¥–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ–Ω—å—à–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏, –Ω–æ –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–º–µ—â–∞—Ç—å—Å—è –ø–æ —Å–ø–∏—Å–∫—É –≤ —Å—Ç–æ—Ä–æ–Ω—É –Ω–∞—á–∞–ª–∞. –¢–∞–∫–∂–µ –∏–∑ –Ω–µ–≥–æ —Å–ª–æ–∂–Ω–µ–µ —É–¥–∞–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã - –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç, –∏–º–µ—è —Å—Å—ã–ª–∫—É —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω–µ–≥–æ. –ù—É–∂–Ω–æ –∫–∞–∫-—Ç–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É, —á—Ç–æ–±—ã –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —Å—Å—ã–ª–∫—É –∏–∑ –Ω–µ–≥–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π.\n–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –º–∞—Å—Å–∏–≤ –ü—É—Å—Ç—å –º—ã —Ö–æ—Ç–∏–º –Ω–∞—É—á–∏—Ç—å—Å—è –≤—Å—Ç–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –∫–æ–Ω–µ—Ü –º–∞—Å—Å–∏–≤–∞. –ú–æ–∂–Ω–æ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å—Ä–∞–∑—É —Å–æ–∑–¥–∞—Ç—å –º–∞—Å—Å–∏–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, –∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –µ–≥–æ —Ä–µ–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É. –ù–æ –¥–∞–ª–µ–∫–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑–≤–µ—Å—Ç–Ω–æ –∑–∞—Ä–∞–Ω–µ–µ.\n–ü–æ—Å—Ç—É–ø–∏–º —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º: –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –≤—Å—Ç–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç, –∞ –º–µ—Å—Ç–æ –≤ –º–∞—Å—Å–∏–≤–µ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å, —Ç–æ —Å–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤—ã–π –º–∞—Å—Å–∏–≤ –≤–¥–≤–æ–µ –±–æ–ª—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, –∏ —Å–∫–æ–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ —Ç—É–¥–∞. ‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 int *a; // –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –ø–∞–º—è—Ç—å int size; // —Ä–∞–∑–º–µ—Ä –ø–∞–º—è—Ç–∏ int n; // —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ void pushBack(int x) { // –≤—Å—Ç–∞–≤–∏—Ç—å —Ö –≤ –∫–æ–Ω–µ—Ü –º–∞—Å—Å–∏–≤–∞ if (n == size) { int *b = new int[size * 2]; for (int i = 0; i \u003c size; ++i) { b[i] = a[i]; } delete[] a; a = b; size *= 2; } a[n] = x; n += 1; } void popBack() { // —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç n -= 1; } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 # –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –ø–∞–º—è—Ç—å a = [] # —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ n = 0 def pushBack(x): # –≤—Å—Ç–∞–≤–∏—Ç—å —Ö –≤ –∫–æ–Ω–µ—Ü –º–∞—Å—Å–∏–≤–∞ global a, n # –í Python —Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è, # –Ω–æ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞: if n == len(a): # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ —Å —É–¥–≤–æ–µ–Ω–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º (–∏–ª–∏ –Ω–∞—á–∞–ª—å–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º 1) new_size = max(1, len(a) * 2) # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º b = [0] * new_size # –ö–æ–ø–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã for i in range(n): b[i] = a[i] a = b a[n] = x n += 1 def popBack(): # —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç global n if n \u003e 0: n -= 1 # –ü—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –º–æ–∂–Ω–æ –æ—á–∏—â–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ # a[n] = 0 –í C++ –º–æ–∂–Ω–æ –∏ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ std::vector.\n–ö–∞–∂–¥–∞—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –≤—Å—Ç–∞–≤–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–æ–ª–≥–æ $-\\Theta(n)$, –≥–¥–µ $n$ - –¥–ª–∏–Ω–∞ –º–∞—Å—Å–∏–≤–∞. –ó–∞—Ç–æ –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—Å—Ç–∞–≤–∫–∏ $O(1)$. –î–æ–∫–∞–∂–µ–º —ç—Ç–æ—Ç —Ñ–∞–∫—Ç –ø—Ä–∏ –ø–æ–º–æ—â–∏ –º–µ—Ç–æ–¥–∞ –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–º –µ—â—ë –Ω–µ —Ä–∞–∑ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è.\n–°–≤–æ–π—Å—Ç–≤–æ 4.3.1 –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—Å—Ç–∞–≤–∫–∏ - $O(1)$.\n‚úçÔ∏è –≠—Ç–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ—Å–∏–ª—å–Ω–æ —Ç–æ–º—É, —á—Ç–æ —Å—É–º–º–∞—Ä–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã $m$ –æ–ø–µ—Ä–∞—Ü–∏–π –≤—Å—Ç–∞–≤–∫–∏ - $O(m)$.\n–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –û–ø–µ—Ä–∞—Ü–∏—è –≤—Å—Ç–∞–≤–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ –∑–∞ $O(1)$ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —É–¥–≤–æ–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –ø–∞–º—è—Ç–∏. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –µ—Å–ª–∏ —Ç–∞–∫–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è —É–≤–µ–ª–∏—á–∏–ª–∞ —Ä–∞–∑–º–µ—Ä —Å size –¥–æ $2 \\cdot$ size, —Ç–æ —Ö–æ—Ç—è –±—ã size $/ 2$ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤—Å—Ç–∞–≤–∫–∏ —Ä–∞–±–æ—Ç–∞–ª–∏ –∑–∞ $O(1)$ (–º–æ–∂–µ—Ç –±—ã—Ç—å, –∏ –±–æ–ª—å—à–µ, –µ—Å–ª–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∏ —Ç–∞–∫–∂–µ —É–¥–∞–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤). –¢–æ–≥–¥–∞ —Å—É–º–º–∞—Ä–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —ç—Ç–∏—Ö size $/ 2+1$ –æ–ø–µ—Ä–∞—Ü–∏–π –µ—Å—Ç—å $O$ (size), –ø–æ—ç—Ç–æ–º—É —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –∏—Ö —Ä–∞–±–æ—Ç—ã –µ—Å—Ç—å $O(1)$.\n–°—Ç–µ–∫, –æ—á–µ—Ä–µ–¥—å, –¥–µ–∫ –°—Ç–µ–∫ (stack) –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –≤—Å—Ç–∞–≤–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞, –∞ —Ç–∞–∫–∂–µ —É–¥–∞–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –∫–æ–Ω—Ü–∞ —Å–ø–∏—Å–∫–∞. –ß–∞—Å—Ç–æ —Ç–∞–∫–∂–µ –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ –æ–Ω –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É LIFO (last in - first out).\n–û—á–µ—Ä–µ–¥—å (queue) –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É FIFO (first in - first out). –û–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—Å—Ç–∞–≤–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞, –∞ —Ç–∞–∫–∂–µ —É–¥–∞–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –Ω–∞—á–∞–ª–∞ —Å–ø–∏—Å–∫–∞.\n–î–µ–∫ (deque - double ended queue), –∏–ª–∏ –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –æ—á–µ—Ä–µ–¥—å, –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –æ–±—ã—á–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏ —Ç–µ–º, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∫–∞–∫ –≤ –Ω–∞—á–∞–ª–æ, —Ç–∞–∫ –∏ –≤ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞.\n–í—Å–µ —ç—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é —Å–≤—è–∑–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞. –î–ª—è —Å—Ç–µ–∫–∞ –∏ –æ—á–µ—Ä–µ–¥–∏ —Ö–≤–∞—Ç–∏—Ç –æ–¥–Ω–æ—Å–≤—è–∑–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞: –≤ —Å—Ç–µ–∫–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç, –∞ –≤ –æ—á–µ—Ä–µ–¥–∏ - –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π. –î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–µ–∫–∞ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–≤—É—Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫.\n–¢–∞–∫–∂–µ –≤—Å–µ —Ç—Ä–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Å—Å–∏–≤–∞. –í —Å–ª—É—á–∞–µ –¥–µ–∫–∞ –Ω—É–∂–Ω–æ –Ω–∞—É—á–∏—Ç—å—Å—è –¥–æ–±–∞–≤–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –Ω–∞—á–∞–ª–æ, –¥–ª—è —á–µ–≥–æ –º–æ–∂–Ω–æ –∑–∞—Ü–∏–∫–ª–∏—Ç—å –º–∞—Å—Å–∏–≤. –¢–æ –∂–µ —Å–∞–º–æ–µ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—á–µ—Ä–µ–¥–∏, —á—Ç–æ–±—ã –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Å–≤–æ–±–æ–¥–∏–≤—à–µ–µ—Å—è –º–µ—Å—Ç–æ –≤ –Ω–∞—á–∞–ª–µ –º–∞—Å—Å–∏–≤–∞. –ü—Ä–∏–≤–µ–¥—ë–º –ø—Ä–∏–º–µ—Ä–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –¥–µ–∫–∞ –Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º –º–∞—Å—Å–∏–≤–µ: ‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 class Deque: def __init__(self): self.a = [] # –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –ø–∞–º—è—Ç—å self.size = 0 # —Ä–∞–∑–º–µ—Ä –ø–∞–º—è—Ç–∏ self.b = 0 # –Ω–∞—á–∞–ª–æ –¥–µ–∫–∞ self.e = 0 # –∫–æ–Ω–µ—Ü –¥–µ–∫–∞ (—ç–ª–µ–º–µ–Ω—Ç—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [b, e)) def getSize(self): # —É–∑–Ω–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –¥–µ–∫–µ if self.b \u003c self.e: return self.e - self.b else: return self.e - self.b + self.size def pushBack(self, x): # –≤—Å—Ç–∞–≤–∏—Ç—å x –≤ –∫–æ–Ω–µ—Ü –¥–µ–∫–∞ if self.getSize() == self.size: self._resize() self.a[self.e] = x self.e = (self.e + 1) % self.size def popBack(self): # —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –∫–æ–Ω—Ü–∞ –¥–µ–∫–∞ self.e = (self.e - 1 + self.size) % self.size def pushFront(self, x): # –≤—Å—Ç–∞–≤–∏—Ç—å x –≤ –Ω–∞—á–∞–ª–æ –¥–µ–∫–∞ if self.getSize() == self.size: self._resize() self.b = (self.b - 1 + self.size) % self.size self.a[self.b] = x def popFront(self): # —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –Ω–∞—á–∞–ª–∞ –¥–µ–∫–∞ self.b = (self.b + 1) % self.size def _resize(self): # –≤—ã–¥–µ–ª—è–µ–º –≤–¥–≤–æ–µ –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏ new_size = max(1, self.size * 2) new_a = [None] * new_size # –ö–æ–ø–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –Ω–æ–≤—ã–π –º–∞—Å—Å–∏–≤ if self.b \u003c self.e: # –ü—Ä–æ—Å—Ç–æ–π —Å–ª—É—á–∞–π: —ç–ª–µ–º–µ–Ω—Ç—ã –∏–¥—É—Ç –ø–æ–¥—Ä—è–¥ new_a[:self.e - self.b] = self.a[self.b:self.e] else: # –°–ª–æ–∂–Ω—ã–π —Å–ª—É—á–∞–π: —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–∞–∑–±–∏—Ç—ã –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏ # –ö–æ–ø–∏—Ä—É–µ–º –æ—Ç b –¥–æ –∫–æ–Ω—Ü–∞ end_idx = self.size - self.b new_a[:end_idx] = self.a[self.b:] # –ö–æ–ø–∏—Ä—É–µ–º –æ—Ç –Ω–∞—á–∞–ª–∞ –¥–æ e new_a[end_idx:end_idx + self.e] = self.a[:self.e] self.a = new_a self.b = 0 self.e = self.size self.size = new_size 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 int *a; // –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –ø–∞–º—è—Ç—å int size; // —Ä–∞–∑–º–µ—Ä –ø–∞–º—è—Ç–∏ int b, e; // –¥–µ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —è—á–µ–π–∫–∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [b,e), –∏–ª–∏, // –µ—Å–ª–∏ b \u003e= e, –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–∞—Ö [b,size) –∏ [0,e) int getSize() { // —É–∑–Ω–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –¥–µ–∫–µ if (b \u003c e) { return e - b; } else { return e - b + size; } } void pushBack(int x) { // –≤—Å—Ç–∞–≤–∏—Ç—å x –≤ –∫–æ–Ω–µ—Ü –¥–µ–∫–∞ if (getSize() == size) { ... // –≤—ã–¥–µ–ª—è–µ–º –≤–¥–≤–æ–µ –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏ } a[e] = x; e = (e + 1) % size; } void popBack() { // —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –∫–æ–Ω—Ü–∞ –¥–µ–∫–∞ e = (e - 1 + size) % size; } void pushFront(int x) { // –≤—Å—Ç–∞–≤–∏—Ç—å x –≤ –Ω–∞—á–∞–ª–æ –¥–µ–∫–∞ if (getSize() == size) { ... // –≤—ã–¥–µ–ª—è–µ–º –≤–¥–≤–æ–µ –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏ } a[b] = x; b = (b - 1 + size) % size; } void popFront() { // —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –Ω–∞—á–∞–ª–∞ –¥–µ–∫–∞ b = (b + 1) % size; } –í C++ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —ç—Ç–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä - std::stack, std::queue, std::deque.",
    "description": "–ú–∞—Å—Å–∏–≤ –ú–∞—Å—Å–∏–≤ (array) - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è —Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞–±–æ—Ä –∑–Ω–∞—á–µ–Ω–∏–π –≤ —è—á–µ–π–∫–∞—Ö, –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–∞–º–∏ (–∏–ª–∏ –Ω–∞–±–æ—Ä–æ–º –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ —Å–ª—É—á–∞–µ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞) –∏–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –æ—Ç—Ä–µ–∑–∫–∞ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª. –í—Å—Ç—Ä–æ–µ–Ω –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —è–∑—ã–∫–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.\n–ú–∞—Å—Å–∏–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–µ $(O(1))$ –≤—Ä–µ–º—è –ø–æ–ª—É—á–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ —ç–ª–µ–º–µ–Ω—Ç—É –ø–æ –∏–Ω–¥–µ–∫—Å—É, –∞ —Ç–∞–∫–∂–µ –∏–∑–º–µ–Ω—è—Ç—å —ç—Ç–æ—Ç —ç–ª–µ–º–µ–Ω—Ç. –ü—Ä–∏ —ç—Ç–æ–º –º–∞—Å—Å–∏–≤ –∏–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä, –ø–æ—ç—Ç–æ–º—É –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π –≤—Å—Ç–∞–≤–∫–∏ –∏ —É–¥–∞–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –ï—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –≤—Å—Ç–∞–≤–∏—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –º–∞—Å—Å–∏–≤ –Ω—É–∂–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –Ω–µ–≥–æ, –Ω–æ —ç—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç $\\Theta(n)$ –æ–ø–µ—Ä–∞—Ü–∏–π, –≥–¥–µ $n$ - –¥–ª–∏–Ω–∞ –º–∞—Å—Å–∏–≤–∞.",
    "tags": [],
    "title": "4. –ë–∞–∑–æ–≤—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö",
    "uri": "/basics/basic_data_structures/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.¬†\u003e¬†17. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ",
    "content": "–î–∞–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á–∏—Å–µ–ª $a_{1}, \\ldots, a_{n}$. –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–π—Ç–∏ –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â—É—é –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—Ç–∞–∫—É—é, —á—Ç–æ –∫–∞–∂–¥–æ–µ —Å–ª–µ–¥—É—é—â–µ–µ —á–∏—Å–ª–æ –≤ –Ω–µ–π —Å—Ç—Ä–æ–≥–æ –±–æ–ª—å—à–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ) –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ–π –¥–ª–∏–Ω—ã - –Ω–∞–∏–±–æ–ª—å—à—É—é –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â—É—é –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–ù–í–ü, longest increasing subsequence).\n–†–µ—à–µ–Ω–∏–µ –∑–∞ $O\\left(n^{2}\\right)$ –ü—É—Å—Ç—å $l_{i}$ - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–∞—è –¥–ª–∏–Ω–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–π –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–µ–π—Å—è –≤ $a_{i}$. –¢–æ–≥–¥–∞\n$$ l_{i}=1+\\max _{\\substack{0 \\leqslant j \u003c i, a_{j} \u003c a_{i}}} l_{j} $$(–º–∞–∫—Å–∏–º—É–º –ø–æ –ø—É—Å—Ç–æ–º—É –º–Ω–æ–∂–µ—Å—Ç–≤—É —Å—á–∏—Ç–∞–µ–º —Ä–∞–≤–Ω—ã–º –Ω—É–ª—é). –û—Ç–≤–µ—Ç –Ω–∞ –∑–∞–¥–∞—á—É - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ $l_{i}$ –ø–æ –≤—Å–µ–º $i$. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –¥–µ–ª–∞–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏. –ü–æ–ª—É—á–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O\\left(n^{2}\\right)$.\nfill(l, 1) for i = 1..(n - 1): for j = 0..(i - 1): if a[j] \u003c a[i]: l[i] = max(l[i], l[j] + 1) –†–µ—à–µ–Ω–∏–µ –∑–∞ $O(n \\log n)$ –ë—É–¥–µ–º –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –º–∞—Å—Å–∏–≤: –ø—É—Å—Ç—å\n$$ x[i, k]=\\min _{\\substack{j \u003c i, l_{j}=k}} a_{j} $$(–∑–¥–µ—Å—å –º–∏–Ω–∏–º—É–º –ø–æ –ø—É—Å—Ç–æ–º—É –º–Ω–æ–∂–µ—Å—Ç–≤—É - –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å). –¢–æ–≥–¥–∞\n$$ l_{i}=1+\\max _{k: x[i, k] \u003c a_{i}} k . $$–ö–∞–∫ —ç—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞—á—É –±—ã—Å—Ç—Ä–µ–µ? –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç—ã –æ–¥–Ω–æ–º–µ—Ä–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ $x[i]$ –∏–¥—É—Ç –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è: –¥–ª—è –ª—é–±–æ–≥–æ $k\u003e1$ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è $x[i, k-1] \u003c x[i, k]$ (–µ—Å–ª–∏, –∫–æ–Ω–µ—á–Ω–æ, –æ–±–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–µ —Ä–∞–≤–Ω—ã –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏). –ü–æ—á–µ–º—É —ç—Ç–æ —Ç–∞–∫? –ï—Å–ª–∏ $x[i, k] \\neq \\infty$, —Ç–æ $x[i, k]=a_{j}$ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ $j$ —Ç–∞–∫–æ–≥–æ, —á—Ç–æ $l_{j}=k$. –°—É—â–µ—Å—Ç–≤—É–µ—Ç $q \u003c j: l_{q}=l_{j}-1=k-1$, $a_{q} \u003c a_{j}$. –¢–æ–≥–¥–∞ $x[i, k-1] \\leqslant a_{q} \u003c a_{j}=x[i, k]$.\n–ü–æ—Å–∫–æ–ª—å–∫—É —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Å—Å–∏–≤–∞ $x[i]$ –∏–¥—É—Ç –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è, $l_{i}$ —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –¥–≤–æ–∏—á–Ω—ã–º –ø–æ–∏—Å–∫–æ–º –ø–æ –º–∞—Å—Å–∏–≤—É $x[i]$ –∑–∞ $O(\\log n)$. –ü–æ—Å–ª–µ–¥–Ω–µ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ: –º–∞—Å—Å–∏–≤—ã $x[i+1]$ –∏ $x[i]$ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –Ω–µ –±–æ–ª–µ–µ, —á–µ–º –≤ –æ–¥–Ω–æ–π —è—á–µ–π–∫–µ: $x\\left[i+1, l_{i}\\right]=a_{i} \\leqslant x\\left[i, l_{i}\\right]$. –í –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∏–∑ –º–∞—Å—Å–∏–≤–æ–≤ $x[i]$, –ø–æ—ç—Ç–æ–º—É –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ –≤–º–µ—Å—Ç–æ –¥–≤—É–º–µ—Ä–Ω–æ–≥–æ; –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ —É –Ω–µ–≥–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–π —è—á–µ–π–∫–∏.\n1 2 3 4 5 6 fill(l, 1) fill(x, inf) x[1] = a[0] for i = 1..(n - 1): l[i] = lower_bound(x + 1, x + n, a[i]) - x x[l[i]] = a[i] –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ç–≤–µ—Ç, –≤–º–µ—Å—Ç–µ —Å –º–∞—Å—Å–∏–≤–æ–º $x$ –±—É–¥–µ–º –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ —Å–ø–∏—Å–∫–æ–≤ pos: –≤–Ω–∞—á–∞–ª–µ –≤—Å–µ —Å–ø–∏—Å–∫–∏ –ø—É—Å—Ç—ã–µ; –≤ –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –º—ã –¥–µ–ª–∞–µ–º –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ $x\\left[l_{i}\\right]=a_{i}$, –¥–æ–ø–∏—à–µ–º $i$ –≤ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞ $\\operatorname{pos}\\left[l_{i}\\right]$. –¢–µ–ø–µ—Ä—å –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –≤ –ù–í–ü, –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–µ–π—Å—è –≤ $i$-–π –ø–æ–∑–∏—Ü–∏–∏, –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ $\\operatorname{pos}\\left[l_{i}\\right]$, –º–µ–Ω—å—à–∏–π $i$. –ü–æ—Å–∫–æ–ª—å–∫—É —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Å–ø–∏—Å–∫–æ–≤ pos –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç $n$, —ç—Ç–æ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–º –ø—Ä–æ—Ö–æ–¥–æ–º –ø–æ —Å–ø–∏—Å–∫—É.",
    "description": "–î–∞–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á–∏—Å–µ–ª $a_{1}, \\ldots, a_{n}$. –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–π—Ç–∏ –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â—É—é –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—Ç–∞–∫—É—é, —á—Ç–æ –∫–∞–∂–¥–æ–µ —Å–ª–µ–¥—É—é—â–µ–µ —á–∏—Å–ª–æ –≤ –Ω–µ–π —Å—Ç—Ä–æ–≥–æ –±–æ–ª—å—à–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ) –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ–π –¥–ª–∏–Ω—ã - –Ω–∞–∏–±–æ–ª—å—à—É—é –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â—É—é –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–ù–í–ü, longest increasing subsequence).\n–†–µ—à–µ–Ω–∏–µ –∑–∞ $O\\left(n^{2}\\right)$ –ü—É—Å—Ç—å $l_{i}$ - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–∞—è –¥–ª–∏–Ω–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–π –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–µ–π—Å—è –≤ $a_{i}$. –¢–æ–≥–¥–∞\n$$ l_{i}=1+\\max _{\\substack{0 \\leqslant j \u003c i, a_{j} \u003c a_{i}}} l_{j} $$(–º–∞–∫—Å–∏–º—É–º –ø–æ –ø—É—Å—Ç–æ–º—É –º–Ω–æ–∂–µ—Å—Ç–≤—É —Å—á–∏—Ç–∞–µ–º —Ä–∞–≤–Ω—ã–º –Ω—É–ª—é). –û—Ç–≤–µ—Ç –Ω–∞ –∑–∞–¥–∞—á—É - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ $l_{i}$ –ø–æ –≤—Å–µ–º $i$. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –¥–µ–ª–∞–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏. –ü–æ–ª—É—á–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O\\left(n^{2}\\right)$.",
    "tags": [],
    "title": "–ù–∞–∏–±–æ–ª—å—à–∞—è –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–∞—è –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å",
    "uri": "/basics/dynamic_programming/longest_increasing_subsequence/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.",
    "content": "–î–≤–æ–∏—á–Ω—ã–π –ø–æ–∏—Å–∫ –ï—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Å—Å–∏–≤–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ (—Ç–æ –µ—Å—Ç—å –º–∞—Å—Å–∏–≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω), —Ç–æ –∏—Å–∫–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ –º–∞—Å—Å–∏–≤–µ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –∑–∞ –ª–∏–Ω–µ–π–Ω–æ–µ –≤—Ä–µ–º—è.\n–ü—É—Å—Ç—å –º—ã —Ö–æ—Ç–∏–º –Ω–∞–π—Ç–∏ $x$ –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –º–∞—Å—Å–∏–≤–µ $a$ –¥–ª–∏–Ω—ã $n$. –°–Ω–æ–≤–∞ –ø—Ä–∏–º–µ–Ω–∏–º –∏–¥–µ—é –º–µ—Ç–æ–¥–∞ ‚Äú—Ä–∞–∑–¥–µ–ª—è–π –∏ –≤–ª–∞—Å—Ç–≤—É–π‚Äù: –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –º–∞—Å—Å–∏–≤–∞ - $a\\left[\\frac{n}{2}\\right]$. –ï—Å–ª–∏ $a\\left[\\frac{n}{2}\\right]=x$, —Ç–æ –º—ã –Ω–∞—à–ª–∏ $x$ –≤ –º–∞—Å—Å–∏–≤–µ $a$. –ï—Å–ª–∏ $a\\left[\\frac{n}{2}\\right]\u003ex$, —Ç–æ $x$ –º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏—Å—å —Ç–æ–ª—å–∫–æ –≤ $a\\left[0,1, \\ldots, \\frac{n}{2}-1\\right]$. –ï—Å–ª–∏ –∂–µ $a\\left[\\frac{n}{2}\\right] \u003c x$, —Ç–æ $x$ –º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏—Å—å —Ç–æ–ª—å–∫–æ –≤ $a\\left[\\frac{n}{2}+1, \\ldots, n-1\\right]$. –í –ª—é–±–æ–º –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–≤—É—Ö —Å–ª—É—á–∞–µ–≤, –º—ã –≤–¥–≤–æ–µ —É–º–µ–Ω—å—à–∏–ª–∏ –¥–ª–∏–Ω—É –æ—Ç—Ä–µ–∑–∫–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –Ω—É–∂–Ω–æ –∏—Å–∫–∞—Ç—å $x$.\n–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç–µ –∂–µ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Å–µ—Ä–µ–¥–∏–Ω—É –Ω–æ–≤–æ–≥–æ –ø–æ–¥–æ–æ—Ç—Ä–µ–∑–∫–∞ –º–∞—Å—Å–∏–≤–∞, –∏ –ª–∏–±–æ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –Ω–∞–π–¥—ë—Ç—Å—è $x$, –ª–∏–±–æ –º—ã –ø–æ–π–º—ë–º, –≤ –∫–∞–∫–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –Ω–æ–≤–æ–≥–æ –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞ –Ω—É–∂–Ω–æ –µ–≥–æ –∏—Å–∫–∞—Ç—å. –ë—É–¥–µ–º –ø–æ–≤—Ç–æ—Ä—è—Ç—å —ç—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è, –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥—ë–º $x$, –ª–∏–±–æ –Ω–µ –¥–æ–π–¥—ë–º –¥–æ –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞ –Ω—É–ª–µ–≤–æ–π –¥–ª–∏–Ω—ã. –ü–æ—Å–∫–æ–ª—å–∫—É –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –¥–ª–∏–Ω–∞ –æ—Ç—Ä–µ–∑–∫–∞ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –≤–¥–≤–æ–µ, —ç—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç —á–µ—Ä–µ–∑ $O(\\log n)$ —à–∞–≥–æ–≤.\n–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –Ω–∞—à–µ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Å –ø–æ–º–æ—â—å—é –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–æ—Ä–µ–º—ã –æ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö: –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≤ —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ (–∫–æ–≥–¥–∞ $x$ —Ç–∞–∫ –∏ –Ω–µ –Ω–∞—à—ë–ª—Å—è, –ª–∏–±–æ –Ω–∞—à—ë–ª—Å—è –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ) —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–º—É —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—é $T(n)=T\\left(\\frac{n}{2}\\right)+\\Theta(1)$. –≠—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç $a=1, b=2, c=0$ –≤ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–µ —Ç–µ–æ—Ä–µ–º—ã. $c=0=\\log _{2} 1=\\log _{b} a$, —Ç–æ–≥–¥–∞ –ø–æ —Ç–µ–æ—Ä–µ–º–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≤ —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ –µ—Å—Ç—å $\\Theta(\\log n)$.\n–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –¥–≤–æ–∏—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞: ‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 def binary_search(a, x): \"\"\" –ò—â–µ—Ç x –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –º–∞—Å—Å–∏–≤–µ a –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω–¥–µ–∫—Å, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –ª–µ–∂–∏—Ç x, –∏–ª–∏ -1, –µ—Å–ª–∏ x –≤ –º–∞—Å—Å–∏–≤–µ –Ω–µ—Ç \"\"\" l = 0 r = len(a) - 1 # –≥—Ä–∞–Ω–∏—Ü—ã –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–≥–æ –Ω–∞—Å –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞ –º–∞—Å—Å–∏–≤–∞ while l \u003c= r: # –ø–æ–∫–∞ –ø–æ–¥–æ—Ç—Ä–µ–∑–æ–∫ –Ω–µ–ø—É—Å—Ç m = (l + r) // 2 # —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ if a[m] == x: return m if a[m] \u003c x: l = m + 1 else: r = m - 1 return -1 # x —Ç–∞–∫ –∏ –Ω–µ –Ω–∞—à—ë–ª—Å—è 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 int binarySearch(int a[], int n, int x) { int l = 0, r = n - 1; // –≥—Ä–∞–Ω–∏—Ü—ã –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–≥–æ –Ω–∞—Å –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞ –º–∞—Å—Å–∏–≤–∞ while (l \u003c= r) { // –ø–æ–∫–∞ –ø–æ–¥–æ—Ç—Ä–µ–∑–æ–∫ –Ω–µ–ø—É—Å—Ç int m = l + (r - l) / 2; // –∏–∑–±–µ–≥–∞–µ–º –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è if (a[m] == x) { return m; // –Ω–∞—à–ª–∏ —ç–ª–µ–º–µ–Ω—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∏–Ω–¥–µ–∫—Å } if (a[m] \u003c x) { l = m + 1; // –∏—â–µ–º –≤ –ø—Ä–∞–≤–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ } else { r = m - 1; // –∏—â–µ–º –≤ –ª–µ–≤–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ } } return -1; // x —Ç–∞–∫ –∏ –Ω–µ –Ω–∞—à—ë–ª—Å—è } –õ–µ–≤–æ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ –í–æ–∑–º–æ–∂–Ω–æ, $x$ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ (—Ç–∞–∫ –∫–∞–∫ –º–∞—Å—Å–∏–≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω, —ç—Ç–∏ –≤—Ö–æ–∂–¥–µ–Ω–∏—è –æ–±—Ä–∞–∑—É—é—Ç –ø–æ–¥–æ—Ç—Ä–µ–∑–æ–∫ –º–∞—Å—Å–∏–≤–∞). –ù–∞—É—á–∏–º—Å—è –Ω–∞—Ö–æ–¥–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–π $x$ –≤ –º–∞—Å—Å–∏–≤ (—Ç–æ –µ—Å—Ç—å –¥–ª–∏–Ω—É —ç—Ç–æ–≥–æ –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞).\n–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞–π—Ç–∏ –∏–Ω–¥–µ–∫—Å—ã —Å–∞–º–æ–≥–æ –ª–µ–≤–æ–≥–æ –∏ —Å–∞–º–æ–≥–æ –ø—Ä–∞–≤–æ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–π $x$ –≤ –º–∞—Å—Å–∏–≤, —Ç–æ–≥–¥–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–π - —ç—Ç–æ —Ä–∞–∑–Ω–æ—Å—Ç—å —ç—Ç–∏—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –ø–ª—é—Å –æ–¥–∏–Ω. –ù–∞—á–Ω—ë–º —Å –ª–µ–≤–æ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏—è.\n–ë—É–¥–µ–º —Å–Ω–æ–≤–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã $l$ –∏ $r$, –Ω–æ —É–∂–µ —Å–æ —Å–ª–µ–¥—É—é—â–∏–º —É—Å–ª–æ–≤–∏–µ–º: –ø—É—Å—Ç—å –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è $a[l]\u003c x$ –∏ $a[r] \\geqslant x$. –£–¥–æ–±–Ω–æ –º—ã—Å–ª–µ–Ω–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫ –º–∞—Å—Å–∏–≤—É —Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã $a[-1]=-\\infty$ –∏ $a[n]=\\infty$, —Ç–æ–≥–¥–∞ –Ω–µ –Ω—É–∂–Ω–æ –æ—Ç–¥–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–µ–Ω—å—à–µ $x$, –∏–ª–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω—ã $x$.\n–°–∞–º –∞–ª–≥–æ—Ä–∏—Ç–º —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–æ—â–µ: —Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Å–µ—Ä–µ–¥–∏–Ω—É –æ—Ç—Ä–µ–∑–∫–∞ $(l, r)$, –∏, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ –º–∞—Å—Å–∏–≤–∞ —Å —ç—Ç–∏–º –∏–Ω–¥–µ–∫—Å–æ–º, —Å–¥–≤–∏–≥–∞–µ–º $l$ –∏–ª–∏ $r$ —Ç–∞–∫, —á—Ç–æ–±—ã —Ç—Ä–µ–±—É–µ–º—ã–µ –æ—Ç –Ω–∏—Ö —É—Å–ª–æ–≤–∏—è –Ω–µ –Ω–∞—Ä—É—à–∏–ª–∏—Å—å. –ö–æ–≥–¥–∞ $l$ –∏ $r$ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ —Å–æ—Å–µ–¥–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã (—Ç–æ –µ—Å—Ç—å $l=r-1$ ), –≤—Å—ë –µ—â—ë –≤–µ—Ä–Ω–æ, —á—Ç–æ $a[l] \u003c x, a[r] \\geqslant x$. –¢–æ–≥–¥–∞ –µ—Å–ª–∏ $a[r]=x$, —Ç–æ $r$ –∏–Ω–¥–µ–∫—Å –ª–µ–≤–æ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏—è $x$, –∏–Ω–∞—á–µ $x$ –≤ –º–∞—Å—Å–∏–≤–µ –Ω–µ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è.\n–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: ‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 def lowerBound(a, x): \"\"\" –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ i —Ç–∞–∫–æ–µ, —á—Ç–æ a[i] \u003e= x \"\"\" l = -1 r = len(a) # l –∏ r –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ —Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã while r - l \u003e 1: m = (l + r) // 2 if a[m] \u003c x: l = m # —É—Å–ª–æ–≤–∏–µ –Ω–∞ l –Ω–µ –Ω–∞—Ä—É—à–∏–ª–æ—Å—å else: r = m # —É—Å–ª–æ–≤–∏–µ –Ω–∞ r –Ω–µ –Ω–∞—Ä—É—à–∏–ª–æ—Å—å return r def getLeftEntry(a, x): \"\"\" –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–º–µ—Ä –ª–µ–≤–æ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏—è –∏–ª–∏ -1 \"\"\" i = lowerBound(a, x) if i == len(a) or a[i] != x: return -1 return i 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 #include \u003cvector\u003e int lowerBound(const std::vector\u003cint\u003e\u0026 a, int x) { // –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ i —Ç–∞–∫–æ–µ, —á—Ç–æ a[i] \u003e= x int l = -1; int r = a.size(); // l –∏ r –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ —Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã while (r - l \u003e 1) { int m = (l + r) / 2; if (a[m] \u003c x) { l = m; // —É—Å–ª–æ–≤–∏–µ –Ω–∞ l –Ω–µ –Ω–∞—Ä—É—à–∏–ª–æ—Å—å } else { r = m; // —É—Å–ª–æ–≤–∏–µ –Ω–∞ r –Ω–µ –Ω–∞—Ä—É—à–∏–ª–æ—Å—å } } return r; } int getLeftEntry(const std::vector\u003cint\u003e\u0026 a, int x) { // –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–º–µ—Ä –ª–µ–≤–æ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏—è –∏–ª–∏ -1 int i = lowerBound(a, x); if (i == a.size() || a[i] != x) { return -1; } return i; } –ü—Ä–∞–≤–æ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ –∏—â–µ—Ç—Å—è –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫ –∂–µ: –Ω—É–∂–Ω–æ —Ç—Ä–µ–±–æ–≤–∞—Ç—å –æ—Ç –≥—Ä–∞–Ω–∏—Ü –ø–æ–∏—Å–∫–∞ $a[l] \\leqslant x$ –∏ $a[r]\u003ex$, —Ç–æ–≥–¥–∞ –≤ –∫–æ–Ω—Ü–µ $l$ - –ø—Ä–∞–≤–æ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ $a[l]=x$, –∏–Ω–∞—á–µ $x$ –≤ –º–∞—Å—Å–∏–≤–µ –Ω–µ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∞–º–æ–≥–æ –ø–æ–∏—Å–∫–∞ –Ω—É–∂–Ω–æ –ø–æ–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ–≥–æ –æ–¥–Ω—É —Å—Ç—Ä–æ—á–∫—É: a [m] \u003c x –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ $\\mathrm{a}[\\mathrm{m}]$ \u003c= x .\n–í C++ –µ—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ std::lower_bound –∏ std::upper_bound. –ü–µ—Ä–≤–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Ç–µ—Ä–∞—Ç–æ—Ä, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –Ω–∞ –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç, –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω—ã–π $x$, –≤—Ç–æ—Ä–∞—è –Ω–∞ –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç, —Å—Ç—Ä–æ–≥–æ –±–æ–ª—å—à–∏–π $x$. –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:\n‚Äã cpp 1 2 3 4 5 6 7 8 // –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ i —Ç–∞–∫–æ–µ, —á—Ç–æ a[i] \u003e= x; n, –µ—Å–ª–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∞ –º–µ–Ω—å—à–µ —Ö i = lower_bound(a, a + n, x) - a; // –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ i —Ç–∞–∫–æ–µ, —á—Ç–æ a[i] \u003e x; n, –µ—Å–ª–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∞ –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω—ã —Ö i = upper_bound(a, a + n, x) - a; // –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ i —Ç–∞–∫–æ–µ, —á—Ç–æ a[i] \u003c= x; -1, –µ—Å–ª–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∞ –±–æ–ª—å—à–µ —Ö i = upper_bound(a, a + n, x) - a - 1; // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–π —Ö –≤ –∞ cnt = upper_bound(a, a + n, x) - lower_bound(a, a + n, x); –î–≤–æ–∏—á–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ —Ñ—É–Ω–∫—Ü–∏–∏ –ú–æ–∂–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏ –µ—â—ë –±–æ–ª–µ–µ –æ–±—â—É—é –≤–µ—Ä—Å–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞. –ü—É—Å—Ç—å –µ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä–∞—è —Ñ—É–Ω–∫—Ü–∏—è $f(i)$ —Ç–∞–∫–∞—è, —á—Ç–æ $f(i)=0$ –¥–ª—è –≤—Å–µ—Ö $i$, –º–µ–Ω—å—à–∏—Ö –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –ø–æ—Ä–æ–≥–∞ $t$, –∏ $f(i)=1$ –¥–ª—è –≤—Å–µ—Ö $i \\geqslant t$. –¢–æ–≥–¥–∞ —ç—Ç–æ—Ç –ø–æ—Ä–æ–≥ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —Å –ø–æ–º–æ—â—å—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –¥–≤–æ–∏—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞.\n–ò–¥–µ—è —Ç–∞ –∂–µ, —á—Ç–æ –∏ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –ª–µ–≤–æ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏—è: —Å–Ω–∞—á–∞–ª–∞ –≤–æ–∑—å–º—ë–º —Ç–∞–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã –ø–æ–∏—Å–∫–∞ $l=L, r=R$, —á—Ç–æ $f(L)=0, f(R)=1$. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –±—É–¥–µ–º —Å–¥–≤–∏–≥–∞—Ç—å –æ–¥–Ω—É –∏–∑ –≥—Ä–∞–Ω–∏—Ü $l, r$, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è $f\\left(\\frac{l+r}{2}\\right)$. –í —Ç–æ—Ç –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ $l$ –∏ $r$ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É, $r$ - –∏—Å–∫–æ–º—ã–π –ø–æ—Ä–æ–≥. –ï—Å–ª–∏ —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ç–æ—á–∫–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∑–∞ $O(1)$, —Ç–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ $-O(\\log (R-L))$, –≥–¥–µ $L, R-$ –Ω–∞—á–∞–ª—å–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã –ø–æ–∏—Å–∫–∞.\n–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –ø–æ–∏—Å–∫–∞ –ª–µ–≤–æ–≥–æ –∏ –ø—Ä–∞–≤–æ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏—è —è–≤–ª—è—é—Ç—Å—è —á–∞—Å—Ç–Ω—ã–º–∏ —Å–ª—É—á–∞—è–º–∏ —ç—Ç–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞: –≤ —Å–ª—É—á–∞–µ –ª–µ–≤–æ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏—è –º–æ–∂–Ω–æ –≤–∑—è—Ç—å —Ñ—É–Ω–∫—Ü–∏—é $f$ —Ç–∞–∫—É—é,\n—á—Ç–æ $f(i)=1$ —Ç–æ–≥–¥–∞ –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ $a[i] \\geqslant x$; –≤ —Å–ª—É—á–∞–µ –ø—Ä–∞–≤–æ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏—è $-f(i)=1$ —Ç–æ–≥–¥–∞ –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ $a[i]\u003ex$ (–∏ –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ $i$ —Ç–∞–∫–æ–µ, —á—Ç–æ $f(i)=0$, —Ç–æ –µ—Å—Ç—å –≤ –∫–æ–Ω—Ü–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å $l$, –∞ –Ω–µ $r$ ).\n–î–≤–æ–∏—á–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –î–≤–æ–∏—á–Ω—ã–π –ø–æ–∏—Å–∫ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –∏ –ø–æ —Ñ—É–Ω–∫—Ü–∏–∏, –ø—Ä–∏–Ω–∏–º–∞—é—â–µ–π –∑–Ω–∞—á–µ–Ω–∏—è –≤–æ –≤—Å–µ—Ö –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç–æ—á–∫–∞—Ö, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –≤ —Ü–µ–ª—ã—Ö. –†–µ—à–∏–º –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞ —Ç–∞–∫—É—é –∑–∞–¥–∞—á—É: –¥–∞–Ω–∞ –º–æ–Ω–æ—Ç–æ–Ω–Ω–æ –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–∞—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è $f: \\mathbb{R} \\rightarrow \\mathbb{R}$, –∏ —Ç–æ—á–∫–∏ $L, R$ —Ç–∞–∫–∏–µ, —á—Ç–æ $f(L)\u003c0$, $f(R) \\geqslant 0$. –ù–∞–π–¥—ë–º —Ç–æ—á–∫—É $x$ —Ç–∞–∫—É—é, —á—Ç–æ $f(x)=0$. (R)\n‚úçÔ∏è –ï—Å–ª–∏ —Ç–∞–∫–∏–µ $L, R$ –Ω–µ –¥–∞–Ω—ã, –Ω–æ –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –æ–Ω–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç, —Ç–æ –∏—Ö –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞: –Ω–∞—á–Ω—ë–º —Å $R=1$ –∏ –±—É–¥–µ–º —É–¥–≤–∞–∏–≤–∞—Ç—å $R$, –ø–æ–∫–∞ $f(R)\u003c0$. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –Ω–∞—á–Ω—ë–º —Å $L=-1$ –∏ –±—É–¥–µ–º —É–¥–≤–∞–∏–≤–∞—Ç—å $L$, –ø–æ–∫–∞ $f(L) \\geqslant 0$. –ü—Ä–∏ —ç—Ç–æ–º –º—ã –∑–∞—Ç—Ä–∞—Ç–∏–º $O\\left(\\log \\left|R^{\\prime}\\right|+\\log \\left|L^{\\prime}\\right|\\right)$ –¥–µ–π—Å—Ç–≤–∏–π, –≥–¥–µ $R^{\\prime} \\geqslant 0, L^{\\prime} \\leqslant 0-$ –ª—é–±—ã–µ —Ç–∞–∫–∏–µ, —á—Ç–æ $f\\left(L^{\\prime}\\right)\u003c0, f\\left(R^{\\prime}\\right) \\geqslant 0$.\n–ü–æ—Å–∫–æ–ª—å–∫—É $f$ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –º—ã –Ω–µ –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ–º –Ω–∞–π—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–∞–∫–æ–≥–æ $x$ –∞–±—Å–æ–ª—é—Ç–Ω–æ —Ç–æ—á–Ω–æ. –¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, –º—ã –º–æ–∂–µ–º –Ω–∞–π—Ç–∏ —Ç–∞–∫–æ–µ $x$ —Å –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å—é $\\varepsilon$ : –Ω–∞–π–¥—ë–º —Ç–∞–∫–æ–µ $x$, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç $x^{\\prime}$ —Ç–∞–∫–æ–µ, —á—Ç–æ $f\\left(x^{\\prime}\\right)=0,\\left|x-x^{\\prime}\\right|\u003c\\varepsilon$.\n–ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è: –Ω–∞—á–∏–Ω–∞–µ–º —Å –≥—Ä–∞–Ω–∏—Ü $l=L, r=R$, –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ —Å–¥–≤–∏–≥–∞–µ–º –æ–¥–Ω—É –∏–∑ –≥—Ä–∞–Ω–∏—Ü –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è $f\\left(\\frac{l+r}{2}\\right)$. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ: –º—ã –∑–∞–≤–µ—Ä—à–∞–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º –≤ —Ç–æ—Ç –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ $r-l\u003c\\varepsilon$. –ü–æ—Å–∫–æ–ª—å–∫—É –≤ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –≤—Å—ë –µ—â—ë $f(l)\u003c0, f(r) \\geqslant 0$, –∞ —Ñ—É–Ω–∫—Ü–∏—è $f$ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞, –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ $[l, r]$ –Ω–∞–π–¥—ë—Ç—Å—è $x^{\\prime}$ —Ç–∞–∫–æ–µ, —á—Ç–æ $f\\left(x^{\\prime}\\right)=0$. –ü–æ—Å–∫–æ–ª—å–∫—É –¥–ª–∏–Ω–∞ –æ—Ç—Ä–µ–∑–∫–∞ –º–µ–Ω—å—à–µ $\\varepsilon$, –ª—é–±–∞—è –∏–∑ –≥—Ä–∞–Ω–∏—Ü $l, r$ –ø–æ–¥–æ–π–¥—ë—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–≤–µ—Ç–∞. –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ (–ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ $f$ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∑–∞ $O(1)$ ) $O\\left(\\log \\left(\\frac{R-L}{\\varepsilon}\\right)\\right)$.\n–ï—Å–ª–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ–≤–æ–¥—è—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–∑–Ω–∞—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, double –≤ C++), —Ç–æ –∏–∑-–∑–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –ø–µ—Ä–µ—Å—á—ë—Ç–µ –≥—Ä–∞–Ω–∏—Ü —É—Å–ª–æ–≤–∏–µ $r-l\u003c\\varepsilon$ –º–æ–∂–µ—Ç –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è. –ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —ç—Ç–æ–≥–æ, –≤–º–µ—Å—Ç–æ while –Ω–∞–ø–∏—à–µ–º —Ü–∏–∫–ª, –¥–µ–ª–∞—é—â–∏–π —Å—Ç–æ–ª—å–∫–æ –∏—Ç–µ—Ä–∞—Ü–∏–π, —Å–∫–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã —É—Å–ª–æ–≤–∏–µ —Ç–æ—á–Ω–æ –≤—ã–ø–æ–ª–Ω–∏–ª–æ—Å—å. –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: ‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 def findRoot(L, R, eps): l, r = L, R k = int((r - l) / eps).bit_length() # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ eps for i in range(k): m = (l + r) / 2 if f(m) \u003c 0: l = m else: r = m return r 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 #include \u003ccmath\u003e double findRoot(double L, double R, double eps) { double l = L, r = R; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ eps int k = static_cast\u003cint\u003e(log2((r - l) / eps)) + 1; for (int i = 0; i \u003c k; i++) { double m = (l + r) / 2; if (f(m) \u003c 0) { l = m; } else { r = m; } } return r; } –ú–µ—Ç–æ–¥ –¥–≤—É—Ö —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –ò–Ω–æ–≥–¥–∞ –º–Ω–æ–≥–æ –¥–≤–æ–∏—á–Ω—ã—Ö –ø–æ–∏—Å–∫–æ–≤ –Ω–∞ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ —Å–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º–æ–≥–æ –º–µ—Ç–æ–¥–∞ –¥–≤—É—Ö —É–∫–∞–∑–∞—Ç–µ–ª–µ–π. –°–¥–µ–ª–∞–µ–º —ç—Ç–æ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–∏: –¥–∞–Ω –º–∞—Å—Å–∏–≤ $a$ –¥–ª–∏–Ω—ã $n$, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª. –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø–æ –¥–ª–∏–Ω–µ –ø–æ–¥–æ—Ç—Ä–µ–∑–æ–∫ –º–∞—Å—Å–∏–≤–∞, —Å—É–º–º–∞ –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –Ω–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç $M$.\n–£–¥–æ–±–Ω–µ–µ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ —Å –æ—Ç—Ä–µ–∑–∫–∞–º–∏, –∞ —Å –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏: –ø–∞—Ä–µ $l, r$ –±—É–¥–µ–º —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—Ç—å –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª $a[l, r)$, —Ç–æ –µ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Å—Å–∏–≤–∞ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ $l, l+1, \\ldots, r-1$ (—ç—Ç–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤—Å–µ–≥–¥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–∏—Å–∞—Ç—å –º–µ–Ω—å—à–µ –ø–ª—é—Å-–º–∏–Ω—É—Å –µ–¥–∏–Ω–∏—Ü –≤ –∏–Ω–¥–µ–∫—Å–∞—Ö –º–∞—Å—Å–∏–≤–æ–≤, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –∫–æ—Ä–æ—á–µ). –°–∞–º–æ–µ –ø—Ä–æ—Å—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ - –ø–µ—Ä–µ–±—Ä–∞—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª—ã: ‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 # –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ a = [...] # –≤–∞—à –º–∞—Å—Å–∏–≤ n = len(a) # –¥–ª–∏–Ω–∞ –º–∞—Å—Å–∏–≤–∞ M = ... # –≤–∞—à–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ maxLen = 0 ansL = 0 ansR = 0 for l in range(n): # –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º –ª–µ–≤—É—é –≥—Ä–∞–Ω–∏—Ü—É sum = 0 # –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å —Å—É–º–º—É –Ω–∞ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª–µ for r in range(l + 1, n + 1): sum += a[r - 1] if sum \u003c= M and r - l \u003e maxLen: maxLen = r - l ansL = l ansR = r print(f\"maxLen = {maxLen}, ansL = {ansL}, ansR = {ansR}\") 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 #include \u003ciostream\u003e #include \u003cvector\u003e int main() { // –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ std::vector\u003cint\u003e a; // –≤–∞—à –º–∞—Å—Å–∏–≤ int n = a.size(); // –¥–ª–∏–Ω–∞ –º–∞—Å—Å–∏–≤–∞ int M; // –≤–∞—à–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ // –ü—Ä–∏–º–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏) // std::cin \u003e\u003e n \u003e\u003e M; // a.resize(n); // for (int i = 0; i \u003c n; i++) std::cin \u003e\u003e a[i]; int maxLen = 0; int ansL = 0; int ansR = 0; for (int l = 0; l \u003c n; l++) { // –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º –ª–µ–≤—É—é –≥—Ä–∞–Ω–∏—Ü—É int sum = 0; // –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å —Å—É–º–º—É –Ω–∞ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª–µ for (int r = l + 1; r \u003c= n; r++) { sum += a[r - 1]; if (sum \u003c= M \u0026\u0026 r - l \u003e maxLen) { maxLen = r - l; ansL = l; ansR = r; } } } std::cout \u003c\u003c \"maxLen = \" \u003c\u003c maxLen \u003c\u003c \", ansL = \" \u003c\u003c ansL \u003c\u003c \", ansR = \" \u003c\u003c ansR \u003c\u003c std::endl; return 0; } –ü–æ–ª—É—á–∏–ª–æ—Å—å —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $\\Theta\\left(n^{2}\\right)$. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –ø—Ä–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ª–µ–≤–æ–π –≥—Ä–∞–Ω–∏—Ü–µ —Å—É–º–º–∞ –Ω–∞ –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª–µ –Ω–µ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –ø—Ä–∞–≤–æ–π –≥—Ä–∞–Ω–∏—Ü—ã. –ó–Ω–∞—á–∏—Ç —Å–∫–æ–ª—å–∫–æ—Ç–æ –ø–µ—Ä–≤—ã—Ö –ø—Ä–∞–≤—ã—Ö –≥—Ä–∞–Ω–∏—Ü –ø–æ–¥–æ–π–¥—É—Ç, –∞ –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —É–∂–µ –Ω–µ –ø–æ–¥–æ–π–¥—É—Ç. –ü—Ä–∏ —ç—Ç–æ–º –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–æ–¥—Ö–æ–¥—è—â–∞—è –ø—Ä–∞–≤–∞—è –≥—Ä–∞–Ω–∏—Ü–∞. –ï—ë –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –¥–≤–æ–∏—á–Ω—ã–º –ø–æ–∏—Å–∫–æ–º, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —Å–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–≤ —Ä–µ—à–µ–Ω–∏–µ –¥–æ $\\Theta(n \\log n)$ :\n‚úçÔ∏è –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å —Å—É–º–º—É –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª–µ, –∑–∞—Ä–∞–Ω–µ–µ –ø—Ä–µ–¥–ø–æ–¥—Å—á–∏—Ç–∞–µ–º –ø—Ä–µ—Ñ–∏–∫—Å–Ω—ã–µ —Å—É–º–º—ã - –º–∞—Å—Å–∏–≤ $p$ —Ç–∞–∫–æ–π, —á—Ç–æ $p[i]=\\sum_{j=0}^{i-1} a_{j}$. –¢–æ–≥–¥–∞ —Å—É–º–º–∞ –Ω–∞ –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª–µ $a[l, r)$ —Ä–∞–≤–Ω–∞ $\\sum_{i=l}^{r-1} a_{i}=p[r]-p[l]$. ‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 a = [...] # –≤–∞—à –º–∞—Å—Å–∏–≤ n = len(a) # –¥–ª–∏–Ω–∞ –º–∞—Å—Å–∏–≤–∞ M = ... # –≤–∞—à–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ maxLen = 0 ansL = 0 ansR = 0 # –ü—Ä–µ–¥–ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–µ—Ñ–∏–∫—Å–Ω—ã–µ —Å—É–º–º—ã p = [0] * (n + 1) for i in range(1, n + 1): p[i] = p[i - 1] + a[i - 1] for l in range(n): sl = l sr = n + 1 # –≥—Ä–∞–Ω–∏—Ü—ã –ø–æ–∏—Å–∫–∞, sum a[l..sl) \u003c= M, sum a[l..sr) \u003e M while sr - sl \u003e 1: sm = (sl + sr) // 2 if p[sm] - p[l] \u003c= M: sl = sm else: sr = sm if sl - l \u003e maxLen: # sl - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–æ–¥—Ö–æ–¥—è—â–∞—è –ø—Ä–∞–≤–∞—è –≥—Ä–∞–Ω–∏—Ü–∞ maxLen = sl - l ansL = l ansR = sl # –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ–¥–º–∞—Å—Å–∏–≤ a[ansL:ansR] –∏–º–µ–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É —Å —Å—É–º–º–æ–π \u003c= M 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 #include \u003cvector\u003e // –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ int n; // —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ std::vector\u003cint\u003e a(n); // –∏—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤ int M; // –≤–∞—à–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ int maxLen = 0, ansL = 0, ansR = 0; // –ü—Ä–µ–¥–ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–µ—Ñ–∏–∫—Å–Ω—ã–µ —Å—É–º–º—ã std::vector\u003cint\u003e p(n + 1); p[0] = 0; for (int i = 1; i \u003c= n; i++) { p[i] = p[i - 1] + a[i - 1]; } for (int l = 0; l \u003c n; l++) { int sl = l; int sr = n + 1; // –≥—Ä–∞–Ω–∏—Ü—ã –ø–æ–∏—Å–∫–∞, sum a[l..sl) \u003c= M, sum a[l..sr) \u003e M while (sr - sl \u003e 1) { int sm = (sl + sr) / 2; if (p[sm] - p[l] \u003c= M) { sl = sm; } else { sr = sm; } } if (sl - l \u003e maxLen) { // sl - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–æ–¥—Ö–æ–¥—è—â–∞—è –ø—Ä–∞–≤–∞—è –≥—Ä–∞–Ω–∏—Ü–∞ maxLen = sl - l; ansL = l; ansR = sl; } } // –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ–¥–º–∞—Å—Å–∏–≤ a[ansL:ansR] –∏–º–µ–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É —Å —Å—É–º–º–æ–π \u003c= M –ü–µ—Ä–µ–π–¥—ë–º —Ç–µ–ø–µ—Ä—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∫ –º–µ—Ç–æ–¥—É –¥–≤—É—Ö —É–∫–∞–∑–∞—Ç–µ–ª–µ–π. –ü—É—Å—Ç—å $r$ - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–æ–¥—Ö–æ–¥—è—â–∞—è –ø—Ä–∞–≤–∞—è –≥—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –ª–µ–≤–æ–π –≥—Ä–∞–Ω–∏—Ü—ã $l-1$. –¢–æ–≥–¥–∞ $M \\geqslant \\sum_{i=l-1}^{r-1} a_{i} \\geqslant \\sum_{i=l}^{r-1} a_{i}$, —Ç–æ –µ—Å—Ç—å –≥—Ä–∞–Ω–∏—Ü–∞ $r$ –ø–æ–¥–æ–π–¥—ë—Ç –∏ –¥–ª—è $l$. –ë—É–¥–µ–º –≤–º–µ—Å—Ç–æ –¥–≤–æ–∏—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏—Å–∫–∞—Ç—å –≥—Ä–∞–Ω–∏—Ü—É $r$ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –∏ –≤ —Å–∞–º–æ–π –ø–µ—Ä–≤–æ–π –≤–µ—Ä—Å–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞: –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–±–∏—Ä–∞—è –≤—Å–µ –≥—Ä–∞–Ω–∏—Ü—ã –ø–æ–¥—Ä—è–¥. –ù–æ –Ω–∞—á–Ω—ë–º –ø–µ—Ä–µ–±–æ—Ä –Ω–µ —Å $l+1$, –∞ —Å –ø—Ä–∞–≤–æ–π –≥—Ä–∞–Ω–∏—Ü—ã, –Ω–∞–π–¥–µ–Ω–Ω–æ–π –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ. –ü–æ—Å–∫–æ–ª—å–∫—É —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∞—è –≥—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–ª—å–∫–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –≤ —Ö–æ–¥–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞, —Å—É–º–º–∞—Ä–Ω–æ –∑–∞ –≤—Å—ë –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –æ–Ω–∞ —Å–¥–≤–∏–Ω–µ—Ç—Å—è –Ω–µ –±–æ–ª–µ–µ, —á–µ–º $n$ —Ä–∞–∑. –¢–æ–≥–¥–∞ –æ–±—â–µ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ $-\\Theta(n)$.\n‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 def find_max_subarray(a, M): n = len(a) maxLen = 0 ansL = 0 ansR = 0 r = 0 sum_ = 0 for l in range(n): # –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º –ª–µ–≤—É—é –≥—Ä–∞–Ω–∏—Ü—É while r \u003c n and sum_ + a[r] \u003c= M: sum_ += a[r] r += 1 if sum_ \u003c= M and r - l \u003e maxLen: maxLen = r - l ansL = l ansR = r sum_ -= a[l] return ansL, ansR, maxLen # –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è a = [1, 2, 3, 4, 5] M = 10 left, right, length = find_max_subarray(a, M) print(f\"–õ–µ–≤–∞—è –≥—Ä–∞–Ω–∏—Ü–∞: {left}, –ü—Ä–∞–≤–∞—è –≥—Ä–∞–Ω–∏—Ü–∞: {right}, –î–ª–∏–Ω–∞: {length}\") print(f\"–ü–æ–¥–º–∞—Å—Å–∏–≤: {a[left:right]}\") 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 #include \u003ciostream\u003e #include \u003cvector\u003e void findMaxSubarray(const std::vector\u003cint\u003e\u0026 a, int M, int\u0026 ansL, int\u0026 ansR, int\u0026 maxLen) { int n = a.size(); maxLen = 0; ansL = 0; ansR = 0; int r = 0; int sum = 0; for (int l = 0; l \u003c n; l++) { // –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º –ª–µ–≤—É—é –≥—Ä–∞–Ω–∏—Ü—É while (r \u003c n \u0026\u0026 sum + a[r] \u003c= M) { sum += a[r]; r++; } if (sum \u003c= M \u0026\u0026 r - l \u003e maxLen) { maxLen = r - l; ansL = l; ansR = r; } sum -= a[l]; } } int main() { std::vector\u003cint\u003e a = {1, 2, 3, 4, 5}; int M = 10; int left, right, length; findMaxSubarray(a, M, left, right, length); cout \u003c\u003c \"–õ–µ–≤–∞—è –≥—Ä–∞–Ω–∏—Ü–∞: \" \u003c\u003c left \u003c\u003c \", –ü—Ä–∞–≤–∞—è –≥—Ä–∞–Ω–∏—Ü–∞: \" \u003c\u003c right \u003c\u003c \", –î–ª–∏–Ω–∞: \" \u003c\u003c length \u003c\u003c endl; cout \u003c\u003c \"–ü–æ–¥–º–∞—Å—Å–∏–≤: \"; for (int i = left; i \u003c right; i++) { cout \u003c\u003c a[i] \u003c\u003c \" \"; } cout \u003c\u003c endl; return 0; }",
    "description": "–î–≤–æ–∏—á–Ω—ã–π –ø–æ–∏—Å–∫ –ï—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Å—Å–∏–≤–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ (—Ç–æ –µ—Å—Ç—å –º–∞—Å—Å–∏–≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω), —Ç–æ –∏—Å–∫–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ –º–∞—Å—Å–∏–≤–µ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –∑–∞ –ª–∏–Ω–µ–π–Ω–æ–µ –≤—Ä–µ–º—è.\n–ü—É—Å—Ç—å –º—ã —Ö–æ—Ç–∏–º –Ω–∞–π—Ç–∏ $x$ –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –º–∞—Å—Å–∏–≤–µ $a$ –¥–ª–∏–Ω—ã $n$. –°–Ω–æ–≤–∞ –ø—Ä–∏–º–µ–Ω–∏–º –∏–¥–µ—é –º–µ—Ç–æ–¥–∞ ‚Äú—Ä–∞–∑–¥–µ–ª—è–π –∏ –≤–ª–∞—Å—Ç–≤—É–π‚Äù: –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –º–∞—Å—Å–∏–≤–∞ - $a\\left[\\frac{n}{2}\\right]$. –ï—Å–ª–∏ $a\\left[\\frac{n}{2}\\right]=x$, —Ç–æ –º—ã –Ω–∞—à–ª–∏ $x$ –≤ –º–∞—Å—Å–∏–≤–µ $a$. –ï—Å–ª–∏ $a\\left[\\frac{n}{2}\\right]\u003ex$, —Ç–æ $x$ –º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏—Å—å —Ç–æ–ª—å–∫–æ –≤ $a\\left[0,1, \\ldots, \\frac{n}{2}-1\\right]$. –ï—Å–ª–∏ –∂–µ $a\\left[\\frac{n}{2}\\right] \u003c x$, —Ç–æ $x$ –º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏—Å—å —Ç–æ–ª—å–∫–æ –≤ $a\\left[\\frac{n}{2}+1, \\ldots, n-1\\right]$. –í –ª—é–±–æ–º –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–≤—É—Ö —Å–ª—É—á–∞–µ–≤, –º—ã –≤–¥–≤–æ–µ —É–º–µ–Ω—å—à–∏–ª–∏ –¥–ª–∏–Ω—É –æ—Ç—Ä–µ–∑–∫–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –Ω—É–∂–Ω–æ –∏—Å–∫–∞—Ç—å $x$.",
    "tags": [],
    "title": "5. –î–≤–æ–∏—á–Ω—ã–π –ø–æ–∏—Å–∫",
    "uri": "/basics/binary_search/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.¬†\u003e¬†17. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ",
    "content": "–ï—Å—Ç—å —Ä—é–∫–∑–∞–∫ (knapsack) –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ $W$, –∞ —Ç–∞–∫–∂–µ $n$ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –≤–µ—Å–∞ $w_{1}, \\ldots, w_{n}$ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ $p_{1}, \\ldots, p_{n}$. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–º–µ—Å—Ç–∏—Ç—å –≤ —Ä—é–∫–∑–∞–∫ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ–π —Å—É–º–º–∞—Ä–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏. –ë–æ–ª–µ–µ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ, –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ —Ç–∞–∫–æ–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ $A \\subset\\{1, \\ldots, n\\}$, —á—Ç–æ $\\sum_{i \\in A} w_{i} \\leqslant W$, –∞ –∑–Ω–∞—á–µ–Ω–∏–µ $\\sum_{i \\in A} p_{i}$ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ.\n–°—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–≥–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞—Ü–∏–π —ç—Ç–æ–π –∑–∞–¥–∞—á–∏. –ú–æ–∂–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –µ—Å—Ç—å –ª–∏—à—å –æ–¥–Ω–∞ –∫–æ–ø–∏—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞ (–≤–µ—Ä—Å–∏—è ‚Äú–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π‚Äù), –∞ –º–æ–∂–Ω–æ - —á—Ç–æ –∫–æ–ø–∏–π –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –º–Ω–æ–≥–æ (–≤–µ—Ä—Å–∏—è ‚Äú—Å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è–º–∏‚Äù).\n–í–µ—Ä—Å–∏—è ‚Äú—Å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è–º–∏‚Äù –ü—É—Å—Ç—å $k[j]$ - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–∞—è —Å—É–º–º–∞—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å, –µ—Å–ª–∏ —Ä—é–∫–∑–∞–∫ –∏–º–µ–µ—Ç –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å $j$. –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: $k[0]=0$. –ü–µ—Ä–µ—Ö–æ–¥ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –≤—ã–±–æ—Ä–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–∑—è—Ç–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞:\n$$ k[j]=\\max _{w_{i} \\leqslant j}\\left(k\\left[j-w_{i}\\right]+p_{i}\\right) $$(–º–∞–∫—Å–∏–º—É–º –ø–æ –ø—É—Å—Ç–æ–º—É –º–Ω–æ–∂–µ—Å—Ç–≤—É —Å—á–∏—Ç–∞–µ–º —Ä–∞–≤–Ω—ã–º –Ω—É–ª—é). –û—Ç–≤–µ—Ç –Ω–∞ –∑–∞–¥–∞—á—É $-\\max _{0 \\leqslant j \\leqslant W} k[j]$. –ü–æ–ª—É—á–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O(n W)$ —Å $O(W)$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –¥–µ–ª–∞–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏.\n1 2 3 4 5 fill(k, 0) for j = 0..W: for i = 1..n: if w[i] \u003c= j: k[j] = max(k[j], k[j - w[i]] + p[i]) –í–µ—Ä—Å–∏—è ‚Äú–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π‚Äù –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –Ω–µ –≤–∑—è—Ç—å –æ–¥–∏–Ω –ø—Ä–µ–¥–º–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, –≤–≤–µ–¥—ë–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä. –ü—É—Å—Ç—å $k[i, j]$ - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–∞—è —Å—É–º–º–∞—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å, –µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è –±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥–º–µ—Ç—ã —Å –Ω–æ–º–µ—Ä–∞–º–∏ –Ω–µ –±–æ–ª—å—à–µ $i$, –∞ —Ä—é–∫–∑–∞–∫ –∏–º–µ–µ—Ç –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å $j$. –ù–∞—á–∞–ª—å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è: $k[0, j]=k[i, 0]=0$. –ü–µ—Ä–µ—Ö–æ–¥: –ª–∏–±–æ $i$-–π –ø—Ä–µ–¥–º–µ—Ç –≤—Ö–æ–¥–∏—Ç –≤ –æ—Ç–≤–µ—Ç (—Ç–æ –µ—Å—Ç—å $k[i, j]=k\\left[i-1, j-w_{i}\\right]$; —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –≤–æ–∑–º–æ–∂–µ–Ω —Ç–æ–ª—å–∫–æ –ø—Ä–∏ $j \\geqslant w_{i}$ ), –ª–∏–±–æ –Ω–µ –≤—Ö–æ–¥–∏—Ç (—Ç–æ –µ—Å—Ç—å $k[i, j]=k[i-1, j])$. –ü–æ–ª—É—á–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O(n W)$ —Å —Ç–∞–∫–æ–π –∂–µ –æ—Ü–µ–Ω–∫–æ–π –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏. .\n1 2 3 4 5 6 fill(k, 0) for i = 1..n: for j = 0..W: k[i, j] = k[i - 1, j] if w[i] \u003c= j: k[i, j] = max(k[i, j], k[i - 1, j - w[i]] + p[i]) –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ $k[i, j]$ –∞–ª–≥–æ—Ä–∏—Ç–º—É –º–æ–≥—É—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏—è $k[i-1, q]$ —Å $q \\leqslant j$. –°–¥–µ–ª–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Ç—Ä—é–∫: –±—É–¥–µ–º –≤—ã—á–∏—Å–ª—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è $k[i, j]$ –ø—Ä–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º $i$ –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è $j$ (–∞ –Ω–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è, –∫–∞–∫ —Ä–∞–Ω—å—à–µ). –¢–æ–≥–¥–∞ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–º –º–∞—Å—Å–∏–≤–æ–º: –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è $(i, j)$ –≤ $k[0 . . j]$ –±—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è $k[i-1,0], \\ldots, k[i-1, j]$, –∞ –≤ $k[j+1 . . W]$ - –∑–Ω–∞—á–µ–Ω–∏—è $k[i, j+1], \\ldots, k[i, W]$. –ü–æ–ª—É—á–∞–µ—Ç—Å—è, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ $O(W)$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏. –ü—Ä–∏ —ç—Ç–æ–º –ø–æ–ª—É—á–∏–≤—à–∏–π—Å—è –∫–æ–¥ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Ä–µ—à–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏ –∑–∞–¥–∞—á–∏ ‚Äú—Å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è–º–∏‚Äù —Ç–æ–ª—å–∫–æ –ø–æ—Ä—è–¥–∫–æ–º –ø–µ—Ä–µ–±–æ—Ä–∞ –∑–Ω–∞—á–µ–Ω–∏–π $j$.\nfill(k, 0) for i = 1..n: for j = W..O: if w[i] \u003c= j: k[j] = max(k[j], k[j - w[i]] + p[i]) –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –í –≤–µ—Ä—Å–∏–∏ —Å –¥–≤—É–º–µ—Ä–Ω—ã–º –º–∞—Å—Å–∏–≤–æ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –¥–µ–ª–∞–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏. –í –≤–µ—Ä—Å–∏–∏ —Å –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–º –º–∞—Å—Å–∏–≤–æ–º –æ—Ç–≤–µ—Ç –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ —É–¥–∞—Å—Ç—Å—è; –∑–∞—Ç–æ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏–¥–µ—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –•–∏—Ä—à–±–µ—Ä–≥–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ç–≤–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É—è $O(W+\\log n)$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏, –∏ –Ω–µ —É—Ö—É–¥—à–∏–≤ –æ—Ü–µ–Ω–∫—É –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã.",
    "description": "–ï—Å—Ç—å —Ä—é–∫–∑–∞–∫ (knapsack) –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ $W$, –∞ —Ç–∞–∫–∂–µ $n$ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –≤–µ—Å–∞ $w_{1}, \\ldots, w_{n}$ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ $p_{1}, \\ldots, p_{n}$. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–º–µ—Å—Ç–∏—Ç—å –≤ —Ä—é–∫–∑–∞–∫ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ–π —Å—É–º–º–∞—Ä–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏. –ë–æ–ª–µ–µ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ, –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ —Ç–∞–∫–æ–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ $A \\subset\\{1, \\ldots, n\\}$, —á—Ç–æ $\\sum_{i \\in A} w_{i} \\leqslant W$, –∞ –∑–Ω–∞—á–µ–Ω–∏–µ $\\sum_{i \\in A} p_{i}$ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ.\n–°—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–≥–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞—Ü–∏–π —ç—Ç–æ–π –∑–∞–¥–∞—á–∏. –ú–æ–∂–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –µ—Å—Ç—å –ª–∏—à—å –æ–¥–Ω–∞ –∫–æ–ø–∏—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞ (–≤–µ—Ä—Å–∏—è ‚Äú–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π‚Äù), –∞ –º–æ–∂–Ω–æ - —á—Ç–æ –∫–æ–ø–∏–π –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –º–Ω–æ–≥–æ (–≤–µ—Ä—Å–∏—è ‚Äú—Å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è–º–∏‚Äù).",
    "tags": [],
    "title": "–ó–∞–¥–∞—á–∞ –æ —Ä—é–∫–∑–∞–∫–µ",
    "uri": "/basics/dynamic_programming/knapsack_problem/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.",
    "content": "–ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –°—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, —Å–æ—Ä—Ç–∏—Ä—É—é—â–∏—Ö –º–∞—Å—Å–∏–≤ –¥–ª–∏–Ω—ã $n$ –∑–∞ $\\Theta\\left(n^{2}\\right)$. –ú—ã –ø–æ–≥–æ–≤–æ—Ä–∏–º –ª–∏—à—å –æ –¥–≤—É—Ö –∏–∑ –Ω–∏—Ö.\n–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤—ã–±–æ—Ä–æ–º –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤—ã–±–æ—Ä–æ–º (selection sort) –Ω–∞ $i$-–º —à–∞–≥–µ –Ω–∞—Ö–æ–¥–∏—Ç $i$-–π –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —ç–ª–µ–º–µ–Ω—Ç –∏ —Å—Ç–∞–≤–∏—Ç –µ–≥–æ –Ω–∞ $i$-—é –ø–æ–∑–∏—Ü–∏—é. –ü–æ—Å–∫–æ–ª—å–∫—É –ø–µ—Ä–≤—ã–µ $i-1$ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç —É–∂–µ —Å—Ç–æ—è—Ç –Ω–∞ —Å–≤–æ–∏—Ö –ø–æ–∑–∏—Ü–∏—è—Ö, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ –Ω–∞–π—Ç–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–µ $[i, n)$. ‚Äã python cpp 1 2 3 4 5 6 7 8 9 def selection_sort(arr): n = len(arr) for i in range(n): min_pos = i for j in range(i + 1, n): if arr[min_pos] \u003e arr[j]: min_pos = j arr[i], arr[min_pos] = arr[min_pos], arr[i] return arr 1 2 3 4 5 6 7 8 9 10 11 12 void selectionSort(std::vector\u003cint\u003e\u0026 arr) { int n = arr.size(); for (int i = 0; i \u003c n; i++) { int minPos = i; for (int j = i + 1; j \u003c n; j++) { if (arr[minPos] \u003e arr[j]) { minPos = j; } } std::swap(arr[i], arr[minPos]); } } –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤—Å—Ç–∞–≤–∫–∞–º–∏ –ù–∞ $i$-–º —à–∞–≥–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤—Å—Ç–∞–≤–∫–∞–º–∏ (insertion sort) –ø–µ—Ä–≤—ã–µ $i$ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Å—Å–∏–≤–∞ (–æ–±—Ä–∞–∑—É—é—â–∏–µ –ø—Ä–µ—Ñ–∏–∫—Å –¥–ª–∏–Ω—ã $i$ ) —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ. $i$-–π —à–∞–≥ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ $i$-–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –Ω—É–∂–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –æ—Å—Ç–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ—Ñ–∏–∫—Å–∞. ‚Äã python cpp 1 2 3 4 5 6 7 8 def insertion_sort(a): n = len(a) for i in range(1, n): j = i while j \u003e 0 and a[j] \u003c a[j - 1]: a[j], a[j - 1] = a[j - 1], a[j] j -= 1 return a 1 2 3 4 5 6 7 8 void insertionSort(std::vector\u003cint\u003e\u0026 a) { int n = a.size(); for (int i = 1; i \u003c n; ++i) { for (int j = i; j \u003e 0 \u0026\u0026 a[j] \u003c a[j - 1]; --j) { std::swap(a[j], a[j - 1]); } } } –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –í –æ–±–µ–∏—Ö —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞—Ö –¥–≤–∞ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ü–∏–∫–ª–∞ –≤ —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ –¥–∞—é—Ç –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã $\\Theta\\left(n^{2}\\right)$. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤—ã–±–æ—Ä–æ–º –ø–æ–ª–µ–∑–Ω–∞ —Ç–µ–º, —á—Ç–æ –¥–µ–ª–∞–µ—Ç $\\Theta(n)$ –æ–ø–µ—Ä–∞—Ü–∏–π swap. –≠—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ –ø—Ä–∏–≥–æ–∂–¥–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è —Ç—è–∂—ë–ª—ã–µ –æ–±—ä–µ–∫—Ç—ã, –∏ –∫–∞–∂–¥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è swap –∑–∞–Ω–∏–º–∞–µ—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.\n–ò–Ω–≤–µ—Ä—Å–∏–µ–π –Ω–∞–∑—ã–≤–∞—é—Ç —Ç–∞–∫—É—é –ø–∞—Ä—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ –ø–æ–∑–∏—Ü–∏—è—Ö $i \u003c j$, —á—Ç–æ $a_{i} \u003e a_{j}$. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —è–≤–ª—è–µ—Ç—Å—è –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–æ–≥–¥–∞ –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –≤ –Ω–µ–π –Ω–µ—Ç –∏–Ω–≤–µ—Ä—Å–∏–π. –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤—Å—Ç–∞–≤–∫–∞–º–∏ –º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –∫–∞–∫ $\\Theta(n+\\operatorname{Inv}(a))$, –≥–¥–µ $\\operatorname{Inv}(a)$ - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–≤–µ—Ä—Å–∏–π –≤ –º–∞—Å—Å–∏–≤–µ $a$, —Ç–∞–∫ –∫–∞–∫ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ü–∏–∫–ª–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–≤–µ—Ä—Å–∏–π –≤ –º–∞—Å—Å–∏–≤–µ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è —Ä–æ–≤–Ω–æ –Ω–∞ –æ–¥–∏–Ω. –ó–Ω–∞—á–∏—Ç, –Ω–∞ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º (–∏–ª–∏ –ø–æ—á—Ç–∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º) –º–∞—Å—Å–∏–≤–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤—Å—Ç–∞–≤–∫–∞–º–∏ —Å–æ—Å—Ç–∞–≤–∏—Ç $O(n)$.\n–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π, –µ—Å–ª–∏ –æ–Ω–∞ –æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ. –û–±—ã—á–Ω–æ —Ç–∞–∫–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –Ω—É–∂–Ω–æ, –∫–æ–≥–¥–∞ –ø–æ–º–∏–º–æ –¥–∞–Ω–Ω—ã—Ö, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, –≤ —ç–ª–µ–º–µ–Ω—Ç–∞—Ö –º–∞—Å—Å–∏–≤–∞ —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫–∏–µ-—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –¥–∞–Ω —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –∏ —Ö–æ—á–µ—Ç—Å—è –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –ø–æ —É–±—ã–≤–∞–Ω–∏—é –Ω–∞–±—Ä–∞–Ω–Ω—ã—Ö –±–∞–ª–ª–æ–≤ —Ç–∞–∫, —á—Ç–æ–±—ã —É—á–∞—Å—Ç–Ω–∏–∫–∏ —Å —Ä–∞–≤–Ω—ã–º —á–∏—Å–ª–æ–º –±–∞–ª–ª–æ–≤ –≤—Å—ë –µ—â—ë —à–ª–∏ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.\n–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤—ã–±–æ—Ä–æ–º —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –Ω–µ —è–≤–ª—è–µ—Ç—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–∞—Å—Å–∏–≤ $[5,5,3,1]$ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —à–∞–≥–∞ –∏–∑–º–µ–Ω–∏—Ç—Å—è –Ω–∞ $[1,5,3,5]$, –ø—Ä–∏ —ç—Ç–æ–º –ø–æ—Ä—è–¥–æ–∫ –ø—è—Ç—ë—Ä–æ–∫ –ø–æ–º–µ–Ω—è–ª—Å—è). –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤—Å—Ç–∞–≤–∫–∞–º–∏ —Å—Ç–∞–±–∏–ª—å–Ω–∞, —Ç–∞–∫ –∫–∞–∫ –º–µ–Ω—è–µ—Ç –º–µ—Å—Ç–∞–º–∏ —Ç–æ–ª—å–∫–æ —Å–æ—Å–µ–¥–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –æ–±—Ä–∞–∑—É—é—â–∏–µ –∏–Ω–≤–µ—Ä—Å–∏—é, –ø–æ—ç—Ç–æ–º—É –Ω–∏ –≤ –∫–∞–∫–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–µ –ø–æ–º–µ–Ω—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ —Ä–∞–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.\n‚úçÔ∏è –õ—é–±—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ–π, –µ—Å–ª–∏ –≤–º–µ—Å—Ç–æ –∏—Å—Ö–æ–¥–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä—ã (—ç–ª–µ–º–µ–Ω—Ç, –µ–≥–æ –Ω–æ–º–µ—Ä –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –º–∞—Å—Å–∏–≤–µ), –∏ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –ø–∞—Ä —Å–Ω–∞—á–∞–ª–∞ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã, –∞ –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ –Ω–æ–º–µ—Ä–∞.\n–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –°–µ–π—á–∞—Å –º—ã –ø–µ—Ä–µ–π–¥—ë–º –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, —Ä–∞–±–æ—Ç–∞—é—â–∏–º –∑–∞ $\\Theta(n \\log n)$. –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, –±–ª–∞–≥–æ–¥–∞—Ä—è –º–∞–ª–æ–π –∫–æ–Ω—Å—Ç–∞–Ω—Ç–µ –≤ –æ—Ü–µ–Ω–∫–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã, —Ä–∞–±–æ—Ç–∞—é—Ç –±—ã—Å—Ç—Ä–µ–µ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –Ω–∞ –∫–æ—Ä–æ—Ç–∫–∏—Ö –º–∞—Å—Å–∏–≤–∞—Ö. –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —á–∞—Å—Ç–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥: –∞–ª–≥–æ—Ä–∏—Ç–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –º–µ—Ç–æ–¥ ‚Äú—Ä–∞–∑–¥–µ–ª—è–π –∏ –≤–ª–∞—Å—Ç–≤—É–π‚Äù, —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ–∫–∞ –º–∞—Å—Å–∏–≤ –Ω–µ –ø–æ–¥–µ–ª–∏—Ç—Å—è –Ω–∞ —á–∞—Å—Ç–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–∞–ª–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, –ø–æ—Å–ª–µ —á–µ–≥–æ –Ω–∞ –Ω–∏—Ö –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏.\n–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å–ª–∏—è–Ω–∏–µ–º (Merge sort) –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å–ª–∏—è–Ω–∏–µ–º (Von Neumann, 1945) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥ ‚Äú—Ä–∞–∑–¥–µ–ª—è–π –∏ –≤–ª–∞—Å—Ç–≤—É–π‚Äù —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º: –º–∞—Å—Å–∏–≤ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏, –∫–∞–∂–¥–∞—è –∏–∑ –Ω–∏—Ö —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ, –ø–æ—Å–ª–µ —á–µ–≥–æ –¥–≤–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —á–∞—Å—Ç–∏ —Å–ª–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ –º–µ—Ç–æ–¥–∞ –¥–≤—É—Ö —É–∫–∞–∑–∞—Ç–µ–ª–µ–π. ‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 def merge(a, l, m, r, buf): # –°–ª–∏–≤–∞–µ—Ç –¥–≤–∞ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç—Ä–µ–∑–∫–∞ a[l:m) –∏ a[m:r) i, j, k = l, m, 0 while i \u003c m or j \u003c r: if i == m or (j \u003c r and a[i] \u003e a[j]): buf[k] = a[j] k += 1 j += 1 else: buf[k] = a[i] k += 1 i += 1 # –ö–æ–ø–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ –∏—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤ for idx in range(r - l): a[l + idx] = buf[idx] def merge_sort(a, l, r, buf): # –°–æ—Ä—Ç–∏—Ä—É–µ—Ç a[l:r) if r - l \u003c= 1: return m = (l + r) // 2 merge_sort(a, l, m, buf) merge_sort(a, m, r, buf) merge(a, l, m, r, buf) def sort_array(arr): # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤—ã–∑–æ–≤–∞ buf = [0] * len(arr) merge_sort(arr, 0, len(arr), buf) return arr 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 #include \u003ciostream\u003e #include \u003cvector\u003e // –°–ª–∏–≤–∞–µ—Ç –¥–≤–∞ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç—Ä–µ–∑–∫–∞ a[l, m) –∏ a[m, r) void merge(std::vector\u003cint\u003e\u0026 a, int l, int m, int r, std::vector\u003cint\u003e\u0026 buf) { int i = l, j = m, k = 0; while (i \u003c m || j \u003c r) { if (i == m || (j \u003c r \u0026\u0026 a[i] \u003e a[j])) { buf[k] = a[j]; ++k; ++j; } else { buf[k] = a[i]; ++k; ++i; } } // –ö–æ–ø–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ –∏—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤ for (int idx = 0; idx \u003c r - l; ++idx) { a[l + idx] = buf[idx]; } } // –°–æ—Ä—Ç–∏—Ä—É–µ—Ç a[l, r) void mergeSort(std::vector\u003cint\u003e\u0026 a, int l, int r, std::vector\u003cint\u003e\u0026 buf) { if (r - l \u003c= 1) { return; } int m = (l + r) / 2; mergeSort(a, l, m, buf); mergeSort(a, m, r, buf); merge(a, l, m, r, buf); } // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤—ã–∑–æ–≤–∞ void sortArray(std::vector\u003cint\u003e\u0026 arr) { std::vector\u003cint\u003e buf(arr.size()); mergeSort(arr, 0, arr.size(), buf); } –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Å–ª–∏—è–Ω–∏–µ–º –º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å —Å –ø–æ–º–æ—â—å—é —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–≥–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è $T(n)=2 \\cdot T\\left(\\frac{n}{2}\\right)+\\Theta(n)$. –ü–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–æ—Ä–µ–º–µ –æ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –ø–æ–ª—É—á–∞–µ–º $T(n)=\\Theta(n \\log n)$.\n–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å–ª–∏—è–Ω–∏–µ–º —Å—Ç–∞–±–∏–ª—å–Ω–∞ (–ø–æ—Å–∫–æ–ª—å–∫—É —Ñ—É–Ω–∫—Ü–∏—è merge –Ω–µ –º–µ–Ω—è–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —Ä–∞–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤).\n–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–æ–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Å–ª–∏—è–Ω–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ –æ–Ω–∞ —Ç—Ä–µ–±—É–µ—Ç $\\Theta(n)$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ (–≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–∞—Å—Å–∏–≤ –≤ merge).\n–ë—ã—Å—Ç—Ä–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (Quicksort) –ë—ã—Å—Ç—Ä–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (Hoare, 1959) —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥ ‚Äú—Ä–∞–∑–¥–µ–ª—è–π –∏ –≤–ª–∞—Å—Ç–≤—É–π‚Äù, –Ω–æ –Ω–µ–º–Ω–æ–≥–æ –ø–æ-–¥—Ä—É–≥–æ–º—É. –í–æ–∑—å–º—ë–º –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ - $x$. –ü–æ–¥–µ–ª–∏–º –º–∞—Å—Å–∏–≤ –Ω–∞ —Ç—Ä–∏ —á–∞—Å—Ç–∏ —Ç–∞–∫, —á—Ç–æ –≤ –ø–µ—Ä–≤–æ–π –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–µ–Ω—å—à–µ $x$, –≤–æ –≤—Ç–æ—Ä–æ–π —Ä–∞–≤–Ω—ã $x$, –≤ —Ç—Ä–µ—Ç—å–µ–π –±–æ–ª—å—à–µ $x$ (—ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∑–∞ –ª–∏–Ω–µ–π–Ω–æ–µ –æ—Ç –¥–ª–∏–Ω—ã –º–∞—Å—Å–∏–≤–∞ –≤—Ä–µ–º—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –ø–æ–º–æ—â—å—é —Ç—Ä—ë—Ö –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –º–∞—Å—Å–∏–≤–æ–≤). –û—Å—Ç–∞—ë—Ç—Å—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–≤—É—é –∏ —Ç—Ä–µ—Ç—å—é —á–∞—Å—Ç–∏. ‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 import random def quick_sort(a): if len(a) \u003c= 1: return a x = random.choice(a) # —Å–ª—É—á–∞–π–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç a l = [] # —ç–ª–µ–º–µ–Ω—Ç—ã –º–µ–Ω—å—à–µ x m = [] # —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–∞–≤–Ω—ã–µ x r = [] # —ç–ª–µ–º–µ–Ω—Ç—ã –±–æ–ª—å—à–µ x for element in a: if element \u003c x: l.append(element) elif element == x: m.append(element) else: # element \u003e x r.append(element) return quick_sort(l) + m + quick_sort(r) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 #include \u003cvector\u003e #include \u003ccstdlib\u003e #include \u003cctime\u003e std::vector\u003cint\u003e quickSort(std::vector\u003cint\u003e a) { if (a.size() \u003c= 1) { return a; } // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç int randomIndex = rand() % a.size(); int x = a[randomIndex]; std::vector\u003cint\u003e l; // —ç–ª–µ–º–µ–Ω—Ç—ã –º–µ–Ω—å—à–µ x std::vector\u003cint\u003e m; // —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–∞–≤–Ω—ã–µ x std::vector\u003cint\u003e r; // —ç–ª–µ–º–µ–Ω—Ç—ã –±–æ–ª—å—à–µ x for (int element : a) { if (element \u003c x) { l.push_back(element); } else if (element == x) { m.push_back(element); } else { // element \u003e x r.push_back(element); } } // –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ª–µ–≤—É—é –∏ –ø—Ä–∞–≤—É—é —á–∞—Å—Ç–∏ std::vector\u003cint\u003e sorted_l = quickSort(l); std::vector\u003cint\u003e sorted_r = quickSort(r); // –û–±—ä–µ–¥–∏–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã std::vector\u003cint\u003e result; result.reserve(sorted_l.size() + m.size() + sorted_r.size()); result.insert(result.end(), sorted_l.begin(), sorted_l.end()); result.insert(result.end(), m.begin(), m.end()); result.insert(result.end(), sorted_r.begin(), sorted_r.end()); return result; } –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ, —á—Ç–æ–±—ã –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç–∞–ª –±—ã—Å—Ç—Ä–µ–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –º–µ–Ω—å—à–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏, –∏—Å–ø–æ–ª—å–∑—É—é—Ç –±–æ–ª–µ–µ —Ö–∏—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± –¥–µ–ª–µ–Ω–∏—è –º–∞—Å—Å–∏–≤–∞ –Ω–∞ —á–∞—Å—Ç–∏: ‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 import random def partition(a, l, r): # –≤—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç p = random.randint(l, r) x = a[p] # –º–µ–Ω—è–µ–º –µ–≥–æ —Å –ø–µ—Ä–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º a[p], a[l] = a[l], a[p] i, j = l, r while i \u003c= j: while i \u003c= j and a[i] \u003c x: i += 1 while i \u003c= j and a[j] \u003e x: j -= 1 if i \u003e= j: break a[i], a[j] = a[j], a[i] i += 1 j -= 1 return j def quick_sort(a, l, r): if l \u003e= r: # –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ª–æ–≤–∏–µ: l == r -\u003e l \u003e= r return m = partition(a, l, r) quick_sort(a, l, m) quick_sort(a, m + 1, r) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 #include \u003cvector\u003e #include \u003ccstdlib\u003e #include \u003cctime\u003e int partition(std::vector\u003cint\u003e\u0026 a, int l, int r) { // –≤—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç int p = l + rand() % (r - l + 1); int x = a[p]; // –º–µ–Ω—è–µ–º –µ–≥–æ —Å –ø–µ—Ä–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º std::swap(a[p], a[l]); int i = l, j = r; while (i \u003c= j) { while (i \u003c= j \u0026\u0026 a[i] \u003c x) { i++; } while (i \u003c= j \u0026\u0026 a[j] \u003e x) { j--; } if (i \u003e= j) { break; } std::swap(a[i], a[j]); i++; j--; } return j; } void quickSort(std::vector\u003cint\u003e\u0026 a, int l, int r) { if (l \u003e= r) { // –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ª–æ–≤–∏–µ: l == r -\u003e l \u003e= r return; } int m = partition(a, l, r); quickSort(a, l, m); quickSort(a, m + 1, r); } –°–≤–æ–π—Å—Ç–≤–∞ –§—É–Ω–∫—Ü–∏—è partition —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, —Ç–æ –µ—Å—Ç—å $i$ –∏ $j$ –Ω–µ –≤—ã—Ö–æ–¥—è—Ç –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã $l, r$, —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–∞–∫–æ–µ $m$, —á—Ç–æ $l \\leqslant m \u003c r$, –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã $a[l, m]$ –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω—ã $x$, –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã $a[m+1, r]$ –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω—ã $x$. –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã $a[l, i)$ –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω—ã $x$, –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã $a(j, r]$ –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω—ã $x$.\n–ù–∞ –ø–µ—Ä–≤–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –≤–Ω–µ—à–Ω–µ–≥–æ —Ü–∏–∫–ª–∞ –≤ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ª–æ–≤–∏—è –Ω–∞ $13$-–æ–π —Å—Ç—Ä–æ–∫–µ –≤–µ—Ä–Ω–æ, —á—Ç–æ $i=l \\leqslant j$. –ó–Ω–∞—á–∏—Ç –ª–∏–±–æ –º—ã —Å—Ä–∞–∑—É –≤—ã–π–¥–µ–º –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ —Ü–∏–∫–ª–∞ (–µ—Å–ª–∏ $i=j=l \u003c r$ ), –ª–∏–±–æ –≤—ã–ø–æ–ª–Ω—è—Ç—Å—è $15-16$ —Å—Ç—Ä–æ–∫–∏, –ø–æ—Å–ª–µ —á–µ–≥–æ –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –≤–µ—Ä–Ω–æ, —á—Ç–æ $a[l] \\leqslant x, a[r] \\geqslant x, j \u003c r$. –ü—Ä–∏ —ç—Ç–æ–º 15-16 —Å—Ç—Ä–æ–∫–∏ –≤—ã–ø–æ–ª–Ω–∏–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ $i \u003c j$, —Ç–æ–≥–¥–∞ –¥–∞–∂–µ –ø–æ—Å–ª–µ –∏—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è $i$, $j$ –Ω–µ –≤—ã—à–ª–∏ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã $l$, $r$.\n–û—Ç–¥–µ–ª—å–Ω–æ –æ—Ç–º–µ—Ç–∏–º, —á—Ç–æ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –≤–Ω–µ—à–Ω–µ–≥–æ —Ü–∏–∫–ª–∞ —Ç–æ—á–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ $j \u003c r$.\n–ù–∞ –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∏—Ç–µ—Ä–∞—Ü–∏—è—Ö –≤–Ω–µ—à–Ω–µ–≥–æ —Ü–∏–∫–ª–∞ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è $9-12$ —Å—Ç—Ä–æ–∫ –±—É–¥—É—Ç –≤–µ—Ä–Ω—ã –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ $j \\geqslant l, i \\leqslant r$ (—Ç–∞–∫ –∫–∞–∫ $a[l] \\leqslant x, a[r] \\geqslant x$ ). –ü—Ä–∏ —ç—Ç–æ–º –µ—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –Ω–∞\n13-–π —Å—Ç—Ä–æ–∫–µ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è (—Ç–æ –µ—Å—Ç—å $i \u003c j$ ), —Ç–æ –¥–∞–∂–µ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è $15-16$ —Å—Ç—Ä–æ–∫ $i, j$ –Ω–µ –≤—ã–π–¥—É—Ç –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã $l, r$.\n–ù–∞–∫–æ–Ω–µ—Ü, –ø–æ –∏—Ç–æ–≥–∞–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ $l \\leqslant m=j \u003c r$, –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã $a[m+1, r]=$ $a(j, r]$ –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω—ã $x$, –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã $a[l, m]=a[l, j]$ –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω—ã $x$ (—Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –≤–µ—Ä–Ω–æ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ $a[l, i), j \\leqslant i$, –ø—Ä–∏—á—ë–º $j=i$ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –º—ã –≤—ã—à–ª–∏ –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ —Ü–∏–∫–ª–∞ –Ω–∞ $14$-–æ–π —Å—Ç—Ä–æ–∫–µ, —á—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ $a[j]=x$ ).\n–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ —Ç–∞–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —è–≤–ª—è–µ—Ç—Å—è –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π.\n–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã –í —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ –º–∞—Å—Å–∏–≤ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –±—É–¥–µ—Ç –¥–µ–ª–∏—Ç—å—Å—è –æ—á–µ–Ω—å –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ, –∏ –ø–æ—á—Ç–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –±—É–¥—É—Ç –ø–æ–ø–∞–¥–∞—Ç—å –≤ –æ–¥–Ω—É –∏–∑ —á–∞—Å—Ç–µ–π. –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –≤ —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ –º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å —Å –ø–æ–º–æ—â—å—é —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–≥–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è $T(n)=T(n-1)+\\Theta(n)$, —Ä–∞—Å–∫—Ä—ã–≤ –∫–æ—Ç–æ—Ä–æ–µ, –ø–æ–ª—É—á–∞–µ–º $T(n)=\\sum_{i=1}^{n} \\Theta(i)=\\Theta\\left(n^{2}\\right)$.\n–í –ª—É—á—à–µ–º –∂–µ —Å–ª—É—á–∞–µ –º–∞—Å—Å–∏–≤ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –±—É–¥–µ—Ç –¥–µ–ª–∏—Ç—å—Å—è –Ω–∞ –¥–≤–µ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–≤–Ω—ã–µ —á–∞—Å—Ç–∏. –ü–æ–ª—É—á–∞–µ–º —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ $T(n)=2 \\cdot T\\left(\\frac{n}{2}\\right)+\\Theta(n)$, —Ç–æ–≥–¥–∞ –ø–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–æ—Ä–µ–º–µ –æ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –ø–æ–ª—É—á–∞–µ–º $T(n)=\\Theta(n \\log n)$.\n–û–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≤ —Å—Ä–µ–¥–Ω–µ–º –Ω–∞–º–Ω–æ–≥–æ –±–ª–∏–∂–µ –∫ –ª—É—á—à–µ–º—É —Å–ª—É—á–∞—é, —á–µ–º –∫ —Ö—É–¥—à–µ–º—É. –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —ç—Ç–æ –¥–æ–∫–∞–∑–∞—Ç—å, –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è –∏–∑ —Ç–µ–æ—Ä–∏–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã $X$, –ø—Ä–∏–Ω–∏–º–∞—é—â–µ–π –∑–Ω–∞—á–µ–Ω–∏–µ $x_{1}$ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é $p_{1}, x_{2}$ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é $p_{2}, \\ldots, x_{n}$ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é $p_{n}$ $\\left(p_{1}+\\cdots+p_{n}=1\\right)$ –µ—Å—Ç—å\n$$ \\mathbb{E} X=\\sum_{i=1}^{n} p_{i} x_{i} . $$ –¢–µ–æ—Ä–µ–º–∞ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –±—ã—Å—Ç—Ä–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –µ—Å—Ç—å $O(n \\log n)$. –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –ú—ã –¥–æ–∫–∞–∂–µ–º —Ç–µ–æ—Ä–µ–º—É —Ç–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ, –∫–æ–≥–¥–∞ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Å—Å–∏–≤–∞ –ø–æ–ø–∞—Ä–Ω–æ —Ä–∞–∑–ª–∏—á–Ω—ã. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –±—É–¥–µ–º —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤–µ—Ä—Å–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞, –¥–µ–ª—è—â—É—é –º–∞—Å—Å–∏–≤ –Ω–∞ —Ç—Ä–∏ —á–∞—Å—Ç–∏ (—ç–ª–µ–º–µ–Ω—Ç—ã –º–µ–Ω—å—à–µ $x$; —ç–ª–µ–º–µ–Ω—Ç—ã, —Ä–∞–≤–Ω—ã–µ $x$; —ç–ª–µ–º–µ–Ω—Ç—ã –±–æ–ª—å—à–µ $x$ ).\n–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º, –∞ –≤ —É–∂–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –º–∞—Å—Å–∏–≤–µ: –ø—É—Å—Ç—å –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ –∏–º–µ–µ—Ç –≤–∏–¥ $z_{1}, z_{2}, \\ldots, z_{n}$, –∏—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤ $a$ - —ç—Ç–æ –∫–∞–∫–∞—è-—Ç–æ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ $z_{i}$.\n–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –±—ã—Å—Ç—Ä–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏–π. –û–±–æ–∑–Ω–∞—á–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏–π –∑–∞ $T(n)$, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –µ–≥–æ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ.\n$z_{i}$ –∏ $z_{j}$ –º–æ–≥–ª–∏ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å—Å—è, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–∞ –∫–∞–∫–æ–º-—Ç–æ —à–∞–≥–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –æ–¥–∏–Ω –∏–∑ –Ω–∏—Ö –±—ã–ª –≤—ã–±—Ä–∞–Ω –≤ –∫–∞—á–µ—Å—Ç–≤–µ $x$. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ —Ç–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –≤—ã–∑–æ–≤–∞—Ö, –ø–æ—ç—Ç–æ–º—É –∫–∞–∂–¥—É—é –ø–∞—Ä—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∞–ª–≥–æ—Ä–∏—Ç–º —Å—Ä–∞–≤–Ω–∏—Ç –Ω–µ –±–æ–ª–µ–µ, —á–µ–º –æ–¥–∏–Ω —Ä–∞–∑.\n–ü—É—Å—Ç—å $\\Gamma$ - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞, $p(A)$ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à—ë–ª —Å—Ü–µ–Ω–∞—Ä–∏–π $A \\in \\Gamma$. –î–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã $i, j$ –≤–≤–µ–¥—ë–º –≤–µ–ª–∏—á–∏–Ω—É $\\chi(A, i, j)$, —Ä–∞–≤–Ω—É—é –µ–¥–∏–Ω–∏—Ü–µ, –µ—Å–ª–∏ $z_{i}$ –∏ $z_{j}$ —Å—Ä–∞–≤–Ω–∏–≤–∞–ª–∏—Å—å –≤ —Å—Ü–µ–Ω–∞—Ä–∏–∏ $A$, –∏ –Ω—É–ª—é, –µ—Å–ª–∏ –Ω–µ —Å—Ä–∞–≤–Ω–∏–≤–∞–ª–∏—Å—å. –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–π —Ä–∞–≤–Ω—è–µ—Ç—Å—è\n$$ \\mathbb{E} T(n)=\\sum_{A \\in \\Gamma}\\left(p(A) \\sum_{1 \\leqslant i \u003c j \\leqslant n} \\chi(A, i, j)\\right)=\\sum_{1 \\leqslant i \u003c j \\leqslant n} \\sum_{A \\in \\Gamma} p(A) \\chi(A, i, j) . $$–û—Å—Ç–∞—ë—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã $1 \\leqslant i \u003c j \\leqslant n$ –ø–æ—Å—á–∏—Ç–∞—Ç—å $\\sum_{A \\in \\Gamma} p(A) \\chi(A, i, j)$, —Ç–æ –µ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —Å –∫–æ—Ç–æ—Ä–æ–π $z_{i}$ –∏ $z_{j}$ —Å—Ä–∞–≤–Ω–∏–≤–∞–ª–∏—Å—å –º–µ–∂–¥—É —Å–æ–±–æ–π.\n–ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –º–æ–º–µ–Ω—Ç, –≤ –∫–æ—Ç–æ—Ä—ã–π $z_{i}$ –∏ $z_{j}$ –ø—Ä–∏ –¥–µ–ª–µ–Ω–∏–∏ –º–∞—Å—Å–∏–≤–∞ –ø–æ–ø–∞–ª–∏ –≤ —Ä–∞–∑–Ω—ã–µ —á–∞—Å—Ç–∏. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –º–∞—Å—Å–∏–≤, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∏–ª—Å—è –Ω–∞ —á–∞—Å—Ç–∏ –≤ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç, –ø–æ—Å–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –±—É–¥–µ—Ç —è–≤–ª—è—Ç—å—Å—è –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–æ–º –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ $z$, —Ç–æ–≥–¥–∞ –≤–º–µ—Å—Ç–µ —Å $z_{i}$ –∏ $z_{j}$ –æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–µ—Å—å –ø–æ–¥–æ—Ç—Ä–µ–∑–æ–∫ $z[i, j]$.\n–ü–æ—Å–∫–æ–ª—å–∫—É $z_{i}$ –∏ $z_{j}$ –ø—Ä–∏ –¥–µ–ª–µ–Ω–∏–∏ –ø–æ–ø–∞–ª–∏ –≤ —Ä–∞–∑–Ω—ã–µ —á–∞—Å—Ç–∏, –≤ –∫–∞—á–µ—Å—Ç–≤–µ $x$ —Ç–æ—á–Ω–æ –±—ã–ª –≤—ã–±—Ä–∞–Ω –æ–¥–∏–Ω –∏–∑ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ $z[i, j]$. –ü—Ä–∏ —ç—Ç–æ–º $z_{i}$ –∏ $z_{j}$ —Å—Ä–∞–≤–Ω–∏–≤–∞–ª–∏—Å—å –º–µ–∂–¥—É —Å–æ–±–æ–π —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ $x$ –±—ã–ª –≤—ã–±—Ä–∞–Ω –æ–¥–∏–Ω –∏–∑ –Ω–∏—Ö. –ü–æ—Å–∫–æ–ª—å–∫—É $x$ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ä–∞–≤–Ω–æ–≤–µ—Ä–æ—è—Ç–Ω–æ, –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ –º–µ–∂–¥—É $z_{i}$ –∏ $z_{j}$ –ø—Ä–æ–∏–∑–æ—à–ª–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ, —Ä–∞–≤–Ω—è–µ—Ç—Å—è $\\frac{2}{j-i+1}$. –ü–æ–ª—É—á–∞–µ–º\n$$ \\begin{aligned} \\mathbb{E} T(n)= \u0026 \\sum_{1 \\leqslant i \u003c j \\leqslant n} \\sum_{A \\in \\Gamma} p(A) \\chi(A, i, j)=\\sum_{i=1}^{n-1} \\sum_{j=i+1}^{n} \\frac{2}{j-i+1}\\xlongequal{\\left(k=j-i\\right)} \\\\ \u0026 =\\sum_{i=1}^{n-1} \\sum_{k=1}^{n-i} \\frac{2}{k+1} \u003c 2 n \\sum_{k=1}^{n} \\frac{1}{k}=O(n \\log n) \\end{aligned} $$–ü–æ—Å–ª–µ–¥–Ω–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–µ–¥—É—é—â–∏–º —Å–ø–æ—Å–æ–±–æ–º:\n$$ \\begin{gathered} \\sum_{k=1}^{n} \\frac{1}{k}=\\frac{1}{1}+\\left(\\frac{1}{2}+\\frac{1}{3}\\right)+\\left(\\frac{1}{4}+\\frac{1}{5}+\\frac{1}{6}+\\frac{1}{7}\\right)+\\cdots\u003c \\\\ \u003c \\\\ \\frac{1}{1}+\\left(\\frac{1}{2}+\\frac{1}{2}\\right)+\\left(\\frac{1}{4}+\\frac{1}{4}+\\frac{1}{4}+\\frac{1}{4}\\right)+\\cdots \\leqslant\\left\\lfloor\\log _{2} n\\right\\rfloor+1 . \\end{gathered} $$ ‚úçÔ∏è –û—Ç—Å—é–¥–∞ —Å–ª–µ–¥—É–µ—Ç –∏ –±–æ–ª–µ–µ —Å–∏–ª—å–Ω–æ–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –µ—Å—Ç—å $O(n \\log n)$ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é, –±–ª–∏–∑–∫–æ–π –≤ –µ–¥–∏–Ω–∏—Ü–µ. –≠—Ç–æ —Å–ª–µ–¥—É–µ—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è, –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –∫–∞–∫ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ –ú–∞—Ä–∫–æ–≤–∞: –¥–ª—è –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã $X$ —Å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–∂–∏–¥–∞–Ω–∏–µ–º $\\mathbb{E}(X)$ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ $X\u003ek \\cdot \\mathbb{E}(X)$, –Ω–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç $\\frac{1}{k}$. –≠—Ç–æ –≤–µ—Ä–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ $X$ –æ–∫–∞–∑–∞–ª–æ—Å—å –±—ã –±–æ–ª—å—à–µ $\\frac{1}{k} \\cdot k \\cdot \\mathbb{E}(X)=\\mathbb{E}(X)$. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è $k=100$ –ø–æ–ª—É—á–∞–µ–º, —á—Ç–æ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é $99 \\%$ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –Ω–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç $O(100 \\cdot n \\log n)=O(n \\log n)$.\n–í–∑—è—Ç–∏–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ–¥–ª–µ–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è, –ø–æ—ç—Ç–æ–º—É –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –≤–º–µ—Å—Ç–æ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —á–∞—Å—Ç–æ –±–µ—Ä—É—Ç –∫–∞–∫–æ–π-—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π, –Ω–∞–ø—Ä–∏–º–µ—Ä —Å–∞–º—ã–π –ª–µ–≤—ã–π, —Å–∞–º—ã–π –ø—Ä–∞–≤—ã–π, –∏–ª–∏ —Å—Ä–µ–¥–Ω–∏–π; —Ç–∞–∫–∂–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ä–µ–¥–Ω–∏–π –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é –∏–∑ —ç—Ç–∏—Ö —Ç—Ä—ë—Ö. –î–ª—è –ø–æ–¥–æ–±–Ω—ã—Ö –≤–µ—Ä—Å–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Å—Å–∏–≤, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞ $\\Theta\\left(n^{2}\\right)$. –° —ç—Ç–∏–º –±–æ—Ä—é—Ç—Å—è —Ä–∞–∑–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –≥–ª—É–±–∏–Ω–∞ —Ä–µ–∫—É—Ä—Å–∏–∏ –ø—Ä–µ–≤—ã—à–∞–µ—Ç $\\log n$, –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç—Å—è –Ω–∞ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å –¥—Ä—É–≥–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏.\n–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –∞–ª–≥–æ—Ä–∏—Ç–º –±—ã—Å—Ç—Ä–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ —Å–∞–º—ã—Ö –±—ã—Å—Ç—Ä—ã—Ö –∏ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö. –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –≤ C++ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ - std::sort, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º Introsort, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—á–∏–Ω–∞–µ—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º –±—ã—Å—Ç—Ä–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, –Ω–∞ –±–æ–ª—å—à–æ–π –≥–ª—É–±–∏–Ω–µ —Ä–µ–∫—É—Ä—Å–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ heapsort (–∫–æ—Ç–æ—Ä—ã–π –º—ã —Å–∫–æ—Ä–æ –∏–∑—É—á–∏–º), –∞ –º–∞—Å—Å–∏–≤—ã —Å–æ–≤—Å–µ–º –Ω–µ–±–æ–ª—å—à–æ–π –¥–ª–∏–Ω—ã —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –≤—Å—Ç–∞–≤–∫–∞–º–∏.\n–ü–æ–∏—Å–∫ $k$-–π –ø–æ—Ä—è–¥–∫–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ $k$-—è –ø–æ—Ä—è–¥–∫–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞ –º–∞—Å—Å–∏–≤–µ –∏–∑ $n$ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ - —ç—Ç–æ $k$-–π –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —ç–ª–µ–º–µ–Ω—Ç. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ $k=1$ —ç—Ç–æ –º–∏–Ω–∏–º—É–º, –ø—Ä–∏ $k=n$ - –º–∞–∫—Å–∏–º—É–º. –ú–µ–¥–∏–∞–Ω–∞ - —ç—Ç–æ —ç–ª–µ–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–∫–∞–∑–∞–ª—Å—è –±—ã –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –º–∞—Å—Å–∏–≤–∞, –µ—Å–ª–∏ –±—ã –µ–≥–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏. –ï—Å–ª–∏ –¥–ª–∏–Ω–∞ –º–∞—Å—Å–∏–≤–∞ —á—ë—Ç–Ω–∞, —Ç–æ –≤ –Ω—ë–º –µ—Å—Ç—å –¥–≤–µ –º–µ–¥–∏–∞–Ω—ã –Ω–∞ –ø–æ–∑–∏—Ü–∏—è—Ö $\\left\\lfloor\\frac{n+1}{2}\\right\\rfloor$ –∏ $\\left\\lceil\\frac{n+1}{2}\\right\\rceil$. –î–ª—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏ –ø–æ–¥ –º–µ–¥–∏–∞–Ω–æ–π –±—É–¥–µ–º –∏–º–µ—Ç—å –≤ –≤–∏–¥—É $\\left\\lfloor\\frac{n+1}{2}\\right\\rfloor$-—é –ø–æ—Ä—è–¥–∫–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.\n–ú–∏–Ω–∏–º—É–º –∏ –º–∞–∫—Å–∏–º—É–º –≤ –º–∞—Å—Å–∏–≤–µ –æ—á–µ–Ω—å –ª–µ–≥–∫–æ –∏—â–µ—Ç—Å—è –∑–∞ $O(n)$ –æ–¥–Ω–∏–º –ø—Ä–æ—Ö–æ–¥–æ–º –ø–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º –º–∞—Å—Å–∏–≤–∞. $k$-–π –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —ç–ª–µ–º–µ–Ω—Ç —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ —É–∂–µ –Ω–µ –Ω–∞–π—Ç–∏.\n–ú–æ–∂–Ω–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ –∑–∞ $O(n \\log n)$, —Ç–æ–≥–¥–∞ $k$-—è –ø–æ—Ä—è–¥–∫–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–∫–∞–∂–µ—Ç—Å—è –Ω–∞ $k$-–π –ø–æ–∑–∏—Ü–∏–∏ (–µ—Å–ª–∏ –Ω—É–º–µ—Ä–æ–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Å—Å–∏–≤–∞, –Ω–∞—á–∏–Ω–∞—è —Å –µ–¥–∏–Ω–∏—Ü—ã). –û–¥–Ω–∞–∫–æ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã, –Ω–∞—Ö–æ–¥—è—â–∏–µ $k$-—é –ø–æ—Ä—è–¥–∫–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ $k$ –∑–∞ $O(n)$.\n–í–µ—Ä–Ω—ë–º—Å—è –∫ –∞–ª–≥–æ—Ä–∏—Ç–º—É –±—ã—Å—Ç—Ä–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏. –ö–æ–≥–¥–∞ –º—ã –ø–æ–¥–µ–ª–∏–ª–∏ –º–∞—Å—Å–∏–≤ –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏, –º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –≤ –∫–∞–∫–æ–π –∏–∑ —ç—Ç–∏—Ö —á–∞—Å—Ç–µ–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è $k$-–π –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —ç–ª–µ–º–µ–Ω—Ç: –µ—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –ª–µ–≤–æ–π —á–∞—Å—Ç–∏ —Ö–æ—Ç—è –±—ã $k$, —Ç–æ –æ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –Ω–µ–π, –∏–Ω–∞—á–µ –æ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏. –¢–æ–≥–¥–∞, –µ—Å–ª–∏ –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –Ω–µ –≤–µ—Å—å –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤, –∞ —Ç–æ–ª—å–∫–æ $k$-–π –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —ç–ª–µ–º–µ–Ω—Ç, –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –æ—Ç —Ç–æ–π —á–∞—Å—Ç–∏, –≤ –∫–æ—Ç–æ—Ä–æ–π –æ–Ω –ª–µ–∂–∏—Ç. ‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 12 13 def kthElement(a, l, r, k): \"\"\" –ù–∞—Ö–æ–¥–∏—Ç k-—é –ø–æ—Ä—è–¥–∫–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ a[l, r] \"\"\" if l == r: return a[l] m = partition(a, l, r) if m - l + 1 \u003e= k: return kthElement(a, l, m, k) else: return kthElement(a, m + 1, r, k - (m - l + 1)) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 #include \u003cvector\u003e // –ù–∞—Ö–æ–¥–∏—Ç k-—é –ø–æ—Ä—è–¥–∫–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ a[l, r] int kthElement(std::vector\u003cint\u003e\u0026 a, int l, int r, int k) { if (l == r) { return a[l]; } int m = partition(a, l, r); if (m - l + 1 \u003e= k) { return kthElement(a, l, m, k); } else { return kthElement(a, m + 1, r, k - (m - l + 1)); } } –í —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ —Ç–∞–∫–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –∑–∞ $\\Theta\\left(n^{2}\\right)$. –û–¥–Ω–∞–∫–æ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ –æ—Ü–µ–Ω–∫–∞ —Å—Ä–µ–¥–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ —Ç–∞–∫–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —É–ª—É—á—à–∞–µ—Ç—Å—è —Å $O(n \\log n)$ –¥–æ $O(n)$.\n–¢–µ–æ—Ä–µ–º–∞ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ kthElement –µ—Å—Ç—å $O(n)$. –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –ú—ã –¥–æ–∫–∞–∂–µ–º —Ç–µ–æ—Ä–µ–º—É –≤ —Å–ª—É—á–∞–µ, –∫–æ–≥–¥–∞ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Å—Å–∏–≤–∞ –ø–æ–ø–∞—Ä–Ω–æ —Ä–∞–∑–ª–∏—á–Ω—ã.\n–ë—É–¥–µ–º –≥–æ–≤–æ—Ä–∏—Ç—å, —á—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ $j$-–π —Ñ–∞–∑–µ, –µ—Å–ª–∏ —Ä–∞–∑–º–µ—Ä —Ç–µ–∫—É—â–µ–≥–æ –æ—Ç—Ä–µ–∑–∫–∞ –º–∞—Å—Å–∏–≤–∞ –Ω–µ –±–æ–ª—å—à–µ $\\left(\\frac{3}{4}\\right)^{j} n$, –Ω–æ —Å—Ç—Ä–æ–≥–æ –±–æ–ª—å—à–µ $\\left(\\frac{3}{4}\\right)^{j+1} n$. –û—Ü–µ–Ω–∏–º –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≤ –∫–∞–∂–¥–æ–π —Ñ–∞–∑–µ –æ—Ç–¥–µ–ª—å–Ω–æ.\n–ù–∞–∑–æ–≤—ë–º —ç–ª–µ–º–µ–Ω—Ç —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º, –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã —á–µ—Ç–≤–µ—Ä—Ç—å —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Ç–µ–∫—É—â–µ–º –æ—Ç—Ä–µ–∑–∫–µ –º–∞—Å—Å–∏–≤–∞ –º–µ–Ω—å—à–µ –µ–≥–æ, –∏ —Ö–æ—Ç—è –±—ã —á–µ—Ç–≤–µ—Ä—Ç—å –±–æ–ª—å—à–µ. –ï—Å–ª–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è $x$ –±—ã–ª –≤—ã–±—Ä–∞–Ω —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç, —Ç–æ —Ä–∞–∑–º–µ—Ä –æ—Ç—Ä–µ–∑–∫–∞, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫, –±—É–¥–µ—Ç –Ω–µ –±–æ–ª—å—à–µ $\\frac{3}{4}$ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–∫—É—â–µ–≥–æ –æ—Ç—Ä–µ–∑–∫–∞, —Ç–æ –µ—Å—Ç—å —Ç–µ–∫—É—â–∞—è —Ñ–∞–∑–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ç–æ—á–Ω–æ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è. –ü—Ä–∏ —ç—Ç–æ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–±—Ä–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —Ä–∞–≤–Ω–∞ $\\frac{1}{2}$ (—Ç–∞–∫ –∫–∞–∫ —Ä–æ–≤–Ω–æ –ø–æ–ª–æ–≤–∏–Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –æ—Ç—Ä–µ–∑–∫–∞ —è–≤–ª—è—é—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º–∏). –¢–æ–≥–¥–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤, —Å–¥–µ–ª–∞–Ω–Ω—ã—Ö –≤ —Ç–µ—á–µ–Ω–∏–µ $j$-–π —Ñ–∞–∑—ã, –Ω–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç\n$$ 1+\\frac{1}{2}\\left(1+\\frac{1}{2}(1+\\cdots)\\right)=1+\\frac{1}{2}+\\frac{1}{4}+\\cdots=2 . $$–ü—Ä–∏ —ç—Ç–æ–º –∫–∞–∂–¥–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –Ω–∞ $j$-–π —Ñ–∞–∑–µ —Å–æ–≤–µ—Ä—à–∞–µ—Ç $O\\left(\\left(\\frac{3}{4}\\right)^{j} n\\right)$ –¥–µ–π—Å—Ç–≤–∏–π. –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ä–∞–≤–Ω—è–µ—Ç—Å—è —Å—É–º–º–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–∂–∏–¥–∞–Ω–∏–π –≤—Ä–µ–º—ë–Ω —Ä–∞–±–æ—Ç—ã –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç\n$$ \\sum_{j} O\\left(\\left(\\frac{3}{4}\\right)^{j} n\\right) \\cdot 2=O\\left(n \\cdot \\sum_{j}\\left(\\frac{3}{4}\\right)^{j}\\right)=O\\left(n \\cdot \\frac{1}{1-3 / 4}\\right)=O(n) $$ –í C++ –µ—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —ç—Ç–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ - std::nth_element.\n‚úçÔ∏è –ê–ª–≥–æ—Ä–∏—Ç–º –º–æ–∂–Ω–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω —Ä–∞–±–æ—Ç–∞–ª –∑–∞ $O(n)$ –≤ —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —Ç–∞–∫: –ø–æ–¥–µ–ª–∏–º –º–∞—Å—Å–∏–≤ –Ω–∞ $n / 5$ –≥—Ä—É–ø–ø –ø–æ 5 —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –≤ –∫–∞–∂–¥–æ–π –∑–∞ $O(1)$ –Ω–∞–π–¥—ë–º –º–µ–¥–∏–∞–Ω—É. –¢–µ–ø–µ—Ä—å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –Ω–∞–π–¥—ë–º –º–µ–¥–∏–∞–Ω—É —Å—Ä–µ–¥–∏ —ç—Ç–∏—Ö –º–µ–¥–∏–∞–Ω, –∏ —É–∂–µ –µ—ë –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è. –¢–æ–≥–¥–∞ –≤ –ø–æ–ª–æ–≤–∏–Ω–µ –≥—Ä—É–ø–ø —Ö–æ—Ç—è –±—ã 3 —ç–ª–µ–º–µ–Ω—Ç–∞ –æ–∫–∞–∂—É—Ç—Å—è –º–µ–Ω—å—à–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è, –∞ –≤ –¥—Ä—É–≥–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ —Ö–æ—Ç—è –±—ã 3 —ç–ª–µ–º–µ–Ω—Ç–∞ –æ–∫–∞–∂—É—Ç—Å—è –±–æ–ª—å—à–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è. –ó–Ω–∞—á–∏—Ç –∫–∞–∂–¥–∞—è –∏–∑ —á–∞—Å—Ç–µ–π, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–µ–ª–∏–ª—Å—è –º–∞—Å—Å–∏–≤, –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Ä–∞–∑–º–µ—Ä —Ö–æ—Ç—è –±—ã $3 n / 10$. –ü–æ–ª—É—á–∞–µ–º –≤ —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ $T(n)=\\Theta(n)+T(n / 5)+T(7 n / 10)$. –ú–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –≤–µ—Ä–Ω–æ $T(n)=\\Theta(n)$.\n–û—Ü–µ–Ω–∫–∞ —Å–Ω–∏–∑—É –Ω–∞ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è–º–∏ –ê–ª–≥–æ—Ä–∏—Ç–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è–º–∏ –º–æ–∂–µ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ –æ–±—ä–µ–∫—Ç—ã –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –∏—Ö –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º, –Ω–æ –Ω–∏–∫–∞–∫ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ–±—ä–µ–∫—Ç–æ–≤. –í—Å–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, –∏–∑—É—á–µ–Ω–Ω—ã–µ –Ω–∞–º–∏ –¥–æ —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞, —è–≤–ª—è—é—Ç—Å—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞–º–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è. –ú–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –Ω–∏–∫–∞–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è–º–∏ –Ω–µ –º–æ–∂–µ—Ç –≤ –æ–±—â–µ–º —Å–ª—É—á–∞–µ —Ä–∞–±–æ—Ç–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –∑–∞ $\\Theta(n \\log n)$.\n–¢–µ–æ—Ä–µ–º–∞ –õ—é–±–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è–º–∏ –∏–º–µ–µ—Ç –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã $\\Omega(n \\log n)$ –≤ —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ. –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –ê–ª–≥–æ—Ä–∏—Ç–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è–º–∏ –¥–æ–ª–∂–µ–Ω —É–º–µ—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ª—é–±—É—é –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫—É —á–∏—Å–µ–ª –æ—Ç 1 –¥–æ $n$. –ü—É—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–∞ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–µ –¥–µ–ª–∞–µ—Ç –Ω–µ –±–æ–ª–µ–µ $k$ —Å—Ä–∞–≤–Ω–µ–Ω–∏–π. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –µ—Å–ª–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å–µ—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏–π –≤ —Ö–æ–¥–µ —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞, —Ç–æ –æ–Ω –±—É–¥–µ—Ç –≤—ã–¥–∞–≤–∞—Ç—å –≤—Å–µ–≥–¥–∞ –æ–¥–Ω—É –∏ —Ç—É –∂–µ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫—É –¥–∞–Ω–Ω–æ–≥–æ –Ω–∞ –≤—Ö–æ–¥ –º–∞—Å—Å–∏–≤–∞.\n‚úçÔ∏è –≠—Ç–æ –Ω–µ —Å–æ–≤—Å–µ–º –≤–µ—Ä–Ω–æ –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö —Å–ª—É—á–∞–π–Ω—ã–µ —á–∏—Å–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –±—ã—Å—Ç—Ä–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏), –ø–æ—Å–∫–æ–ª—å–∫—É —Å–∞–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å—Ä–∞–≤–Ω–µ–Ω–∏–π –º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫–∏–µ —Å–ª—É—á–∞–π–Ω—ã–µ —á–∏—Å–ª–∞ –≤—ã–ø–∞–ª–∏. –û–¥–Ω–∞–∫–æ —ç—Ç–æ –≤–µ—Ä–Ω–æ, –µ—Å–ª–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª, –∫–æ—Ç–æ—Ä—É—é –ø–æ–ª—É—á–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º. –ü–æ—Å–∫–æ–ª—å–∫—É –∞–ª–≥–æ—Ä–∏—Ç–º –¥–æ–ª–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –ª—é–±–æ–π –¥–∞–Ω–Ω–æ–π –µ–º—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª, –¥–∞–ª—å–Ω–µ–π—à–∏–µ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è –æ—Å—Ç–∞—é—Ç—Å—è –≤–µ—Ä–Ω—ã.\n–ü–æ—Å–∫–æ–ª—å–∫—É –∞–ª–≥–æ—Ä–∏—Ç–º –¥–µ–ª–∞–µ—Ç –Ω–µ –±–æ–ª–µ–µ $k$ —Å—Ä–∞–≤–Ω–µ–Ω–∏–π, –∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤ –Ω–µ –±—ã–≤–∞–µ—Ç (–ø–æ—Å–∫–æ–ª—å–∫—É –º—ã —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏), —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ –±–æ–ª–µ–µ $2^{k}$ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫ –¥–∞–Ω–Ω–æ–≥–æ –Ω–∞ –≤—Ö–æ–¥ –º–∞—Å—Å–∏–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –º–æ–∂–µ—Ç –≤—ã–¥–∞—Ç—å. –ü–æ—Å–∫–æ–ª—å–∫—É –∞–ª–≥–æ—Ä–∏—Ç–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—É—é –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫—É, –ø–æ–ª—É—á–∞–µ–º $2^{k} \\geqslant n!$. –¢–æ–≥–¥–∞\n$$ k \\geqslant \\log (n!) \\geqslant \\log \\left(\\left(\\frac{n}{2}\\right)^{n / 2}\\right)=\\frac{n}{2} \\log \\frac{n}{2}=\\Omega(n \\log n) $$ –¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, –µ—Å–ª–∏ –æ–±–ª–∞–¥–∞—Ç—å –∫–∞–∫–æ–π-—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–≤–æ–π—Å—Ç–≤–∞—Ö —Å–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤, –∏–Ω–æ–≥–¥–∞ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —ç—Ç–∏–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏, —á—Ç–æ–±—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –∑–∞ $\\Theta(n \\log n)$.\n–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ–¥—Å—á—ë—Ç–æ–º –ï—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –≤—Å–µ —á–∏—Å–ª–∞ –≤–æ –≤—Ö–æ–¥–Ω–æ–º –º–∞—Å—Å–∏–≤–µ —Ü–µ–ª—ã–µ, –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∏ –º–µ–Ω—å—à–µ –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ $k$, —Ç–æ –∏—Ö –º–æ–∂–Ω–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞ $\\Theta(n+k)$ (–ø—Ä–∏ —ç—Ç–æ–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è $\\Theta(k)$ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏). –î–ª—è —ç—Ç–æ–≥–æ –ø–æ—Å—á–∏—Ç–∞–µ–º, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤—Å—Ç—Ä–µ—Ç–∏–ª–æ—Å—å –∫–∞–∂–¥–æ–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ $k$, –ø–æ—Å–ª–µ —á–µ–≥–æ –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–∏—à–µ–º –∫–∞–∂–¥–æ–µ —á–∏—Å–ª–æ –≤ –æ—Ç–≤–µ—Ç —Å—Ç–æ–ª—å–∫–æ —Ä–∞–∑, —Å–∫–æ–ª—å–∫–æ –æ–Ω –≤—Å—Ç—Ä–µ—á–∞–ª–æ—Å—å –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –º–∞—Å—Å–∏–≤–µ. ‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 12 13 def counting_sort(a, n, k): c = [0] * k for i in range(n): c[a[i]] += 1 p = 0 for i in range(k): for j in range(c[i]): a[p] = i p += 1 return a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 #include \u003cvector\u003e void countingSort(int a[], int n, int k) { std::vector\u003cint\u003e c(k, 0); for (int i = 0; i \u003c n; i++) { c[a[i]]++; } int p = 0; for (int i = 0; i \u003c k; i++) { for (int j = 0; j \u003c c[i]; j++) { a[p] = i; p++; } } } –Ø—Å–Ω–æ, —á—Ç–æ —Ç–∞–∫–∏–º –∂–µ –æ–±—Ä–∞–∑–æ–º –º–æ–∂–Ω–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞, –ª–µ–∂–∞—â–∏–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ $[L, R)$, –∑–∞ $\\Theta(n+(R-L))$.\n–ï—Å–ª–∏ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –µ—â—ë –æ–¥–Ω–∏–º –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–º –º–∞—Å—Å–∏–≤–æ–º, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ–π: ‚Äã python cpp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 def counting_sort(a, n, k): # –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ c —Ä–∞–∑–º–µ—Ä–∞ k –∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –Ω—É–ª—è–º–∏ c = [0] * k # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ for i in range(n): c[a[i]] += 1 # –í—ã—á–∏—Å–ª—è–µ–º –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ —Å—É–º–º—ã for i in range(1, k): c[i] += c[i - 1] # —Ç–µ–ø–µ—Ä—å —Å[i] - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Å—Å–∏–≤–∞, –Ω–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è—â–∏—Ö i # –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ b b = [0] * n # –ó–∞–ø–æ–ª–Ω—è–µ–º –º–∞—Å—Å–∏–≤ b –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ for i in range(n - 1, -1, -1): c[a[i]] -= 1 b[c[a[i]]] = a[i] # –ö–æ–ø–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ –∏—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤ for i in range(n): a[i] = b[i] return a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 #include \u003cvector\u003e void countingSort(int a[], int n, int k) { // –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ c —Ä–∞–∑–º–µ—Ä–∞ k –∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –Ω—É–ª—è–º–∏ int* c = new int[k]; for (int i = 0; i \u003c k; i++) { c[i] = 0; } // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ for (int i = 0; i \u003c n; i++) { c[a[i]]++; } // –í—ã—á–∏—Å–ª—è–µ–º –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ —Å—É–º–º—ã for (int i = 1; i \u003c k; i++) { c[i] += c[i - 1]; } // —Ç–µ–ø–µ—Ä—å —Å[i] - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Å—Å–∏–≤–∞, –Ω–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è—â–∏—Ö i // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ b int* b = new int[n]; // –ó–∞–ø–æ–ª–Ω—è–µ–º –º–∞—Å—Å–∏–≤ b –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ for (int i = n - 1; i \u003e= 0; i--) { c[a[i]]--; b[c[a[i]]] = a[i]; } // –ö–æ–ø–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ –∏—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤ for (int i = 0; i \u003c n; i++) { a[i] = b[i]; } // –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–Ω—É—é –ø–∞–º—è—Ç—å delete[] c; delete[] b; } –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ–¥—Å—á—ë—Ç–æ–º –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –Ω–∞–º –≤ —Å–ª–µ–¥—É—é—â–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏.\n–ü–æ—Ä–∞–∑—Ä—è–¥–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (Radix sort) –ü—É—Å—Ç—å –¥–∞–Ω –º–∞—Å—Å–∏–≤ –∏–∑ $n$ —á–∏—Å–µ–ª, –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –≤ $k$-–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ —Å—á–∏—Å–ª–µ–Ω–∏—è –∏ –∏–º–µ—é—â–∏—Ö –Ω–µ –±–æ–ª–µ–µ $d$ —Ä–∞–∑—Ä—è–¥–æ–≤ –∫–∞–∂–¥–æ–µ. –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º —á–∏—Å–ª–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –ø–æ–¥—Å—á—ë—Ç–æ–º $d$ —Ä–∞–∑ - —Å–Ω–∞—á–∞–ª–∞ –ø–æ –º–ª–∞–¥—à–µ–º—É —Ä–∞–∑—Ä—è–¥—É, –ø–æ—Ç–æ–º –ø–æ —Å–ª–µ–¥—É—é—â–µ–º—É, –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ, –≤ –∫–æ–Ω—Ü–µ - –ø–æ —Å—Ç–∞—Ä—à–µ–º—É —Ä–∞–∑—Ä—è–¥—É. –ü—Ä–∏ —ç—Ç–æ–º –±—É–¥–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ–¥—Å—á—ë—Ç–æ–º.\n–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —à–∞–≥–∞ —á–∏—Å–ª–∞ –±—É–¥—É—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ 0-–º—É —Ä–∞–∑—Ä—è–¥—É, –ø–æ—Å–ª–µ –≤—Ç–æ—Ä–æ–≥–æ –ø–æ 1-–º—É —Ä–∞–∑—Ä—è–¥—É, –∞ –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ —Ü–∏—Ñ—Ä –≤ 1-–º —Ä–∞–∑—Ä—è–¥–µ - –ø–æ 0-–º—É. –í –∫–æ–Ω—Ü–µ —á–∏—Å–ª–∞ –±—É–¥—É—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ $(d-1)$-–º—É —Ä–∞–∑—Ä—è–¥—É, –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ —Ü–∏—Ñ—Ä –≤ $(d-1)$-–º —Ä–∞–∑—Ä—è–¥–µ - –ø–æ ( $d-2)$-–º—É,‚Ä¶, –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ —Ü–∏—Ñ—Ä –≤–æ –≤—Å–µ—Ö —Ä–∞–∑—Ä—è–¥–∞—Ö, –∫—Ä–æ–º–µ 0-–≥–æ - –ø–æ 0-–º—É. –ó–Ω–∞—á–∏—Ç —á–∏—Å–ª–∞ –ø—Ä–æ—Å—Ç–æ –æ–∫–∞–∂—É—Ç—Å—è –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è. ‚Äã python cpp 1 2 3 4 5 6 def radixSort(a, n, d): # –ü–æ—Ä–∞–∑—Ä—è–¥–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ # d - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑—Ä—è–¥–æ–≤ –≤ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º —á–∏—Å–ª–µ for i in range(d): counting_sort(a, n, i) # —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ–¥—Å—á—ë—Ç–æ–º –ø–æ i-–º—É —Ä–∞–∑—Ä—è–¥—É 1 2 3 4 5 6 7 8 void radixSort(int a[], int n, int d) { // –ü–æ—Ä–∞–∑—Ä—è–¥–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ // d - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑—Ä—è–¥–æ–≤ –≤ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º —á–∏—Å–ª–µ for (int i = 0; i \u003c d; i++) { countingSort(a, n, i); // —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ–¥—Å—á—ë—Ç–æ–º –ø–æ i-–º—É —Ä–∞–∑—Ä—è–¥—É } } –ö–∞–∂–¥—ã–π —à–∞–≥ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ $\\Theta(n+k)$, —Ç–æ–≥–¥–∞ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –≤—Å–µ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ $\\Theta(d(n+k))$. –ü–æ—Ä–∞–∑—Ä—è–¥–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π.\n–° –ø–æ–º–æ—â—å—é –ø–æ—Ä–∞–∑—Ä—è–¥–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –º–æ–∂–Ω–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ª—é–±—ã–µ –æ–±—ä–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —É–ø–æ—Ä—è–¥–æ—á–∏—Ç—å. –¢–∞–∫, –º–æ–∂–Ω–æ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å $n$ —Å—Ç—Ä–æ–∫ –¥–ª–∏–Ω—ã $d$ –∫–∞–∂–¥–∞—è, –≤ –∑–∞–ø–∏—Å–∏ –∫–æ—Ç–æ—Ä—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è $k$ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤, –∑–∞ $\\Theta(d(n+k))$.\n–ü—É—Å—Ç—å –Ω–∞–º –¥–∞–Ω—ã $n$ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª, –º–µ–Ω—å—à–∏—Ö $m$. –ï—Å–ª–∏ –º—ã –ø–µ—Ä–µ–≤–µ–¥—ë–º –∏—Ö –≤ $k$-–∏—á–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Å—á–∏—Å–ª–µ–Ω–∏—è, —Ç–æ —Å–º–æ–∂–µ–º –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –ø–æ—Ä–∞–∑—Ä—è–¥–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –∑–∞ $\\Theta\\left(\\left(1+\\log _{k} m\\right)(n+k)\\right)$ (–∏—Å–ø–æ–ª—å–∑—É—è $\\Theta\\left(n\\left(1+\\log _{k} m\\right)+k\\right)$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏). –ü—Ä–∏ $n=k$ –ø–æ–ª—É—á–∞–µ–º –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã $\\left.\\Theta\\left(n+n \\log _{n} m\\right)\\right)=\\Theta\\left(n+n \\frac{\\log m}{\\log n}\\right)$.",
    "description": "–ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –°—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, —Å–æ—Ä—Ç–∏—Ä—É—é—â–∏—Ö –º–∞—Å—Å–∏–≤ –¥–ª–∏–Ω—ã $n$ –∑–∞ $\\Theta\\left(n^{2}\\right)$. –ú—ã –ø–æ–≥–æ–≤–æ—Ä–∏–º –ª–∏—à—å –æ –¥–≤—É—Ö –∏–∑ –Ω–∏—Ö.\n–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤—ã–±–æ—Ä–æ–º –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤—ã–±–æ—Ä–æ–º (selection sort) –Ω–∞ $i$-–º —à–∞–≥–µ –Ω–∞—Ö–æ–¥–∏—Ç $i$-–π –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —ç–ª–µ–º–µ–Ω—Ç –∏ —Å—Ç–∞–≤–∏—Ç –µ–≥–æ –Ω–∞ $i$-—é –ø–æ–∑–∏—Ü–∏—é. –ü–æ—Å–∫–æ–ª—å–∫—É –ø–µ—Ä–≤—ã–µ $i-1$ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç —É–∂–µ —Å—Ç–æ—è—Ç –Ω–∞ —Å–≤–æ–∏—Ö –ø–æ–∑–∏—Ü–∏—è—Ö, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ –Ω–∞–π—Ç–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–µ $[i, n)$. ‚Äã python cpp 1 2 3 4 5 6 7 8 9 def selection_sort(arr): n = len(arr) for i in range(n): min_pos = i for j in range(i + 1, n): if arr[min_pos] \u003e arr[j]: min_pos = j arr[i], arr[min_pos] = arr[min_pos], arr[i] return arr 1 2 3 4 5 6 7 8 9 10 11 12 void selectionSort(std::vector\u003cint\u003e\u0026 arr) { int n = arr.size(); for (int i = 0; i \u003c n; i++) { int minPos = i; for (int j = i + 1; j \u003c n; j++) { if (arr[minPos] \u003e arr[j]) { minPos = j; } } std::swap(arr[i], arr[minPos]); } }",
    "tags": [],
    "title": "6. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏",
    "uri": "/basics/sorts/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.¬†\u003e¬†17. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ",
    "content": "–ü—É—Å—Ç—å –º—ã —Ö–æ—Ç–∏–º –≤—ã—á–∏—Å–ª–∏—Ç—å –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ $n$ –º–∞—Ç—Ä–∏—Ü $A_{1} \\times \\cdots \\times A_{n}$; –º–∞—Ç—Ä–∏—Ü–∞ $A_{i}$ –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä $m_{i-1} \\times m_{i}$. –°–∞–º–∏ —É–º–Ω–æ–∂–µ–Ω–∏—è –º—ã –±—É–¥–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å, –ø–æ–ª—å–∑—É—è—Å—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü, —Ç–æ –µ—Å—Ç—å –Ω–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü —Ä–∞–∑–º–µ—Ä–æ–≤ $m \\times n$ –∏ $n \\times p$ –º—ã –ø–æ—Ç—Ä–∞—Ç–∏–º $O(m n p)$ –¥–µ–π—Å—Ç–≤–∏–π. –û–¥–Ω–∞–∫–æ –º—ã –≤–æ–ª—å–Ω—ã –≤—ã–±–∏—Ä–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å —É–º–Ω–æ–∂–µ–Ω–∏—è (—Ç–æ –µ—Å—Ç—å —Ä–∞—Å—Å—Ç–∞–≤–ª—è—Ç—å —Å–∫–æ–±–∫–∏ –≤ –≤—ã—Ä–∞–∂–µ–Ω–∏–∏ –≤—ã—à–µ). –•–æ—á–µ—Ç—Å—è –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—É–º–º–∞—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–¥—ë—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã –≤—ã—á–∏—Å–ª–∏—Ç—å –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤—Å–µ—Ö –º–∞—Ç—Ä–∏—Ü.\n–ü—É—Å—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –º—ã –ø–µ—Ä–µ–º–Ω–æ–∂–∞–µ–º –º–∞—Ç—Ä–∏—Ü—ã —Ä–∞–∑–º–µ—Ä–æ–≤ $100 \\times 10$, $10 \\times 20$ –∏ $20 \\times 2$. –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤ –ø–æ—Ä—è–¥–∫–µ $\\left(A_{1} \\times A_{2}\\right) \\times A_{3}$, —Ç–æ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —Å–æ–≤–µ—Ä—à–∏—Ç—å $100 \\cdot 10 \\cdot 20+100 \\cdot 20 \\cdot 2=24000$ –¥–µ–π—Å—Ç–≤–∏–π; –µ—Å–ª–∏ –∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ $A_{1} \\times\\left(A_{2} \\times A_{3}\\right)$, –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –≤—Å–µ–≥–æ $10 \\cdot 20 \\cdot 2+100 \\cdot 10 \\cdot 2=2400$ –¥–µ–π—Å—Ç–≤–∏–π.\n–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞–º –ö–∞–∫ —Ä–µ—à–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É –º–µ—Ç–æ–¥–æ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è? –ü–æ–ø—Ä–æ–±—É–µ–º —Å–≤–µ—Å—Ç–∏ –∑–∞–¥–∞—á—É –∫ –ø–æ–¥–∑–∞–¥–∞—á–∞–º –ø–æ–ø—Ä–æ—â–µ. –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –æ–ø–µ—Ä–∞—Ü–∏—é —É–º–Ω–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—É—é –º—ã –ø—Ä–æ–≤–µ–¥—ë–º: –º—ã –ø–µ—Ä–µ–º–Ω–æ–∂–∏–º –º–∞—Ç—Ä–∏—Ü—ã $A_{1} \\times \\cdots \\times A_{j}$ –∏ $A_{j+1} \\times \\cdots \\times A_{n}$ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ $j$. –û–ø–µ—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Å–¥–µ–ª–∞–ª–∏ –¥–æ —ç—Ç–æ–≥–æ, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–º—É –≤—ã—á–∏—Å–ª–µ–Ω–∏—é —ç—Ç–∏—Ö –¥–≤—É—Ö –º–∞—Ç—Ä–∏—Ü: –ø–æ–ª—É—á–∏–ª–∏—Å—å –¥–≤–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –ø–æ–¥–∑–∞–¥–∞—á–∏.\n–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–∞ —ç—Ç–æ—Ç —Ä–∞–∑ —Å–æ–æ—Ç–≤–µ—Å—Ç–≤—É—é—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–µ—Ñ–∏–∫—Å–∞–º (–∫–∞–∫ –≤–æ –º–Ω–æ–≥–∏—Ö —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Ä–∞–Ω–µ–µ –∑–∞–¥–∞—á–∞—Ö), –Ω–æ –∏ —Å—É—Ñ—Ñ–∏–∫—Å–∞–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–µ. –ï—Å–ª–∏ –∂–µ –º—ã –ø–æ–ø—ã—Ç–∞–µ–º—Å—è —Å–≤–µ—Å—Ç–∏ –∑–∞–¥–∞—á—É –¥–ª—è –ø—Ä–µ—Ñ–∏–∫—Å–∞ –∏–ª–∏ —Å—É—Ñ—Ñ–∏–∫—Å–∞ –∫ –ø–æ–¥–∑–∞–¥–∞—á–∞–º –ø–æ–ø—Ä–æ—â–µ, —Ç–æ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —Ä–µ—à–∞—Ç—å –ø–æ–¥–∑–∞–¥–∞—á–∏ —É–∂–µ –¥–ª—è –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–æ–≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∏—Å—Ö–æ–¥–Ω–æ–π –∑–∞–¥–∞—á–µ.\n–ò—Ç–∞–∫, –Ω–∞ —ç—Ç–æ—Ç —Ä–∞–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞–º –∏—Å—Ö–æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏. –ü—É—Å—Ç—å $c[l, r]$ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è $A_{l} \\times \\cdots \\times A_{r}$. –ù–∞—á–∞–ª—å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è: $c[i, i]=0$. –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤—ã–ø–∏—Å–∞—Ç—å –ø–µ—Ä–µ—Ö–æ–¥—ã, –ø–µ—Ä–µ–±–µ—Ä—ë–º, –∫–∞–∫—É—é –ø–∞—Ä—É –º–∞—Ç—Ä–∏—Ü –º—ã –±—É–¥–µ–º —É–º–Ω–æ–∂–∞—Ç—å –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ:\n$$ c[l, r]=\\min _{l \\leqslant i \u003c r}(c[l, i]+c[i+1, r]+m[l-1] \\cdot m[i] \\cdot m[r]) . $$–û–¥–∏–Ω –∏–∑ –ø–æ—Ä—è–¥–∫–æ–≤, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ –Ω–∞ –≥—Ä–∞—Ñ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π ‚Äî —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –ø–æ—Ä—è–¥–∫–µ —É–≤–µ–ª–∏—á–µ–Ω–∏—è –¥–ª–∏–Ω—ã –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞.\n–ü–æ–ª—É—á–∏–ª–æ—Å—å —Ä–µ—à–µ–Ω–∏–µ —Å –≤—Ä–µ–º–µ–Ω–µ–º —Ä–∞–±–æ—Ç—ã $O\\left(n^{3}\\right)$, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–µ $O\\left(n^{2}\\right)$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –¥–µ–ª–∞–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏.\n‚úçÔ∏è –≠—Ç—É –∑–∞–¥–∞—á—É —É–º–µ—é—Ç —Ä–µ—à–∞—Ç—å –∑–∞ $O(n \\log n)$ (Hu, Shing, 1984).\n1 2 3 4 5 6 7 8 9 fill(c, inf) for i = 1..n: c[i, i] = 0 for s = 1..n: for l = 1..(n - s): r = l + s # –ø–æ–¥–∑–∞–¥–∞—á–∞ [l, r] for i = l..(r - 1): c[l, r] = min(c[l, r], c[l, i] + c[i + 1,r] + m[l - 1] * m[i] * m[r])",
    "description": "–ü—É—Å—Ç—å –º—ã —Ö–æ—Ç–∏–º –≤—ã—á–∏—Å–ª–∏—Ç—å –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ $n$ –º–∞—Ç—Ä–∏—Ü $A_{1} \\times \\cdots \\times A_{n}$; –º–∞—Ç—Ä–∏—Ü–∞ $A_{i}$ –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä $m_{i-1} \\times m_{i}$. –°–∞–º–∏ —É–º–Ω–æ–∂–µ–Ω–∏—è –º—ã –±—É–¥–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å, –ø–æ–ª—å–∑—É—è—Å—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü, —Ç–æ –µ—Å—Ç—å –Ω–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü —Ä–∞–∑–º–µ—Ä–æ–≤ $m \\times n$ –∏ $n \\times p$ –º—ã –ø–æ—Ç—Ä–∞—Ç–∏–º $O(m n p)$ –¥–µ–π—Å—Ç–≤–∏–π. –û–¥–Ω–∞–∫–æ –º—ã –≤–æ–ª—å–Ω—ã –≤—ã–±–∏—Ä–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å —É–º–Ω–æ–∂–µ–Ω–∏—è (—Ç–æ –µ—Å—Ç—å —Ä–∞—Å—Å—Ç–∞–≤–ª—è—Ç—å —Å–∫–æ–±–∫–∏ –≤ –≤—ã—Ä–∞–∂–µ–Ω–∏–∏ –≤—ã—à–µ). –•–æ—á–µ—Ç—Å—è –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—É–º–º–∞—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–¥—ë—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã –≤—ã—á–∏—Å–ª–∏—Ç—å –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤—Å–µ—Ö –º–∞—Ç—Ä–∏—Ü.",
    "tags": [],
    "title": "–ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü",
    "uri": "/basics/dynamic_programming/matrices_multiplication/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.",
    "content": "–ü—É—Å—Ç—å –º—ã —Ö–æ—Ç–∏–º –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –±—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–∞ –Ω—ë–º —Å–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏: –¥–æ–±–∞–≤–ª—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã, –∞ —Ç–∞–∫–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—å –º–∏–Ω–∏–º—É–º.\n–ú–æ–∂–Ω–æ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ —Å –ø–æ–º–æ—â—å—é –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –∏–ª–∏ —Å–ø–∏—Å–∫–∞. –¢–æ–≥–¥–∞ –º—ã —Å–º–æ–∂–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∑–∞ $O(1)$ (—á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –º–∞—Å—Å–∏–≤–∞, –ø–æ–º–µ–Ω—è–µ–º –µ–≥–æ –º–µ—Å—Ç–∞–º–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º, –ø–æ—Å–ª–µ —á–µ–≥–æ —É–º–µ–Ω—å—à–∏–º –¥–ª–∏–Ω—É –º–∞—Å—Å–∏–≤–∞ –Ω–∞ –æ–¥–∏–Ω). –û–¥–Ω–∞–∫–æ –±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –º–∏–Ω–∏–º—É–º –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è: –º–æ–∂–Ω–æ –ø—ã—Ç–∞—Ç—å—Å—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç, –Ω–æ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –º–∏–Ω–∏–º—É–º–∞ –Ω–æ–≤—ã–π –º–∏–Ω–∏–º—É–º –ø–æ–ª—É—á–∏—Ç—Å—è –Ω–∞–π—Ç–∏ –ª–∏—à—å –ø–µ—Ä–µ–±–æ—Ä–æ–º –≤—Å–µ—Ö –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∑–∞ $\\Theta(n)$ (–≥–¥–µ $n$ - —á–∏—Å–ª–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–µ). –ú–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ (—Ç–æ–≥–¥–∞ –º–∏–Ω–∏–º—É–º –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –≤ –Ω–∞—á–∞–ª–µ), –Ω–æ —Ç–æ–≥–¥–∞ –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è –±—ã—Å—Ç—Ä–æ –¥–æ–±–∞–≤–ª—è—Ç—å –∏–ª–∏ —É–¥–∞–ª—è—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç.\n–î–≤–æ–∏—á–Ω–∞—è –∫—É—á–∞ (–ø–∏—Ä–∞–º–∏–¥–∞), binary heap - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∑–∞ $O(\\log n)$, –∞ —Ç–∞–∫–∂–µ –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –∫ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–µ –∑–∞ $O(1)$.\n–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –î–≤–æ–∏—á–Ω–∞—è –∫—É—á–∞ –∏–∑ $n$ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ - —ç—Ç–æ –º–∞—Å—Å–∏–≤ $a$ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ –æ—Ç 1 –¥–æ $n$, –æ–±—Ä–∞–∑—É—é—â–∏–π –¥–≤–æ–∏—á–Ω–æ–µ –¥–µ—Ä–µ–≤–æ: –¥–ª—è –ª—é–±–æ–≥–æ $1 \u003c i \\leqslant n$ —Ä–æ–¥–∏—Ç–µ–ª—å $i$-–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ - —ç—Ç–æ —ç–ª–µ–º–µ–Ω—Ç —Å –Ω–æ–º–µ—Ä–æ–º $\\left\\lfloor\\frac{i}{2}\\right\\rfloor ;$ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –¥–ª—è –ª—é–±–æ–≥–æ $1 \\leqslant i \\leqslant n$ –¥–µ—Ç–∏ $i$-–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–º–µ—é—Ç –Ω–æ–º–µ—Ä–∞ $2 i, 2 i+1$ (–µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã —Å —Ç–∞–∫–∏–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç).\n–ü—Ä–∏ —ç—Ç–æ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–≤–æ–π—Å—Ç–≤–æ –∫—É—á–∏: –∑–Ω–∞—á–µ–Ω–∏–µ –ª—é–±–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–µ –º–µ–Ω—å—à–µ –∑–Ω–∞—á–µ–Ω–∏—è –µ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è: $a[i] \\geqslant a\\left[\\left\\lfloor\\frac{i}{2}\\right]\\right]$. –¢–∞–∫—É—é –∫—É—á—É —Ç–∞–∫–∂–µ –º–æ–≥—É—Ç –Ω–∞–∑—ã–≤–∞—Ç—å –Ω–µ—É–±—ã–≤–∞—é—â–∞—è –ø–∏—Ä–∞–º–∏–¥–∞. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –µ—Å–ª–∏ $a[i] \\leqslant a\\left[\\left\\lfloor\\frac{i}{2}\\right]\\right]$ - —Ç–æ –Ω–µ–≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–∞—è –ø–∏—Ä–∞–º–∏–¥–∞.\n–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ –≤—Å–µ–≥–¥–∞ —è–≤–ª—è–µ—Ç—Å—è –∫—É—á–µ–π. –ù–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –æ–±—ã—á–Ω–æ –º–æ–∂–Ω–æ —É–ø–æ—Ä—è–¥–æ—á–∏—Ç—å –∏ –º–Ω–æ–≥–∏–º–∏ –¥—Ä—É–≥–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏ —Ç–∞–∫, —á—Ç–æ —Ç–æ–∂–µ –ø–æ–ª—É—á–∏—Ç—Å—è –∫—É—á–∞. –ë—É–¥–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–µ—Ä–º–∏–Ω–∞–º–∏ –∏–∑ —Ç–µ–æ—Ä–∏–∏ –≥—Ä–∞—Ñ–æ–≤. –≠–ª–µ–º–µ–Ω—Ç—ã –¥–µ—Ä–µ–≤–∞ (–∫—É—á–∏) –±—É–¥–µ–º –Ω–∞–∑—ã–≤–∞—Ç—å –≤–µ—Ä—à–∏–Ω–∞–º–∏. –ö–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞ - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –≤–µ—Ä—à–∏–Ω–∞ –±–µ–∑ —Ä–æ–¥–∏—Ç–µ–ª—è (–≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ $a[1]$ ). –ü–æ—Ç–æ–º–∫–∏ –≤–µ—Ä—à–∏–Ω—ã - —ç—Ç–æ –æ–Ω–∞ —Å–∞–º–∞, –µ—ë –¥–µ—Ç–∏, –∞ —Ç–∞–∫–∂–µ –≤—Å–µ –∏—Ö –ø–æ—Ç–æ–º–∫–∏; —É –ª–∏—Å—Ç–∞ (–≤–µ—Ä—à–∏–Ω—ã –±–µ–∑ –¥–µ—Ç–µ–π) –ø–æ—Ç–æ–º–∫–æ–≤ (–∫—Ä–æ–º–µ –Ω–µ–≥–æ —Å–∞–º–æ–≥–æ) –Ω–µ—Ç. –ü—Ä–µ–¥–æ–∫ –≤–µ—Ä—à–∏–Ω—ã $v$ - –ª—é–±–∞—è —Ç–∞–∫–∞—è –≤–µ—Ä—à–∏–Ω–∞ $u$, —á—Ç–æ $v$ - –ø–æ—Ç–æ–º–æ–∫ $u$. –ü–æ–¥–¥–µ—Ä–µ–≤–æ –≤–µ—Ä—à–∏–Ω—ã $v$ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –≤—Å–µ—Ö –µ—ë –ø–æ—Ç–æ–º–∫–æ–≤; $v$ - –∫–æ—Ä–µ–Ω—å —Å–≤–æ–µ–≥–æ –ø–æ–¥–¥–µ—Ä–µ–≤–∞.\n–ò–Ω–æ–≥–¥–∞ –º—ã –±—É–¥–µ–º –Ω–∞–∑—ã–≤–∞—Ç—å –∫—É—á–µ–π –Ω–µ –º–∞—Å—Å–∏–≤ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ –æ—Ç 1 –¥–æ $n$, –∞ –ø—Ä–æ—Å—Ç–æ –¥–µ—Ä–µ–≤–æ, –≤ –∫–æ—Ç–æ—Ä–æ–º —Å–≤–æ–π—Å—Ç–≤–æ –∫—É—á–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä —Ä–æ–¥–∏—Ç–µ–ª—å-—Ä–µ–±—ë–Ω–æ–∫. –í —ç—Ç–æ–º —Å–º—ã—Å–ª–µ –ª—é–±–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ –∫—É—á–∏ —Ç–æ–∂–µ —è–≤–ª—è–µ—Ç—Å—è –∫—É—á–µ–π.\n–ì–ª—É–±–∏–Ω–∞ $x$ - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ—Ä—à–∏–Ω –Ω–∞ –ø—É—Ç–∏ –æ—Ç –∫–æ—Ä–Ω—è –¥–µ—Ä–µ–≤–∞ –¥–æ $x$ (–≤—Å–µ –≤–µ—Ä—à–∏–Ω—ã —è–≤–ª—è—é—Ç—Å—è –ø–æ—Ç–æ–º–∫–∞–º–∏ –∫–æ—Ä–Ω—è). –í—ã—Å–æ—Ç–∞ –≤–µ—Ä—à–∏–Ω—ã $x$ - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ—Ä—à–∏–Ω –Ω–∞ –ø—É—Ç–∏ –æ—Ç $x$ –¥–æ –∫–∞–∫–æ–≥–æ-–ª–∏–±–æ –µ—ë –ø–æ—Ç–æ–º–∫–∞. –í—ã—Å–æ—Ç–∞ –¥–µ—Ä–µ–≤–∞ - –º–∞–∫—Å–∏–º—É–º –∏–∑ –≤—ã—Å–æ—Ç –≤–µ—Ä—à–∏–Ω, —Ç–æ –µ—Å—Ç—å –≤—ã—Å–æ—Ç–∞ –∫–æ—Ä–Ω—è.\n–ì–ª—É–±–∏–Ω–∞ $i$-–π –≤–µ—Ä—à–∏–Ω—ã —Ä–∞–≤–Ω–∞ $\\lfloor\\log i\\rfloor+1$, —Ç–∞–∫ –∫–∞–∫ $i$ –Ω—É–∂–Ω–æ –ø–æ–¥–µ–ª–∏—Ç—å –Ω–∞ –¥–≤–∞ –Ω–∞—Ü–µ–ª–æ $\\lfloor\\log i\\rfloor$ —Ä–∞–∑, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å 1.\n–í—ã—Å–æ—Ç–∞ –∫–æ—Ä–Ω—è - —ç—Ç–æ –º–∞–∫—Å–∏–º—É–º –∏–∑ –≥–ª—É–±–∏–Ω –≤—Å–µ—Ö –µ–≥–æ –ø–æ—Ç–æ–º–∫–æ–≤. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ —É $n$-–π –≤–µ—Ä—à–∏–Ω—ã $-\\lfloor\\log n\\rfloor+1$. –ó–Ω–∞—á–∏—Ç, –≤—ã—Å–æ—Ç–∞ –∫—É—á–∏ –∏–∑ $n$ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ä–∞–≤–Ω–∞ $\\lfloor\\log n\\rfloor+1$.\n–ë–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ù–∞—É—á–∏–º—Å—è –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ç—Ä–∏ –ø—Ä–æ—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–∏: getMin() - –ø–æ–∏—Å–∫ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –∫—É—á–µ, insert(x) - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ $x$ –≤ –∫—É—á—É, –∏ extractMin() - —É–¥–∞–ª–µ–Ω–∏–µ –º–∏–Ω–∏–º—É–º–∞ –∏–∑ –∫—É—á–∏. –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –±—É–¥—É—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ $\\operatorname{siftUp(i)~–∏~siftDown(i).~}$\n–ü–æ–∏—Å–∫ –º–∏–Ω–∏–º—É–º–∞ –ò–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫—É—á–∏ —Å—Ä–∞–∑—É –∂–µ —Å–ª–µ–¥—É–µ—Ç, —á—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä–Ω–µ. –¢–æ–≥–¥–∞ –ø—Ä–æ—Å—Ç–æ –≤–µ—Ä–Ω—ë–º $a[1]$, –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã $-O(1)$. ‚Äã –ø—Å–µ–≤–¥–æ–∫–æ–¥ 1 2 getMin(): return a[1] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ü—É—Å—Ç—å —Å–≤–æ–π—Å—Ç–≤–æ –∫—É—á–∏ ‚Äú–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏‚Äù –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è: –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ $i$ –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ $a[i]=x$ –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å —Ç–∞–∫, —á—Ç–æ –º–∞—Å—Å–∏–≤ $a$ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π. –¢–∞–∫—É—é –ø–æ—á—Ç–∏ –∫—É—á—É –º–æ–∂–Ω–æ ‚Äú–ø–æ—á–∏–Ω–∏—Ç—å‚Äù, –Ω–µ –º–µ–Ω—è—è –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ª–µ–∂–∞—â–∏—Ö –≤ –Ω–µ–π –∑–Ω–∞—á–µ–Ω–∏–π, —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º: –ø—Ä–æ—Å—Ç–æ –±—É–¥–µ–º ‚Äú–ø–æ–¥–Ω–∏–º–∞—Ç—å‚Äù $x$ –≤–≤–µ—Ä—Ö, –ø–æ–∫–∞ $x$ –º–µ–Ω—å—à–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ä–æ–¥–∏—Ç–µ–ª–µ. ‚Äã –ø—Å–µ–≤–¥–æ–∫–æ–¥ python c++ 1 2 3 4 siftUp(i): while i \u003e 1 and a[i] \u003c a[i / 2]: swap(a[i], a[i / 2]) i /= 2 1 2 3 4 5 6 7 8 9 10 11 12 13 def sift_up(arr, i): \"\"\" –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ—Å–µ–∏–≤–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ –≤–≤–µ—Ä—Ö –≤ –∫—É—á–µ arr - –º–∞—Å—Å–∏–≤, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π –∫—É—á—É i - –∏–Ω–¥–µ–∫—Å —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–ª—è –ø—Ä–æ—Å–µ–∏–≤–∞–Ω–∏—è (–≤ –Ω–æ—Ç–∞—Ü–∏–∏ —Å 0) \"\"\" while i \u003e 0: parent = (i - 1) // 2 if arr[i] \u003c arr[parent]: arr[i], arr[parent] = arr[parent], arr[i] i = parent else: break 1 2 3 4 5 6 7 8 9 10 11 12 13 14 #include \u003cvector\u003e #include \u003calgorithm\u003e void siftUp(std::vector\u003cint\u003e\u0026 arr, int i) { while (i \u003e 0) { int parent = (i - 1) / 2; if (arr[i] \u003c arr[parent]) { std::swap(arr[i], arr[parent]); i = parent; } else { break; } } } –°–≤–æ–π—Å—Ç–≤–∞ –ü—É—Å—Ç—å –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ $a[i]=x$ –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å —Ç–∞–∫, —á—Ç–æ –º–∞—Å—Å–∏–≤ $a$ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π. –¢–æ–≥–¥–∞ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è $\\operatorname{siftUp}(i)$ –º–∞—Å—Å–∏–≤ $a$ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π. –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –î–æ–∫–∞–∂–µ–º —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏–Ω–¥—É–∫—Ü–∏–µ–π –ø–æ $i$. –ë–∞–∑–∞. –ï—Å–ª–∏ $i=1$, —Ç–æ $a$ —É–∂–µ —è–≤–ª—è–µ—Ç—Å—è –∫—É—á–µ–π (–µ—Å–ª–∏ –∫–æ—Ä–µ–Ω—å –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å —Ç–∞–∫, —á—Ç–æ –æ–Ω —Å—Ç–∞–Ω–µ—Ç –Ω–µ –±–æ–ª—å—à–µ –¥–µ—Ç–µ–π, —Ç–æ –æ–Ω –∏ —Å–µ–π—á–∞—Å –Ω–µ –±–æ–ª—å—à–µ –¥–µ—Ç–µ–π). siftUp(1) –Ω–µ –º–µ–Ω—è–µ—Ç –º–∞—Å—Å–∏–≤ $a$.\n–ü–µ—Ä–µ—Ö–æ–¥. –ó–∞–º–µ—Ç–∏–º —Å–Ω–∞—á–∞–ª–∞, —á—Ç–æ –µ—Å–ª–∏ $a$ —É–∂–µ —è–≤–ª—è–µ—Ç—Å—è –∫—É—á–µ–π, —Ç–æ $\\operatorname{siftUp}(i)$ –Ω–∏—á–µ–≥–æ –Ω–µ —Å–¥–µ–ª–∞–µ—Ç, –ø–æ—ç—Ç–æ–º—É —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤–µ—Ä–Ω–æ.\n–ï—Å–ª–∏ $a$ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∫—É—á–µ–π, —Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–∞—Ä–∞ —Ä–æ–¥–∏—Ç–µ–ª—å-—Ä–µ–±—ë–Ω–æ–∫, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–≤–æ–π—Å—Ç–≤–æ –∫—É—á–∏ - —ç—Ç–æ $x=a[i] \u003c a\\left[\\left\\lfloor\\frac{i}{2}\\right\\rfloor\\right]=y$ (–ø–æ—Å–∫–æ–ª—å–∫—É –¥–ª—è –ø–∞—Ä—ã, –≤ –∫–æ—Ç–æ—Ä–æ–π $a[i]$ —è–≤–ª—è–µ—Ç—Å—è —Ä–æ–¥–∏—Ç–µ–ª–µ–º, —É–≤–µ–ª–∏—á–µ–Ω–∏–µ $a[i]$ –º–æ–∂–µ—Ç –ª–∏—à—å –Ω–∞—á–∞—Ç—å –Ω–∞—Ä—É—à–∞—Ç—å –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ). –¢–æ–≥–¥–∞ $a$ —Ç–æ—á–Ω–æ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π, –µ—Å–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ $a[i]$ –¥–æ $y$.\n–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ü–∏–∫–ª–∞ $x$ –∏ $y$ –ø–æ–º–µ–Ω—è—é—Ç—Å—è –º–µ—Å—Ç–∞–º–∏: $y=a[i] \u003e a\\left[\\left\\lfloor\\frac{i}{2}\\right\\rfloor\\right]=x$. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ —Ç–∞–∫–æ–π –º–∞—Å—Å–∏–≤ $a$ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ $a\\left[\\left\\lfloor\\frac{i}{2}\\right\\rfloor\\right]$ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ $y$ (—ç—Ç–æ —Ä–∞–≤–Ω–æ—Å–∏–ª—å–Ω–æ —É–≤–µ–ª–∏—á–µ–Ω–∏—é $a[i]$ –¥–æ $y$ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –º–∞—Å—Å–∏–≤–µ). –¢–æ–≥–¥–∞, –ø–æ—Å–∫–æ–ª—å–∫—É –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è siftUp —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–º—É –≤—ã–∑–æ–≤—É $\\operatorname{siftUp}(i / 2)$, –ø–æ –∏–Ω–¥—É–∫—Ü–∏–∏ –≤–µ—Ä–Ω–æ, —á—Ç–æ –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–∞—Å—Å–∏–≤ $a$ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π.\n–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π —Ü–∏–∫–ª–∞ –≤ siftUp(i) –Ω–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç –≥–ª—É–±–∏–Ω—ã $i$-–π –≤–µ—Ä—à–∏–Ω—ã, —Ç–æ –µ—Å—Ç—å –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ $O(\\log i+1)$.\n–ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç $x$ –≤ –∫—É—á—É —Ä–∞–∑–º–µ—Ä–∞ $n$, –∑–∞–ø–∏—à–µ–º $x$ –≤ $a[n+1]$ (–º—ã –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ –º–∞—Å—Å–∏–≤ $a$ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ª–∏–±–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π). –ü—Ä–∏ —ç—Ç–æ–º $a$ –º–æ–≥ –ø–µ—Ä–µ—Å—Ç–∞—Ç—å –±—ã—Ç—å –∫—É—á–µ–π, –Ω–æ $a[n+1]$ –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å —Ç–∞–∫, —á—Ç–æ $a$ —Å–Ω–æ–≤–∞ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–¥–µ–ª–∞–≤ –µ–≥–æ –±–æ–ª—å—à–µ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤), –ø–æ—ç—Ç–æ–º—É –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ—Ç –Ω–µ–≥–æ siftUp. –ü–æ–ª—É—á–∞–µ–º –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã $O(\\log n)$. ‚Äã –ø—Å–µ–≤–¥–æ–∫–æ–¥ 1 2 3 4 insert(x): sz += 1 # sz - —Ä–∞–∑–º–µ—Ä –∫—É—á–∏ a[sz] = x siftUp(sz) –£–¥–∞–ª–µ–Ω–∏–µ –º–∏–Ω–∏–º—É–º–∞ –ü—É—Å—Ç—å –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ $a[i]=x$ –º–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å —Ç–∞–∫, —á—Ç–æ –º–∞—Å—Å–∏–≤ $a$ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π. –¢–∞–∫—É—é –ø–æ—á—Ç–∏ –∫—É—á—É —Ç–æ–∂–µ –º–æ–∂–Ω–æ ‚Äú–ø–æ—á–∏–Ω–∏—Ç—å‚Äù: –±—É–¥–µ–º ‚Äú–æ–ø—É—Å–∫–∞—Ç—å‚Äù $x$ –≤–Ω–∏–∑, –ø–æ–∫–∞ $x$ –±–æ–ª—å—à–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ –∏–∑ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –¥–µ—Ç—è—Ö, –ø—Ä–∏ —ç—Ç–æ–º –±—É–¥–µ–º –º–µ–Ω—è—Ç—å $x$ –º–µ—Å—Ç–∞–º–∏ —Å —Ç–µ–º —Ä–µ–±—ë–Ω–∫–æ–º, –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ—Ç–æ—Ä–æ–º –º–µ–Ω—å—à–µ. ‚Äã –ø—Å–µ–≤–¥–æ–∫–æ–¥ python c++ 1 2 3 4 5 6 7 8 9 10 siftDown(i): while 2 * i \u003c= sz: j = 2 * i if 2 * i + 1 \u003c= sz and a[2 * i + 1] \u003c a[2 * i]: j = 2 * i + 1 # j - –Ω–æ–º–µ—Ä –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é —Ä–µ–±—ë–Ω–∫–∞ i-–π –≤–µ—Ä—à–∏–Ω—ã if a[j] \u003e= a[i]: break swap(a[j], a[i]) i = j 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 def siftDown(arr, i, sz): \"\"\" arr: –º–∞—Å—Å–∏–≤ i: –∏–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ (–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Å 0) sz: —Ä–∞–∑–º–µ—Ä –∫—É—á–∏ (–Ω–µ –≤–∫–ª—é—á–∞—è –∏–Ω–¥–µ–∫—Å sz) \"\"\" while 2 * i + 1 \u003c sz: # –ø–æ–∫–∞ –µ—Å—Ç—å –ª–µ–≤—ã–π —Ä–µ–±–µ–Ω–æ–∫ j = 2 * i + 1 # –ª–µ–≤—ã–π —Ä–µ–±–µ–Ω–æ–∫ # –µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–∞–≤—ã–π —Ä–µ–±–µ–Ω–æ–∫ –∏ –æ–Ω –º–µ–Ω—å—à–µ –ª–µ–≤–æ–≥–æ if 2 * i + 2 \u003c sz and arr[2 * i + 2] \u003c arr[2 * i + 1]: j = 2 * i + 2 # –ø—Ä–∞–≤—ã–π —Ä–µ–±–µ–Ω–æ–∫ # j - –∏–Ω–¥–µ–∫—Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞ i-–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ if arr[j] \u003e= arr[i]: break arr[i], arr[j] = arr[j], arr[i] i = j 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 #include \u003cvector\u003e #include \u003calgorithm\u003e void siftDown(std::vector\u003cint\u003e\u0026 arr, int i, int sz) { // i: –∏–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ (–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Å 0) // sz: —Ä–∞–∑–º–µ—Ä –∫—É—á–∏ (–Ω–µ –≤–∫–ª—é—á–∞—è –∏–Ω–¥–µ–∫—Å sz) while (2 * i + 1 \u003c sz) { // –ø–æ–∫–∞ –µ—Å—Ç—å –ª–µ–≤—ã–π —Ä–µ–±–µ–Ω–æ–∫ int j = 2 * i + 1; // –ª–µ–≤—ã–π —Ä–µ–±–µ–Ω–æ–∫ // –µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–∞–≤—ã–π —Ä–µ–±–µ–Ω–æ–∫ –∏ –æ–Ω –º–µ–Ω—å—à–µ –ª–µ–≤–æ–≥–æ if (2 * i + 2 \u003c sz \u0026\u0026 arr[2 * i + 2] \u003c arr[2 * i + 1]) { j = 2 * i + 2; // –ø—Ä–∞–≤—ã–π —Ä–µ–±–µ–Ω–æ–∫ } // j - –∏–Ω–¥–µ–∫—Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞ i-–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ if (arr[j] \u003e= arr[i]) { break; } std::swap(arr[i], arr[j]); i = j; } } –°–≤–æ–π—Å—Ç–≤–∞ –ü—É—Å—Ç—å –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ $a[i]=x$ –º–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å —Ç–∞–∫, —á—Ç–æ –º–∞—Å—Å–∏–≤ $a$ —Ä–∞–∑–º–µ—Ä–∞ $n$ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π. –¢–æ–≥–¥–∞ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è siftDown(i) –º–∞—Å—Å–∏–≤ $a$ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π. –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –î–æ–∫–∞–∂–µ–º —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Äú–æ–±—Ä–∞—Ç–Ω–æ–π‚Äù –∏–Ω–¥—É–∫—Ü–∏–µ–π –ø–æ $i$. –ë–∞–∑–∞. –ï—Å–ª–∏ $i\u003e2 n$, —Ç–æ $a$ —É–∂–µ —è–≤–ª—è–µ—Ç—Å—è –∫—É—á–µ–π (–µ—Å–ª–∏ –ª–∏—Å—Ç –º–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å —Ç–∞–∫, —á—Ç–æ –æ–Ω —Å—Ç–∞–Ω–µ—Ç –Ω–µ –º–µ–Ω—å—à–µ —Ä–æ–¥–∏—Ç–µ–ª—è, —Ç–æ –æ–Ω –∏ —Å–µ–π—á–∞—Å –Ω–µ –º–µ–Ω—å—à–µ —Ä–æ–¥–∏—Ç–µ–ª—è). siftDown(i) –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –Ω–µ –ø–æ–º–µ–Ω—è–µ—Ç –º–∞—Å—Å–∏–≤ $a$.\n–ü–µ—Ä–µ—Ö–æ–¥. –ó–∞–º–µ—Ç–∏–º —Å–Ω–∞—á–∞–ª–∞, —á—Ç–æ –µ—Å–ª–∏ $a$ —É–∂–µ —è–≤–ª—è–µ—Ç—Å—è –∫—É—á–µ–π, —Ç–æ siftDown(i) –Ω–∏—á–µ–≥–æ –Ω–µ —Å–¥–µ–ª–∞–µ—Ç, –ø–æ—ç—Ç–æ–º—É —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤–µ—Ä–Ω–æ.\n–ï—Å–ª–∏ $a$ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∫—É—á–µ–π, —Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ –∫—É—á–∏ –º–æ–∂–µ—Ç –Ω–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Ö –ø–∞—Ä —Ä–æ–¥–∏—Ç–µ–ª—å-—Ä–µ–±—ë–Ω–æ–∫, –≤ –∫–æ—Ç–æ—Ä—ã—Ö $a[i]$ —è–≤–ª—è–µ—Ç—Å—è —Ä–æ–¥–∏—Ç–µ–ª–µ–º. –ü—É—Å—Ç—å $j$ - –Ω–æ–º–µ—Ä –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é –∏–∑ –¥–µ—Ç–µ–π $i$-–π –≤–µ—Ä—à–∏–Ω—ã, $y=a[j] \u003c x$. –¢–æ–≥–¥–∞ $a$ —Ç–æ—á–Ω–æ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π, –µ—Å–ª–∏ —É–º–µ–Ω—å—à–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ $a[i]$ –¥–æ $y$.\n–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ü–∏–∫–ª–∞ $x$ –∏ $y$ –ø–æ–º–µ–Ω—è—é—Ç—Å—è –º–µ—Å—Ç–∞–º–∏: $y=a[i] \u003c a[j] = x$. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ —Ç–∞–∫–æ–π –º–∞—Å—Å–∏–≤ $a$ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ $a[j]$ —É–º–µ–Ω—å—à–∏—Ç—å –¥–æ $y$ (—ç—Ç–æ —Ä–∞–≤–Ω–æ—Å–∏–ª—å–Ω–æ —É–º–µ–Ω—å—à–µ–Ω–∏—é $a[i]$ –¥–æ $y$ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –º–∞—Å—Å–∏–≤–µ). –¢–æ–≥–¥–∞, –ø–æ—Å–∫–æ–ª—å–∫—É –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è siftDown —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–º—É –≤—ã–∑–æ–≤—É $\\operatorname{siftDown(j)}$, –ø–æ –∏–Ω–¥—É–∫—Ü–∏–∏ –≤–µ—Ä–Ω–æ, —á—Ç–æ –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–∞—Å—Å–∏–≤ $a$ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π.\n–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π —Ü–∏–∫–ª–∞ –≤ $\\operatorname{siftDown(i)}$ –Ω–µ –±–æ–ª—å—à–µ –≤—ã—Å–æ—Ç—ã $i$-–π –≤–µ—Ä—à–∏–Ω—ã, –ø–æ—ç—Ç–æ–º—É –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ $O(\\log n-\\log i+1)=O\\left(\\log \\frac{n}{i}+1\\right)$, –∏–ª–∏, –±–æ–ª–µ–µ –≥—Ä—É–±–æ, $O(\\log n)$.\n–ß—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å –º–∏–Ω–∏–º—É–º –∏–∑ –∫—É—á–∏ —Ä–∞–∑–º–µ—Ä–∞ $n$, –ø–æ–º–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏ $a[1]$ –∏ $a[n]$, –∏ —É–º–µ–Ω—å—à–∏–º —Ä–∞–∑–º–µ—Ä –∫—É—á–∏ –Ω–∞ –æ–¥–∏–Ω. –¢–µ–ø–µ—Ä—å –≤ $a[1]$ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ –Ω–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç, –Ω–æ –µ–≥–æ –º–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å —Ç–∞–∫, —á—Ç–æ $a$ –æ–ø—è—Ç—å —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–¥–µ–ª–∞—Ç—å –µ–≥–æ –º–µ–Ω—å—à–µ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤). –¢–æ–≥–¥–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å $\\operatorname{siftDown(1)}$. –ü–æ–ª—É—á–∞–µ–º –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã $O(\\log n)$. ‚Äã –ø—Å–µ–≤–¥–æ–∫–æ–¥ python c++ 1 2 3 4 5 extractMin(): swap(a[1], a[sz]) sz -= 1 if sz \u003e= 1: # –µ—Å–ª–∏ –∫—É—á–∞ –Ω–µ–ø—É—Å—Ç–∞ siftDown(1) 1 2 3 4 5 6 7 8 9 def extractMin(arr, sz): # –ú–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏ –∫–æ—Ä–µ–Ω—å (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç) —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º arr[0], arr[sz-1] = arr[sz-1], arr[0] sz -= 1 if sz \u003e= 1: # –µ—Å–ª–∏ –∫—É—á–∞ –Ω–µ–ø—É—Å—Ç–∞ siftDown(arr, 0, sz) return arr, sz 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 void siftDown(std::vector\u003cint\u003e\u0026 arr, int i, int sz) { // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤–∞ –∫—É—á–∏ // i - –∏–Ω–¥–µ–∫—Å —ç–ª–µ–º–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –ø—Ä–æ—Å–µ—è—Ç—å –≤–Ω–∏–∑ // sz - —Ç–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä –∫—É—á–∏ while (true) { int left = 2 * i + 1; // –ª–µ–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ (—Å —É—á–µ—Ç–æ–º –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ —Å 0) int right = 2 * i + 2; // –ø—Ä–∞–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ int smallest = i; if (left \u003c sz \u0026\u0026 arr[left] \u003c arr[smallest]) { smallest = left; } if (right \u003c sz \u0026\u0026 arr[right] \u003c arr[smallest]) { smallest = right; } if (smallest == i) { break; } std::swap(arr[i], arr[smallest]); i = smallest; } } –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫—É—á–∏ –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∫—É—á—É –∏–∑ $n$ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ - –Ω–∞—á–∞—Ç—å —Å –ø—É—Å—Ç–æ–π –∫—É—á–∏, –∏ –¥–æ–±–∞–≤–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ –æ–¥–Ω–æ–º—É. –í —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ (–µ—Å–ª–∏ –≤—Å–µ –≤—ã–∑–æ–≤—ã $\\operatorname{siftUp}$ –±—É–¥—É—Ç –ø–æ–¥–Ω–∏–º–∞—Ç—å—Å—è –¥–æ –∫–æ—Ä–Ω—è, —Ç–æ –µ—Å—Ç—å –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ —É–±—ã–≤–∞—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ) –ø–æ–ª—É—á–∏–º –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã $\\Theta(n \\log n)$.\n–ú–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∫—É—á—É –±—ã—Å—Ç—Ä–µ–µ: —Å–ª–æ–∂–∏–º —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –º–∞—Å—Å–∏–≤ –≤ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –ø–æ—Å–ª–µ —á–µ–≥–æ –ø–æ–æ—á–µ—Ä—ë–¥–Ω–æ –∑–∞–ø—É—Å—Ç–∏–º siftDown –æ—Ç –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –Ω–µ —è–≤–ª—è—é—â–∏—Ö—Å—è –ª–∏—Å—Ç—å—è–º–∏, –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è –∏—Ö –Ω–æ–º–µ—Ä–æ–≤. ‚Äã –ø—Å–µ–≤–¥–æ–∫–æ–¥ python c++ 1 2 3 4 build(a, n): sz = n for i = (n / 2)..1: siftDown(i) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 class Heap: def __init__(self, arr): self.heap = arr self.sz = len(arr) def build(self): \"\"\"–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫—É—á–∏ –∏–∑ –º–∞—Å—Å–∏–≤–∞\"\"\" self.sz = len(self.heap) # –ù–∞—á–∏–Ω–∞–µ–º —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è (n//2 - 1 –≤ 0-–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏) for i in range(self.sz // 2 - 1, -1, -1): self._sift_down(i) # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–µ–∏–≤–∞–Ω–∏–µ –∫–æ—Ä–Ω—è (–¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏) if self.sz \u003e 0: self._sift_down(0) def _sift_down(self, i): \"\"\"–ü—Ä–æ—Å–µ–∏–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤–Ω–∏–∑\"\"\" largest = i left = 2 * i + 1 # –õ–µ–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ right = 2 * i + 2 # –ü—Ä–∞–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å –ª–µ–≤—ã–º –ø–æ—Ç–æ–º–∫–æ–º if left \u003c self.sz and self.heap[left] \u003e self.heap[largest]: largest = left # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å –ø—Ä–∞–≤—ã–º –ø–æ—Ç–æ–º–∫–æ–º if right \u003c self.sz and self.heap[right] \u003e self.heap[largest]: largest = right # –ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –º–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏ –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—Ä–æ—Å–µ–∏–≤–∞–Ω–∏–µ if largest != i: self.heap[i], self.heap[largest] = self.heap[largest], self.heap[i] self._sift_down(largest) def get_heap(self): return self.heap # –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è def build_heap(arr, n): heap = Heap(arr) heap.build() return heap.get_heap() # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ arr = [4, 10, 3, 5, 1, 8, 7] result = build_heap(arr, len(arr)) print(\"–ü–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∫—É—á–∞:\", result) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 #include \u003ciostream\u003e #include \u003cvector\u003e #include \u003calgorithm\u003e class Heap { private: std::vector\u003cint\u003e heap; int sz; void siftDown(int i) { int largest = i; int left = 2 * i + 1; // –õ–µ–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ (—Å —É—á–µ—Ç–æ–º 0-–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏) int right = 2 * i + 2; // –ü—Ä–∞–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ // –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å –ª–µ–≤—ã–º –ø–æ—Ç–æ–º–∫–æ–º if (left \u003c sz \u0026\u0026 heap[left] \u003e heap[largest]) { largest = left; } // –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å –ø—Ä–∞–≤—ã–º –ø–æ—Ç–æ–º–∫–æ–º if (right \u003c sz \u0026\u0026 heap[right] \u003e heap[largest]) { largest = right; } // –ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –º–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏ –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—Ä–æ—Å–µ–∏–≤–∞–Ω–∏–µ if (largest != i) { std::swap(heap[i], heap[largest]); siftDown(largest); } } public: Heap(const std::vector\u003cint\u003e\u0026 arr) : heap(arr), sz(arr.size()) {} void build() { sz = heap.size(); // –ù–∞—á–∏–Ω–∞–µ–º —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è (n/2 - 1 –≤ 0-–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏) for (int i = sz / 2 - 1; i \u003e= 0; i--) { siftDown(i); } // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–æ—Å–µ–∏–≤–∞–Ω–∏–µ –∫–æ—Ä–Ω—è (–¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏) if (sz \u003e 0) { siftDown(0); } } std::vector\u003cint\u003e getHeap() const { return heap; } }; // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫—É—á–∏ (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–∞–∫ –≤ –ø—Å–µ–≤–¥–æ–∫–æ–¥–µ) std::vector\u003cint\u003e buildHeap(std::vector\u003cint\u003e\u0026 arr, int n) { Heap heap(arr); heap.build(); return heap.getHeap(); } int main() { std::vector\u003cint\u003e arr = {4, 10, 3, 5, 1, 8, 7}; int n = arr.size(); std::vector\u003cint\u003e result = buildHeap(arr, n); std::cout \u003c\u003c \"–ü–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∫—É—á–∞: \"; for (int val : result) { std::cout \u003c\u003c val \u003c\u003c \" \"; } std::cout \u003c\u003c std::endl; return 0; } –õ–µ–º–º–∞ –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è $\\operatorname{build}$ –º–∞—Å—Å–∏–≤ $a$ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π. –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –î–æ–∫–∞–∂–µ–º ‚Äú–æ–±—Ä–∞—Ç–Ω–æ–π‚Äù –∏–Ω–¥—É–∫—Ü–∏–µ–π –ø–æ $i$, —á—Ç–æ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ $\\operatorname{siftDown(i)}$ –ø–æ–¥–¥–µ—Ä–µ–≤–æ $i$-–π –≤–µ—Ä—à–∏–Ω—ã —è–≤–ª—è–µ—Ç—Å—è –∫—É—á–µ–π.\n–ë–∞–∑–∞. $i\u003e\\left\\lfloor\\frac{n}{2}\\right\\rfloor$ (–Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –¥–ª—è —Ç–∞–∫–∏—Ö $i$ –º—ã –Ω–µ –≤—ã–∑—ã–≤–∞–µ–º $\\operatorname{siftDown}$, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ —Å–¥–µ–ª–∞–µ—Ç). –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –æ–¥–Ω–æ–π –≤–µ—Ä—à–∏–Ω—ã, –ø–æ—ç—Ç–æ–º—É —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–µ—Ä–Ω–æ.\n–ü–µ—Ä–µ—Ö–æ–¥. –ü–æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—é –∏–Ω–¥—É–∫—Ü–∏–∏, –ø–æ–¥–¥–µ—Ä–µ–≤—å—è –¥–µ—Ç–µ–π $i$-–π –≤–µ—Ä—à–∏–Ω—ã —è–≤–ª—è—é—Ç—Å—è –∫—É—á–∞–º–∏. –ó–Ω–∞—á–∏—Ç, $a[i]$ –º–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å —Ç–∞–∫, —á—Ç–æ –∏ –ø–æ–¥–¥–µ—Ä–µ–≤–æ $i$-–π –≤–µ—Ä—à–∏–Ω—ã —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–¥–µ–ª–∞–≤ $a[i]$ –º–µ–Ω—å—à–µ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –¥–µ—Ç—è—Ö). –¢–æ–≥–¥–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ $\\operatorname{siftDown(i)}$ –ø–æ–¥–¥–µ—Ä–µ–≤–æ $i$-–π –≤–µ—Ä—à–∏–Ω—ã —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π.\n–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã $\\operatorname{build}$ —Ç–æ–∂–µ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –∏–∑ $O(n)$ –∑–∞–ø—É—Å–∫–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π, –∫–∞–∂–¥–∞—è –∏–∑ –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ $O(\\log n)$. –û–¥–Ω–∞–∫–æ –æ—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã $O(n \\log n)$ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ç–æ—á–Ω–æ–π.\n–¢–µ–æ—Ä–µ–º–∞ –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã $\\operatorname{build}$ –µ—Å—Ç—å $\\Theta(n)$. –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–æ–π –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã $\\operatorname{siftUp}$: –ø—É—Å—Ç—å $\\lfloor\\log n\\rfloor=k$, —Ç–æ –µ—Å—Ç—å $2^{k} \\leqslant n \u003c 2^{k+1}$. –í—ã—Å–æ—Ç—É –æ–¥–∏–Ω –∏–º–µ–µ—Ç $n-2^{k}+1 \\leqslant 2^{k}$ –≤–µ—Ä—à–∏–Ω. –í—ã—Å–æ—Ç—É $1 \u003c h \\leqslant k+1$ –∏–º–µ–µ—Ç $2^{k+2-h}-2^{k+1-h}=2^{k+1-h}$ –≤–µ—Ä—à–∏–Ω. –¢–æ–≥–¥–∞ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã $\\operatorname{build}$ –µ—Å—Ç—å\n$$ \\begin{aligned} \u0026 O\\left(\\sum_{h=1}^{k+1} 2^{k+1-h} \\cdot h\\right)=O\\left(n \\cdot \\sum_{h=1}^{k+1} \\frac{h}{2^{h}}\\right)=O\\left(n \\cdot \\sum_{j=1}^{k+1} \\sum_{h=j}^{k+1} \\frac{1}{2^{h}}\\right)= \\\\ \u0026 =O\\left(n \\cdot \\sum_{j=1}^{k+1} \\frac{1}{2^{j}} \\cdot \\frac{1}{1-\\frac{1}{2}}\\right)=O\\left(n \\cdot \\frac{1}{1-\\frac{1}{2}} \\cdot \\frac{1}{1-\\frac{1}{2}}\\right)=O(n) \\end{aligned} $$ Heapsort –° –ø–æ–º–æ—â—å—é –¥–≤–æ–∏—á–Ω–æ–π –∫—É—á–∏ –º–æ–∂–Ω–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ –∑–∞ $O(n \\log n)$ : –ø–æ—Å—Ç—Ä–æ–∏–º –∫—É—á—É –Ω–∞ –º–∞—Å—Å–∏–≤–µ, –ø–æ—Å–ª–µ —á–µ–≥–æ $n$ —Ä–∞–∑ –∏–∑–≤–ª–µ—á—ë–º –º–∏–Ω–∏–º—É–º. –ï—Å–ª–∏ –≤ –∫–æ—Ä–Ω–µ –∫—É—á–∏ —Ö—Ä–∞–Ω–∏—Ç—Å—è –º–∞–∫—Å–∏–º—É–º, –∞ –Ω–µ –º–∏–Ω–∏–º—É–º (—Å–≤–æ–π—Å—Ç–≤–æ –∫—É—á–∏ –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–µ: –ª—é–±–æ–π —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –±–æ–ª—å—à–µ —Å–≤–æ–µ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è), —Ç–æ –ø—Ä–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏ –º–∞–∫—Å–∏–º—É–º–∞ –∏–∑ –∫—É—á–∏ —Ä–∞–∑–º–µ—Ä–∞ $k$ –æ–Ω –∫–∞–∫ —Ä–∞–∑ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ $k$-–π –ø–æ–∑–∏—Ü–∏–∏ –≤ –º–∞—Å—Å–∏–≤–µ, –ø–æ—ç—Ç–æ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—É –¥–∞–∂–µ –Ω–µ –Ω—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å. ‚Äã –ø—Å–µ–≤–¥–æ–∫–æ–¥ python c++ 1 2 3 4 heapSort(a, n): build(a, n) # —Å—Ç—Ä–æ–∏–º –∫—É—á—É, –≤ –∫–æ—Ä–Ω–µ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –º–∞–∫—Å–∏–º—É–º for i = 0..(n - 1): extractMax() 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 def heapSort(a, n): # –°—Ç—Ä–æ–∏–º –∫—É—á—É, –≤ –∫–æ—Ä–Ω–µ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –º–∞–∫—Å–∏–º—É–º build(a, n) for i in range(n - 1, 0, -1): # –û–±–º–µ–Ω–∏–≤–∞–µ–º –∫–æ—Ä–µ–Ω—å (–º–∞–∫—Å–∏–º—É–º) —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º a[0], a[i] = a[i], a[0] # –£–º–µ–Ω—å—à–∞–µ–º —Ä–∞–∑–º–µ—Ä –∫—É—á–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–≤–æ–π—Å—Ç–≤–æ –∫—É—á–∏ siftDown(a, 0, i) def build(a, n): # –ù–∞—á–∏–Ω–∞–µ–º —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è –∏ –∏–¥–µ–º –∫ –∫–æ—Ä–Ω—é for i in range(n // 2 - 1, -1, -1): siftDown(a, i, n) def siftDown(a, i, n): largest = i left = 2 * i + 1 # –ª–µ–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ (–≤ 0-–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏) right = 2 * i + 2 # –ø—Ä–∞–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ # –ï—Å–ª–∏ –ª–µ–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ –±–æ–ª—å—à–µ –∫–æ—Ä–Ω—è if left \u003c n and a[left] \u003e a[largest]: largest = left # –ï—Å–ª–∏ –ø—Ä–∞–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ –±–æ–ª—å—à–µ, —á–µ–º —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç if right \u003c n and a[right] \u003e a[largest]: largest = right # –ï—Å–ª–∏ —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –∫–æ—Ä–µ–Ω—å if largest != i: a[i], a[largest] = a[largest], a[i] # –º–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏ # –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø—Ä–æ—Å–µ–∏–≤–∞–µ–º –∑–∞—Ç—Ä–æ–Ω—É—Ç—É—é –ø–æ–¥–∫—É—á—É siftDown(a, largest, n) # –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è if __name__ == \"__main__\": arr = [12, 11, 13, 5, 6, 7] heapSort(arr, len(arr)) print(\"–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤:\", arr) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 #include \u003ciostream\u003e #include \u003cvector\u003e void siftDown(std::vector\u003cint\u003e\u0026 a, int i, int n) { int largest = i; int left = 2 * i + 1; // –ª–µ–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ (–≤ 0-–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏) int right = 2 * i + 2; // –ø—Ä–∞–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ // –ï—Å–ª–∏ –ª–µ–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ –±–æ–ª—å—à–µ –∫–æ—Ä–Ω—è if (left \u003c n \u0026\u0026 a[left] \u003e a[largest]) { largest = left; } // –ï—Å–ª–∏ –ø—Ä–∞–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ –±–æ–ª—å—à–µ, —á–µ–º —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç if (right \u003c n \u0026\u0026 a[right] \u003e a[largest]) { largest = right; } // –ï—Å–ª–∏ —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –∫–æ—Ä–µ–Ω—å if (largest != i) { std::swap(a[i], a[largest]); // –º–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏ // –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø—Ä–æ—Å–µ–∏–≤–∞–µ–º –∑–∞—Ç—Ä–æ–Ω—É—Ç—É—é –ø–æ–¥–∫—É—á—É siftDown(a, largest, n); } } void build(std::vector\u003cint\u003e\u0026 a, int n) { // –ù–∞—á–∏–Ω–∞–µ–º —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è –∏ –∏–¥–µ–º –∫ –∫–æ—Ä–Ω—é for (int i = n / 2 - 1; i \u003e= 0; i--) { siftDown(a, i, n); } } void heapSort(std::vector\u003cint\u003e\u0026 a, int n) { // –°—Ç—Ä–æ–∏–º –∫—É—á—É, –≤ –∫–æ—Ä–Ω–µ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –º–∞–∫—Å–∏–º—É–º build(a, n); for (int i = n - 1; i \u003e 0; i--) { // –û–±–º–µ–Ω–∏–≤–∞–µ–º –∫–æ—Ä–µ–Ω—å (–º–∞–∫—Å–∏–º—É–º) —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º std::swap(a[0], a[i]); // –£–º–µ–Ω—å—à–∞–µ–º —Ä–∞–∑–º–µ—Ä –∫—É—á–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–≤–æ–π—Å—Ç–≤–æ –∫—É—á–∏ siftDown(a, 0, i); } } // –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è int main() { std::vector\u003cint\u003e arr = {12, 11, 13, 5, 6, 7}; int n = arr.size(); heapSort(arr, n); std::cout \u003c\u003c \"–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤: \"; for (int i = 0; i \u003c n; i++) { std::cout \u003c\u003c arr[i] \u003c\u003c \" \"; } std::cout \u003c\u003c std::endl; return 0; } ‚úçÔ∏è Heapsort –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π.\n–û—á–µ—Ä–µ–¥—å —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ –û—á–µ—Ä–µ–¥—å —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ (priority queue) –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –æ–±—ã—á–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏ —Ç–µ–º, —á—Ç–æ —É –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –µ—Å—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –Ω–µ —Ç–æ—Ç —ç–ª–µ–º–µ–Ω—Ç, —á—Ç–æ –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ –æ—á–µ—Ä–µ–¥—å —Ä–∞–Ω—å—à–µ –≤—Å–µ—Ö, –∞ —ç–ª–µ–º–µ–Ω—Ç —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º. –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –≤ C++ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—á–µ—Ä–µ–¥–∏ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ - std::priority_queue.\n–ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ—á–µ—Ä–µ–¥–∏ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –∑–∞–¥–∞—á –≤ –º–Ω–æ–≥–æ–∑–∞–¥–∞—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö (–ø—Ä–æ—Ü–µ—Å—Å—ã —Å –±–æ–ª—å—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–∞–Ω—å—à–µ). –¢–∞–∫–∂–µ –æ—á–µ—Ä–µ–¥—å —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ –º–Ω–æ–≥–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞–º –µ—â—ë –≤—Å—Ç—Ä–µ—Ç—è—Ç—Å—è.\n–û—á–µ—Ä–µ–¥—å —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ –ª–µ–≥–∫–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –¥–≤–æ–∏—á–Ω–æ–π –∫—É—á–∏ —Å –º–∞–∫—Å–∏–º—É–º–æ–º –≤ –∫–æ—Ä–Ω–µ: –±—É–¥–µ–º —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ –∏—Ö –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É.\n–£–¥–∞–ª–µ–Ω–∏–µ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ—á–µ—Ä–µ–¥–∏ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ —á–∞—Å—Ç–æ —Ö–æ—á–µ—Ç—Å—è –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–µ–ª–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏: –º–µ–Ω—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ —É –æ–±—ä–µ–∫—Ç–∞, –ª–µ–∂–∞—â–µ–≥–æ –≤ –æ—á–µ—Ä–µ–¥–∏, –∏–ª–∏ —É–¥–∞–ª—è—Ç—å –∏–∑ –æ—á–µ—Ä–µ–¥–∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç, –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º. –ü–æ–∫–∞–∂–µ–º, —á—Ç–æ –¥–≤–æ–∏—á–Ω–∞—è –∫—É—á–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–∞–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.\n–ï—Å–ª–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ–±—ä–µ–∫—Ç–∞ –Ω–µ –º–∞–∫—Å–∏–º–∞–ª–µ–Ω, —Ç–æ —Å–ª–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –ø–æ–Ω—è—Ç—å, –≥–¥–µ –∏–º–µ–Ω–Ω–æ –≤ –∫—É—á–µ –æ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è. –ü–æ—ç—Ç–æ–º—É –∫–æ–≥–¥–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ —Ç–∞–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö, –æ–±—ã—á–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –µ–≥–æ –ø–æ–∑–∏—Ü–∏—é –≤ –∫—É—á–µ (–æ–±—ã—á–Ω–æ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –Ω–æ–º–µ—Ä —ç—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏), –∞ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ –≤ –∫—É—á–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —ç—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏. –¢–∞–∫, –µ—Å–ª–∏ –æ–±—ä–µ–∫—Ç—ã –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω—ã —á–∏—Å–ª–∞–º–∏ –æ—Ç $1$ –¥–æ $n$, –º–æ–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ pos, –≤ $i$-–π —è—á–µ–π–∫–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –ø–æ–∑–∏—Ü–∏—è –≤ –∫—É—á–µ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –Ω–æ–º–µ—Ä–æ–º $i$. –ü—Ä–∏ –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–µ –∫—É—á–∏ —ç—Ç–æ—Ç –º–∞—Å—Å–∏–≤ –Ω–µ—Å–ª–æ–∂–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å.\n–ò—Ç–∞–∫, –ø—É—Å—Ç—å –º—ã —Ö–æ—Ç–∏–º —É–¥–∞–ª–∏—Ç—å –æ–±—ä–µ–∫—Ç –∏–∑ –∫—É—á–∏ $a$ —Ä–∞–∑–º–µ—Ä–∞ $n$, –ø—Ä–∏ —ç—Ç–æ–º –º—ã –∑–Ω–∞–µ–º, —á—Ç–æ —Å–µ–π—á–∞—Å –æ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ $i$. –ü–æ—Å—Ç—É–ø–∏–º —Ç–∞–∫ –∂–µ, –∫–∞–∫ –∏ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –º–∞–∫—Å–∏–º—É–º–∞: –ø–æ–º–µ–Ω—è–µ–º $i$-–π —ç–ª–µ–º–µ–Ω—Ç –º–µ—Å—Ç–∞–º–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º, –∏ —É–º–µ–Ω—å—à–∏–º —Ä–∞–∑–º–µ—Ä –∫—É—á–∏. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ $a$ –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Å—Ç–∞—Ç—å –±—ã—Ç—å –∫—É—á–µ–π, –Ω–æ $i$-–π —ç–ª–µ–º–µ–Ω—Ç –º–æ–∂–Ω–æ –ª–∏–±–æ —É–≤–µ–ª–∏—á–∏—Ç—å, –ª–∏–±–æ —É–º–µ–Ω—å—à–∏—Ç—å —Ç–∞–∫, —á—Ç–æ $a$ —Å–Ω–æ–≤–∞ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ $i$-–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞). –ó–Ω–∞—á–∏—Ç –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ $\\operatorname{siftUp(i)}$ –∏–ª–∏ $\\operatorname{siftDown(i)}$ $a$ —Å–Ω–æ–≤–∞ —Å—Ç–∞–Ω–µ—Ç –∫—É—á–µ–π. –ï—Å–ª–∏ –º—ã –≤—ã–∑–æ–≤–µ–º –æ–±–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, —Ç–æ –æ–¥–Ω–∞ –∏–∑ –Ω–∏—Ö ‚Äú–ø–æ—á–∏–Ω–∏—Ç‚Äù –∫—É—á—É, –∞ –≤—Ç–æ—Ä–∞—è –Ω–∏—á–µ–≥–æ –Ω–µ —Å–¥–µ–ª–∞–µ—Ç. –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã $O(\\log n)$. ‚Äã –ø—Å–µ–≤–¥–æ–∫–æ–¥ 1 2 3 4 5 6 delete(i): swap(a[i], a[sz]) sz -= 1 if i \u003c= sz: siftUp(i) siftDown(i) –¢–æ—á–Ω–æ —Ç–∞–∫ –∂–µ –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ —É –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞. –ü—É—Å—Ç—å –æ–±—ä–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫—É—á–µ –≤ –ø–æ–∑–∏—Ü–∏–∏ $i$, —Ç–æ–≥–¥–∞ –ø–æ–º–µ–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –∏ —Å–Ω–æ–≤–∞ –∑–∞–ø—É—Å—Ç–∏–º $\\operatorname{siftUp(i)}$, $\\operatorname{siftDown(i)}$. –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–æ–≤–Ω–æ –ø–æ —Ç–µ–º –∂–µ –ø—Ä–∏—á–∏–Ω–∞–º, —á—Ç–æ –∏ –≤ —Å–ª—É—á–∞–µ —É–¥–∞–ª–µ–Ω–∏—è. –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–Ω–æ–≤–∞ $O(\\log n)$. ‚Äã –ø—Å–µ–≤–¥–æ–∫–æ–¥ 1 2 3 4 change(i, x): a[i] = x siftUp(i) siftDown(i) ‚úçÔ∏è –°—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –∫—É—á–∏, –æ–±–ª–∞–¥–∞—é—â–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª–µ–∑–Ω—ã–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏. –§–∏–±–æ–Ω–∞—á—á–∏–µ–≤—ã –∫—É—á–∏ (Fredman, Tarjan, 1987) –∏–∑–≤–µ—Å—Ç–Ω—ã —Ç–µ–º, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è—é—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º –∑–∞ $O(1)$ –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –º–∏–Ω–∏–º—É–º, –Ω–æ –∏ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç, –∞ —Ç–∞–∫–∂–µ —É–º–µ–Ω—å—à–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞. –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º –∑–∞ $O(\\log n)$. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∏–±–æ–Ω–∞—á—á–∏–µ–≤–æ–π –∫—É—á–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ª—É—á—à–∏—Ç—å —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫—É—é –æ—Ü–µ–Ω–∫—É –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤. –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –∏–∑-–∑–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –±–æ–ª—å—à–æ–π –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ –æ—Ü–µ–Ω–∫–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —Ñ–∏–±–æ–Ω–∞—á—á–∏–µ–≤—ã –∫—É—á–∏, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ –±—ã—Å—Ç—Ä–µ–µ –æ–±—ã—á–Ω—ã—Ö, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∏ –∏–º–µ—é—Ç —Å–∫–æ—Ä–µ–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å.",
    "description": "–ü—É—Å—Ç—å –º—ã —Ö–æ—Ç–∏–º –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –±—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–∞ –Ω—ë–º —Å–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏: –¥–æ–±–∞–≤–ª—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã, –∞ —Ç–∞–∫–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—å –º–∏–Ω–∏–º—É–º.\n–ú–æ–∂–Ω–æ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ —Å –ø–æ–º–æ—â—å—é –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –∏–ª–∏ —Å–ø–∏—Å–∫–∞. –¢–æ–≥–¥–∞ –º—ã —Å–º–æ–∂–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∑–∞ $O(1)$ (—á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –º–∞—Å—Å–∏–≤–∞, –ø–æ–º–µ–Ω—è–µ–º –µ–≥–æ –º–µ—Å—Ç–∞–º–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º, –ø–æ—Å–ª–µ —á–µ–≥–æ —É–º–µ–Ω—å—à–∏–º –¥–ª–∏–Ω—É –º–∞—Å—Å–∏–≤–∞ –Ω–∞ –æ–¥–∏–Ω). –û–¥–Ω–∞–∫–æ –±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –º–∏–Ω–∏–º—É–º –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è: –º–æ–∂–Ω–æ –ø—ã—Ç–∞—Ç—å—Å—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç, –Ω–æ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –º–∏–Ω–∏–º—É–º–∞ –Ω–æ–≤—ã–π –º–∏–Ω–∏–º—É–º –ø–æ–ª—É—á–∏—Ç—Å—è –Ω–∞–π—Ç–∏ –ª–∏—à—å –ø–µ—Ä–µ–±–æ—Ä–æ–º –≤—Å–µ—Ö –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∑–∞ $\\Theta(n)$ (–≥–¥–µ $n$ - —á–∏—Å–ª–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–µ). –ú–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ (—Ç–æ–≥–¥–∞ –º–∏–Ω–∏–º—É–º –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –≤ –Ω–∞—á–∞–ª–µ), –Ω–æ —Ç–æ–≥–¥–∞ –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è –±—ã—Å—Ç—Ä–æ –¥–æ–±–∞–≤–ª—è—Ç—å –∏–ª–∏ —É–¥–∞–ª—è—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç.",
    "tags": [],
    "title": "7. –î–≤–æ–∏—á–Ω–∞—è –∫—É—á–∞",
    "uri": "/basics/heap/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.¬†\u003e¬†17. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ",
    "content": "–ú–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–µ—Ä—à–∏–Ω –≤ –≥—Ä–∞—Ñ–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ (independent), –µ—Å–ª–∏ –Ω–∏–∫–∞–∫–∞—è –ø–∞—Ä–∞ –≤–µ—Ä—à–∏–Ω –≤ –Ω—ë–º –Ω–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∞ —Ä–µ–±—Ä–æ–º.\n–î–∞–Ω–æ –¥–µ—Ä–µ–≤–æ, –∫–∞–∂–¥–∞—è –≤–µ—Ä—à–∏–Ω–∞ $v$ –∫–æ—Ç–æ—Ä–æ–≥–æ –∏–º–µ–µ—Ç –≤–µ—Å $w_{v}$. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Å—É–º–º–∞—Ä–Ω–æ–≥–æ –≤–µ—Å–∞.\n‚úçÔ∏è –ù–µ–≤–∑–≤–µ—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —ç—Ç–æ–π –∑–∞–¥–∞—á–∏ (–≤—Å–µ –≤–µ—Å–∞ —Ä–∞–≤–Ω—ã –µ–¥–∏–Ω–∏—Ü–µ) —Ä–µ—à–∞–µ—Ç—Å—è –∂–∞–¥–Ω—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º.\n–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –ø–æ–¥–¥–µ—Ä–µ–≤—å—è–º –í—ã–±–µ—Ä–µ–º –ª—é–±—É—é –≤–µ—Ä—à–∏–Ω—É $r$ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ—Ä–Ω—è –¥–µ—Ä–µ–≤–∞. –¢–µ–ø–µ—Ä—å –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω–µ –¥–µ—Ä–µ–≤–∞ $v$ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–¥–∑–∞–¥–∞—á–∞ –ø–æ–∏—Å–∫–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–µ—Å–∞ –≤ –ø–æ–¥–¥–µ—Ä–µ–≤–µ —ç—Ç–æ–π –≤–µ—Ä—à–∏–Ω—ã; –æ–±–æ–∑–Ω–∞—á–∏–º –∏—Å–∫–æ–º–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞ $I_{v}$. –ö–∞–∫ –≤—ã—Ä–∞–∑–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏ –¥–ª—è –≤–µ—Ä—à–∏–Ω—ã $v$ —á–µ—Ä–µ–∑ –ø–æ–¥–∑–∞–¥–∞—á–∏ –ø–æ–ø—Ä–æ—â–µ? –ï—Å–ª–∏ —Å–∞–º–∞ –≤–µ—Ä—à–∏–Ω–∞ $v$ –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ $I_{v}$, —Ç–æ $I_{v}$ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ $I_{u}$ –ø–æ –≤—Å–µ–º $u$ - –¥–µ—Ç—è–º $v$. –ï—Å–ª–∏ –∂–µ $v$ –≤—Ö–æ–¥–∏—Ç –≤ $I_{v}$, —Ç–æ –Ω–∏–∫—Ç–æ –∏–∑ –¥–µ—Ç–µ–π $v$ –≤ $I_{v}$ –≤—Ö–æ–¥–∏—Ç—å –Ω–µ –º–æ–∂–µ—Ç. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ $I_{v}$ - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ $I_{u}$ –ø–æ –≤—Å–µ–º $u$ - ‚Äú–≤–Ω—É–∫–∞–º‚Äù $v$ - –¥–µ—Ç—è–º –¥–µ—Ç–µ–π $v$.\n–ü—É—Å—Ç—å\n$$ I[v]=\\sum_{u \\in I_{v}} w_{u} $$–£–¥–æ–±–Ω–æ —Ç–∞–∫–∂–µ –≤–≤–µ—Å—Ç–∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é –≤–µ–ª–∏—á–∏–Ω—É\n$$ J[v]=\\sum_{u-\\text { —Ä–µ–±—ë–Ω–æ–∫ } v} I[u] . $$–ò–∑ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π –≤—ã—à–µ –ø–æ–ª—É—á–∞–µ–º\n$$ I[v]=\\max \\left(J[v], w_{v}+\\sum_{u-\\text { —Ä–µ–±—ë–Ω–æ–∫ } v} J[u]\\right) . $$–¢–µ–ø–µ—Ä—å –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è $I$, $J$ –ª–µ–≥–∫–æ –≤—ã—á–∏—Å–ª–∏—Ç—å, –∑–∞–ø—É—Å—Ç–∏–≤ –ø–æ–∏—Å–∫ –≤ –≥–ª—É–±–∏–Ω—É –∏–∑ $r$. –ü–æ–ª—É—á–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O(V+E)$.\n1 2 3 4 5 6 7 8 9 dfs(v, parent): I[v] = w[v], J[v] = 0 for u in to[v]: if u == parent: continue dfs(u, v) I[v] += J[u], J[v] += I[u] I[v] = max(I[v], J[v]) dfs(0, -1) # r = 0 –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞\n1 2 3 4 5 6 7 8 9 10 11 # skip = True, –µ—Å–ª–∏ –≤–µ—Ä—à–∏–Ω–∞ v —Ç–æ—á–Ω–æ –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ –æ—Ç–≤–µ—Ç restoreSet(v, parent, skip): childSkip = False if (not skip) and I[v] \u003e J[v]: # v –≤—Ö–æ–¥–∏—Ç –≤ –æ—Ç–≤–µ—Ç res.push_back(v) childSkip = True # –¥–µ—Ç–∏ v –≤ –æ—Ç–≤–µ—Ç –Ω–µ –≤—Ö–æ–¥—è—Ç for u in to[v]: if u == parent: continue restoreSet(u, v, childSkip) restoreSet(0, -1, False)",
    "description": "–ú–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–µ—Ä—à–∏–Ω –≤ –≥—Ä–∞—Ñ–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ (independent), –µ—Å–ª–∏ –Ω–∏–∫–∞–∫–∞—è –ø–∞—Ä–∞ –≤–µ—Ä—à–∏–Ω –≤ –Ω—ë–º –Ω–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∞ —Ä–µ–±—Ä–æ–º.\n–î–∞–Ω–æ –¥–µ—Ä–µ–≤–æ, –∫–∞–∂–¥–∞—è –≤–µ—Ä—à–∏–Ω–∞ $v$ –∫–æ—Ç–æ—Ä–æ–≥–æ –∏–º–µ–µ—Ç –≤–µ—Å $w_{v}$. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Å—É–º–º–∞—Ä–Ω–æ–≥–æ –≤–µ—Å–∞.\n‚úçÔ∏è –ù–µ–≤–∑–≤–µ—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —ç—Ç–æ–π –∑–∞–¥–∞—á–∏ (–≤—Å–µ –≤–µ—Å–∞ —Ä–∞–≤–Ω—ã –µ–¥–∏–Ω–∏—Ü–µ) —Ä–µ—à–∞–µ—Ç—Å—è –∂–∞–¥–Ω—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º.\n–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –ø–æ–¥–¥–µ—Ä–µ–≤—å—è–º –í—ã–±–µ—Ä–µ–º –ª—é–±—É—é –≤–µ—Ä—à–∏–Ω—É $r$ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ—Ä–Ω—è –¥–µ—Ä–µ–≤–∞. –¢–µ–ø–µ—Ä—å –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω–µ –¥–µ—Ä–µ–≤–∞ $v$ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–¥–∑–∞–¥–∞—á–∞ –ø–æ–∏—Å–∫–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–µ—Å–∞ –≤ –ø–æ–¥–¥–µ—Ä–µ–≤–µ —ç—Ç–æ–π –≤–µ—Ä—à–∏–Ω—ã; –æ–±–æ–∑–Ω–∞—á–∏–º –∏—Å–∫–æ–º–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞ $I_{v}$. –ö–∞–∫ –≤—ã—Ä–∞–∑–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏ –¥–ª—è –≤–µ—Ä—à–∏–Ω—ã $v$ —á–µ—Ä–µ–∑ –ø–æ–¥–∑–∞–¥–∞—á–∏ –ø–æ–ø—Ä–æ—â–µ? –ï—Å–ª–∏ —Å–∞–º–∞ –≤–µ—Ä—à–∏–Ω–∞ $v$ –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ $I_{v}$, —Ç–æ $I_{v}$ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ $I_{u}$ –ø–æ –≤—Å–µ–º $u$ - –¥–µ—Ç—è–º $v$. –ï—Å–ª–∏ –∂–µ $v$ –≤—Ö–æ–¥–∏—Ç –≤ $I_{v}$, —Ç–æ –Ω–∏–∫—Ç–æ –∏–∑ –¥–µ—Ç–µ–π $v$ –≤ $I_{v}$ –≤—Ö–æ–¥–∏—Ç—å –Ω–µ –º–æ–∂–µ—Ç. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ $I_{v}$ - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ $I_{u}$ –ø–æ –≤—Å–µ–º $u$ - ‚Äú–≤–Ω—É–∫–∞–º‚Äù $v$ - –¥–µ—Ç—è–º –¥–µ—Ç–µ–π $v$.",
    "tags": [],
    "title": "–ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–µ—Å–∞ –≤ –¥–µ—Ä–µ–≤–µ",
    "uri": "/basics/dynamic_programming/independent_set_of_maximum_weight_in_tree/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.¬†\u003e¬†17. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ",
    "content": "–ö–æ–º–º–∏–≤–æ—è–∂—ë—Ä (travelling salesman) —Ö–æ—á–µ—Ç –ø–æ—Å–µ—Ç–∏—Ç—å –∫–∞–∂–¥—ã–π –∏–∑ $n$ –≥–æ—Ä–æ–¥–æ–≤ –ø–æ –æ–¥–Ω–æ–º—É —Ä–∞–∑—É –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ —Å–≤–æ–π —Ä–æ–¥–Ω–æ–π –≥–æ—Ä–æ–¥. –û–Ω –∑–Ω–∞–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –≤—Å–µ–º–∏ –ø–∞—Ä–∞–º–∏ –≥–æ—Ä–æ–¥–æ–≤. –ö–∞–∫–æ–π –ø–æ—Ä—è–¥–æ–∫ –ø–æ—Å–µ—â–µ–Ω–∏—è –≥–æ—Ä–æ–¥–æ–≤ –æ–ø—Ç–∏–º–∞–ª–µ–Ω?\n–ë–æ–ª–µ–µ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ: –¥–∞–Ω –ø–æ–ª–Ω—ã–π (–µ—Å—Ç—å —Ä–µ–±—Ä–æ –º–µ–∂–¥—É –∫–∞–∂–¥–æ–π –ø–∞—Ä–æ–π –≤–µ—Ä—à–∏–Ω) –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π –Ω–µ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥—Ä–∞—Ñ –Ω–∞ $n$ –≤–µ—Ä—à–∏–Ω–∞—Ö; –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –≥–∞–º–∏–ª—å—Ç–æ–Ω–æ–≤ —Ü–∏–∫–ª (—Ü–∏–∫–ª, –ø—Ä–æ—Ö–æ–¥—è—â–∏–π –ø–æ –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω–µ —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑), –∏–º–µ—é—â–∏–π –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω—É—é –¥–ª–∏–Ω—É. –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –≤–µ—Ä—à–∏–Ω–∞–º–∏ $u$ –∏ $v$ –±—É–¥–µ–º –æ–±–æ–∑–Ω–∞—á–∞—Ç—å –∫–∞–∫ $d_{u, v}$.\n–í—Å–µ–≥–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ $(n-1)$ !, –ø–æ—ç—Ç–æ–º—É –ø–µ—Ä–µ–±–æ—Ä –∏—Ö –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–µ–Ω –ª–∏—à—å –ø—Ä–∏ –Ω–µ–±–æ–ª—å—à–∏—Ö $n$. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º —ç—Ç—É –∑–∞–¥–∞—á—É –º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å –∑–∞ $O\\left(2^{n} \\cdot n^{2}\\right)$, —á—Ç–æ —É–∂–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ (—Ö–æ—Ç—è –æ—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤—Å—ë –µ—â—ë —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞).\n–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–æ–¥–∑–∞–¥–∞—á–∞ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ - –∑–∞–¥–∞—á–∞ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è ‚Äú–ø—Ä–µ—Ñ–∏–∫—Å–∞‚Äù –º–∞—Ä—à—Ä—É—Ç–∞ (–ø–µ—Ä–≤—ã—Ö –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä—ë–±–µ—Ä –º–∞—Ä—à—Ä—É—Ç–∞, –Ω–∞—á–∏–Ω–∞—è –∏–∑ —Ä–æ–¥–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –∫–æ–º–º–∏–≤–æ—è–∂—ë—Ä–∞; –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ —ç—Ç–æ—Ç –≥–æ—Ä–æ–¥ –∏–º–µ–µ—Ç –Ω–æ–º–µ—Ä 0). –ö–∞–∫ –º–æ–∂–Ω–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—á–∞–ª–æ –º–∞—Ä—à—Ä—É—Ç–∞? –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–µ—Ñ–∏–∫—Å –º–∞—Ä—à—Ä—É—Ç–∞ –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø—Ä–æ–¥–ª–∏—Ç—å (–∏–ª–∏, –Ω–∞–æ–±–æ—Ä–æ—Ç, —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å –±–µ–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–±—Ä–∞), –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–Ω–∞—Ç—å, –∫–∞–∫–∏–µ –≤–µ—Ä—à–∏–Ω—ã –≤—Ö–æ–¥—è—Ç –≤ –ø—Ä–µ—Ñ–∏–∫—Å, –∞ —Ç–∞–∫–∂–µ –∫–∞–∫–∞—è –∏–∑ –Ω–∏—Ö —è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–µ–π. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑—É–µ—Ç—Å—è –ø–∞—Ä–æ–π $(A, v)$, –≥–¥–µ $A$ - –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–µ—Ä—à–∏–Ω –≥—Ä–∞—Ñ–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ –≤–µ—Ä—à–∏–Ω—É 0 , $v \\in A$ - –Ω–æ–º–µ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—à–∏–Ω—ã –≤ –ø—Ä–µ—Ñ–∏–∫—Å–µ –º–∞—Ä—à—Ä—É—Ç–∞.\n–ù–∞—á–∞–ª—å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è: $l[\\{0\\}, 0]=0 ; l[A, 0]=\\infty$ –ø—Ä–∏ $|A|\u003e1$. –î–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–±—Ä–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Ä–µ–±—Ä–æ –ø—Ä–µ—Ñ–∏–∫—Å–∞ –º–∞—Ä—à—Ä—É—Ç–∞: –ø—É—Å—Ç—å $v \\neq 0, v \\in A$, —Ç–æ–≥–¥–∞\n$$ l[A, v]=\\min _{\\substack{u \\in A, u \\neq v}}\\left(l[A \\backslash\\{v\\}, u]+d_{u, v}\\right) $$–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –∑–∞–¥–∞—á—É –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–±—Ä–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—à–∏–Ω—É –º–∞—Ä—à—Ä—É—Ç–∞: –æ—Ç–≤–µ—Ç —Ä–∞–≤–µ–Ω\n$$ \\min _{v\u003e0}\\left(l[A, v]+d_{v, 0}\\right) . $$–ü—Ä–µ–∂–¥–µ, —á–µ–º –ø–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –Ω—É–∂–Ω–æ –Ω–∞—É—á–∏—Ç—å—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –º–∞—Å—Å–∏–≤–∞, –∞ —Ç–∞–∫–∂–µ –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –Ω–∞–¥ –º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞).\n–†–∞–±–æ—Ç–∞ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ –ü—Ä–æ–Ω—É–º–µ—Ä—É–µ–º –≤—Å–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ $n$-—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ $U=\\{0, \\ldots, n-1\\} n$-–±–∏—Ç–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏: $A \\subset U$ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º $\\operatorname{mask}(A)=\\sum_{i \\in A} 2^{i}$. –ù–æ–º–µ—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —É–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏–Ω–¥–µ–∫—Å–∞ –º–∞—Å—Å–∏–≤–∞; —Ç–∞–∫–∂–µ —Å –ø–æ–º–æ—â—å—é –±–∏—Ç–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞–¥ —á–∏—Å–ª–∞–º–∏ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ\n–æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏. –ü—Ä–∏–≤–µ–¥—ë–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤:\n$\\operatorname{mask}(A \\cup B)=\\operatorname{mask}(A) \\mid \\operatorname{mask}(B)$, –≥–¥–µ $\\mid$ - –±–∏—Ç–æ–≤–æ–µ ‚Äú–ò–õ–ò‚Äù; $\\operatorname{mask}(A \\cap B)=\\operatorname{mask}(A) \\\u0026 \\operatorname{mask}(B)$, –≥–¥–µ \u0026 - –±–∏—Ç–æ–≤–æ–µ ‚Äú–ò‚Äù; $\\operatorname{mask}(A \\oplus B)=\\operatorname{mask}(A) \\oplus \\operatorname{mask}(B)$, –≥–¥–µ $\\oplus$ —Å–ª–µ–≤–∞ - —Å–∏–º–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–Ω–æ—Å—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤, –∞ $\\oplus$ —Å–ø—Ä–∞–≤–∞ - –±–∏—Ç–æ–≤—ã–π ‚ÄúXOR‚Äù; $\\operatorname{mask}(A \\backslash B)=\\operatorname{mask}(A) \\\u0026 \\sim \\operatorname{mask}(B)$, –≥–¥–µ $\\sim$ - –±–∏—Ç–æ–≤–æ–µ –æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ; $\\operatorname{mask}(U)=(1 \\ll n)-1$, –≥–¥–µ $\\ll k$ - –±–∏—Ç–æ–≤—ã–π —Å–¥–≤–∏–≥ –Ω–∞ $k$ –±–∏—Ç –≤–ª–µ–≤–æ; $\\operatorname{mask}(\\{k\\})=1 \\ll k$; $(\\operatorname{mask}(A) \\gg k) \\\u0026 1$ - –≤—ã—Ä–∞–∂–µ–Ω–∏–µ, —Ä–∞–≤–Ω–æ–µ –µ–¥–∏–Ω–∏—Ü–µ —Ç–æ–≥–¥–∞ –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ $k \\in A$ (–∑–¥–µ—Å—å $\\gg k$ - –±–∏—Ç–æ–≤—ã–π —Å–¥–≤–∏–≥ –Ω–∞ $k$ –±–∏—Ç –≤–ø—Ä–∞–≤–æ). –í C++ –≤—Å–µ –±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º ‚ÄúXOR‚Äù, –æ–±–æ–∑–Ω–∞—á–∞—é—Ç—Å—è —Ç–µ–º–∏ –∂–µ —Å–∏–º–≤–æ–ª–∞–º–∏, —á—Ç–æ –∏ –≤—ã—à–µ; ^ - –±–∏—Ç–æ–≤—ã–π ‚ÄúXOR‚Äù –≤ C++. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ —á–∏—Å–ª–æ–≤—ã–º–∏ —Ç–∏–ø–∞–º–∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—é—Ç—Å—è –∑–∞ $O(1)$. –ú—ã –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ —Ä–∞–∑–º–µ—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤, –ø–æ—ç—Ç–æ–º—É –≤—Å–µ –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã–µ –≤—ã—à–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –∑–∞ $O(1)$.\n–†–∞–∑–º–µ—Ä –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤ –í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ –≤—ã—á–∏—Å–ª–∏–º —Ä–∞–∑–º–µ—Ä –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ $A \\subset U$. –†–∞–∑–º–µ—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–µ–Ω—É–ª–µ–≤—ã—Ö –±–∏—Ç –≤ –µ–≥–æ –Ω–æ–º–µ—Ä–µ. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—á–Ω—ã—Ö –±–∏—Ç –≤ —á–∏—Å–ª–µ $x$ —Ä–∞–≤–Ω—è–µ—Ç—Å—è —Å—É–º–º–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –µ–¥–∏–Ω–∏—á–Ω—ã—Ö –±–∏—Ç –≤ $\\left\\lfloor\\frac{x}{2}\\right\\rfloor$ –∏ –∑–Ω–∞—á–µ–Ω–∏—è –º–ª–∞–¥—à–µ–≥–æ –±–∏—Ç–∞ $x$.\n1 2 3 size[0] = 0 # —Ä–∞–∑–º–µ—Ä –ø—É—Å—Ç–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ä–∞–≤–µ–Ω 0 for mask = 1..((1 \u003c\u003c n) - 1): size[mask] = size[mask \u003e\u003e 1] + (mask \u0026 1) ‚úçÔ∏è –í –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–µ C++ GCC –µ—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è $\\texttt{__builtin_popcount}(x)$, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è —á–∏—Å–ª–æ –±–∏—Ç –≤ —á–∏—Å–ª–µ $x$ —Ç–∏–ø–∞ $\\texttt{int}$ (–µ—Å—Ç—å –ø–æ–¥–æ–±–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤); –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ $O(1)$, –Ω–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä, —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã–µ –±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.\n–°—É–º–º–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–µ –ü—É—Å—Ç—å –µ—Å—Ç—å $n$ —á–∏—Å–µ–ª $a_{0}, \\ldots, a_{n-1}$; –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ $A \\subset\\{0, \\ldots, n-1\\}$ –≤—ã—á–∏—Å–ª–∏—Ç—å $s(A)=\\sum_{i \\in A} a_{i}$. –ú–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –∫–∞–∂–¥—É—é —Å—É–º–º—É –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é:\nfor mask = 0..((1 \u003c\u003c n) - 1): s[mask] = 0 for i = 0..(n - 1): if ((mask \u003e\u003e i) \u0026 1): # i –ª–µ–∂–∏—Ç –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–µ —Å –Ω–æ–º–µ—Ä–æ–º mask s[mask] += a[i] –≠—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç $O\\left(2^{n} \\cdot n\\right)$ –≤—Ä–µ–º–µ–Ω–∏. –ú–æ–∂–Ω–æ —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ—Å—Ç–æ–≥–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è: –ø—É—Å—Ç—å $x \\in A$ - –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å —ç–ª–µ–º–µ–Ω—Ç $A$, —Ç–æ–≥–¥–∞ $s(A)=$ $s(A \\backslash\\{x\\})+a_{x}$. –ü—Ä–∏ —ç—Ç–æ–º, –ø–æ—Å–∫–æ–ª—å–∫—É –º—ã –≤—ã—á–∏—Å–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è $s$ –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤ –º–Ω–æ–∂–µ—Å—Ç–≤, –∞ $\\operatorname{mask}(A \\backslash\\{x\\})\u003c\\operatorname{mask}(A), s(A \\backslash\\{x\\})$ —É–∂–µ –±—É–¥–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω–æ –∫ –º–æ–º–µ–Ω—Ç—É –≤—ã—á–∏—Å–ª–µ–Ω–∏—è $s(A)$. –í –∫–∞—á–µ—Å—Ç–≤–µ $x$ —É–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç $A$ : —Ç–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞—Ä—à–µ–º—É –±–∏—Ç—É $\\operatorname{mask}(A)$, –Ω–æ–º–µ—Ä –∫–æ—Ç–æ—Ä–æ–≥–æ –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ –≤–æ–∑—Ä–∞—Å—Ç–∞—Ç—å –ø—Ä–∏ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏–∏ –Ω–æ–º–µ—Ä–∞. –ü–æ–ª—É—á–∞–µ–º —Å–ª–µ–¥—É—é—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O\\left(2^{n}\\right)$ :\n1 2 3 4 5 6 x = 0 s[0] = 0 for mask = 1..((1\u003c\u003c n) - 1): if mask == (1 \u003c\u003c (x + 1)): # –Ω–æ–º–µ—Ä —Å—Ç–∞—Ä—à–µ–≥–æ –±–∏—Ç–∞ —É–≤–µ–ª–∏—á–∏–ª—Å—è x += 1 s[mask] = s[mask - (1 \u003c\u003c x)] + a[x] –°—É–º–º–∞ –ø–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞–º –ü—É—Å—Ç—å —Ç–µ–ø–µ—Ä—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ $A \\subset\\{0, \\ldots, n-1\\}$ –¥–∞–Ω–æ —á–∏—Å–ª–æ $f_{A}$, –∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ $A$ –≤—ã—á–∏—Å–ª–∏—Ç—å $s(A)=\\sum_{B \\subset A} f_{B}$.\n–ú–æ–∂–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ $A$ –ø–µ—Ä–µ–±—Ä–∞—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ $B$ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫–∏–µ –∏–∑ –Ω–∏—Ö —è–≤–ª—è—é—Ç—Å—è –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ $A$; –ø–æ–ª—É—á–∏—Ç—Å—è —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O\\left(2^{n} \\cdot 2^{n}\\right)=O\\left(4^{n}\\right)$.\n1 2 3 4 5 for A = 0..((1 \u003c\u003c n) - 1): g[A] = 0 for B = 0..((1\u003c\u003c n) - 1): if (A \u0026 B) == B: # B - –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ A g[A] += f[B] –ú–æ–∂–Ω–æ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –∞–∫–∫—É—Ä–∞—Ç–Ω–µ–µ, –∏ –¥–ª—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ $A$ —Å—Ä–∞–∑—É –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ $B$, —è–≤–ª—è—é—â–∏–µ—Å—è –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ $A$. –ë—É–¥–µ–º –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ $A$ –≤ –ø–æ—Ä—è–¥–∫–µ —É–º–µ–Ω—å—à–µ–Ω–∏—è –∏—Ö –Ω–æ–º–µ—Ä–æ–≤. –ü—É—Å—Ç—å $A=\\left\\{a_{0}, \\ldots, a_{k-1}\\right\\}, a_{0}\u003c\\cdots \u003c a_{k-1}$. –ï—Å–ª–∏ –º—ã –º—ã—Å–ª–µ–Ω–Ω–æ —Å–¥–≤–∏–Ω–µ–º —Ä–∞–∑—Ä—è–¥—ã $a_{0}, \\ldots, a_{k-1}$ –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ $0, \\ldots, k-1$, —Ç–æ –Ω–æ–º–µ—Ä–∞ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤ $A$ –ø–µ—Ä–µ–π–¥—É—Ç –≤ —á–∏—Å–ª–∞ –æ—Ç 0 –¥–æ $2^{k}-1$. –ó–Ω–∞—á–∏—Ç, –º—ã —Ö–æ—Ç–∏–º –ø–µ—Ä–µ–±—Ä–∞—Ç—å —á–∏—Å–ª–∞ –æ—Ç 0 –¥–æ $2^{k}-1$ –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è, —Ç–æ–ª—å–∫–æ —Å–æ —Å–¥–≤–∏–Ω—É—Ç—ã–º–∏ —Ä–∞–∑—Ä—è–¥–∞–º–∏: –Ω—É–ª–µ–≤–æ–π —Ä–∞–∑—Ä—è–¥ –Ω—É–∂–Ω–æ —Å–¥–≤–∏–Ω—É—Ç—å –≤ $a_{0}$-–π,‚Ä¶ $(k-1)$-–π —Ä–∞–∑—Ä—è–¥ ‚Äî –≤ $a_{k-1}$-–π.\n–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ —á–∏—Å–ª—É $i$ –ø–æ–ª—É—á–∏—Ç—å —á–∏—Å–ª–æ $i-1$, –Ω—É–∂–Ω–æ –∑–∞–Ω—É–ª–∏—Ç—å –º–ª–∞–¥—à–∏–π –µ–¥–∏–Ω–∏—á–Ω—ã–π –±–∏—Ç $i$, –∞ –≤–æ –≤—Å–µ –±–∏—Ç—ã –º–ª–∞–¥—à–µ –µ–≥–æ –∑–∞–ø–∏—Å–∞—Ç—å –µ–¥–∏–Ω–∏—Ü—É. –ó–Ω–∞—á–∏—Ç, –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤—É $B \\subset A$ —Å–ª–µ–¥—É—é—â–µ–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ $A$ –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤, –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏–∑ $B$ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç $x \\in B$ –∏ –¥–æ–±–∞–≤–∏—Ç—å –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ $A \\backslash B$, –º–µ–Ω—å—à–∏–µ $x$. –≠—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ñ–æ—Ä–º—É–ª–µ $(\\operatorname{mask}(B)-1) \\\u0026 \\operatorname{mask}(A)$.\n1 2 3 4 for A = 0..((1\u003c\u003c n) - 1): g[A] = f[0] # —É—á–ª–∏ –ø—É—Å—Ç–æ–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ for (B = A; B \u003e 0; B = (( B - 1) \u0026 A)): # –≤—Å–µ –Ω–µ–ø—É—Å—Ç—ã–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ A g[A] += f[B] –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–∞—Ä $(A, B)$ —Ç–∞–∫–∏—Ö, —á—Ç–æ $B \\subset A$. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–∫–∏—Ö –ø–∞—Ä —Ä–∞–≤–Ω—è–µ—Ç—Å—è $3^{n}$. –≠—Ç–æ –º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–º —Å–ø–æ—Å–æ–±–æ–º: –º–Ω–æ–∂–µ—Å—Ç–≤–æ $A$ —Ä–∞–∑–º–µ—Ä–∞ $k$ –∏–º–µ–µ—Ç $2^{k}$ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–Ω–æ–∂–µ—Å—Ç–≤ —Ä–∞–∑–º–µ—Ä–∞ $k$ —Ä–∞–≤–Ω–æ $\\binom{n}{k}$, –∑–Ω–∞—á–∏—Ç, –≤—Å–µ–≥–æ –ø–∞—Ä $(A, B)$\n$$ \\sum_{k=0}^{n}\\binom{n}{k} \\cdot 2^{k}=\\sum_{k=0}^{n}\\binom{n}{k} \\cdot 2^{k} \\cdot 1^{n-k}=(2+1)^{n}=3^{n} $$–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±: –µ—Å–ª–∏ –ø–∞—Ä–∞ $(A, B)$ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞, —Ç–æ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –æ–¥–Ω–æ–º –∏–∑ —Ç—Ä—ë—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π: –ª–µ–∂–∏—Ç –≤ $A$, –ª–µ–∂–∏—Ç –≤ $A \\backslash B$ –∏–ª–∏ –∂–µ –Ω–µ –ª–µ–∂–∏—Ç –≤ $A$. –í—Å–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ $n$, –∑–Ω–∞—á–∏—Ç, –≤—Å–µ–≥–æ $3^{n}$ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤.\n–ò—Ç–∞–∫, –º—ã –ø–æ–ª—É—á–∏–ª–∏ —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O\\left(3^{n}\\right)$. –ú–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞—á—É –µ—â—ë –±—ã—Å—Ç—Ä–µ–µ. –ü—É—Å—Ç—å\n$$ g[A, k]=\\sum_{\\substack{B \\subset A, A \\backslash B \\subset\\{0, \\ldots, k-1\\}}} f_{B} $$–ù–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è $g[A, n]=g(A)$. –ù–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: $g[A, 0]=f_{A}$. –ü–µ—Ä–µ—Ö–æ–¥:\n$$ g[A, k+1]= \\begin{cases}g[A, k], \u0026 \\text { –µ—Å–ª–∏ } k \\notin A, \\\\ g[A, k]+g[A \\backslash\\{k\\}, k], \u0026 \\text { –µ—Å–ª–∏ } k \\in A .\\end{cases} $$–ü–æ—á–µ–º—É —ç—Ç–æ —Ç–∞–∫? $g[A, k+1]$ - —Å—É–º–º–∞ $f_{B}$ –ø–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞–º $B \\subset A$, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç $A$ —Ç–æ–ª—å–∫–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å—é —ç–ª–µ–º–µ–Ω—Ç–æ–≤ $0, \\ldots, k$. –ï—Å–ª–∏ $k \\notin A$, –≤—Å–µ —Ç–∞–∫–∏–µ $B$ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç $A$ —Ç–æ–ª—å–∫–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å—é $0, \\ldots, k-1$, –∑–Ω–∞—á–∏—Ç, $g[A, k+1]=g[A, k]$. –ï—Å–ª–∏ –∂–µ $k \\in A$, —Ç–æ –≤—Å–µ —Ç–∞–∫–∏–µ $B$ –¥–µ–ª—è—Ç—Å—è –Ω–∞ –¥–≤–µ –≥—Ä—É–ø–ø—ã: —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç $k$, –∏ —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç. –°—É–º–º–∞ –ø–æ –ø–µ—Ä–≤–æ–π –≥—Ä—É–ø–ø–µ —Ä–∞–≤–Ω–∞ $g[A, k]$. –í—Å–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤–æ –≤—Ç–æ—Ä–æ–π –≥—Ä—É–ø–ø–µ —è–≤–ª—è—é—Ç—Å—è –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ $A \\backslash\\{k\\}$; —Å—É–º–º–∞ –ø–æ –≤—Ç–æ—Ä–æ–π –≥—Ä—É–ø–ø–µ —Ä–∞–≤–Ω–∞ $g[A \\backslash\\{k\\}, k]$.\n–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è $(A, k+1)$ –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç —Ç–æ–ª—å–∫–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $(A, k)$, –∏, –≤–æ–∑–º–æ–∂–Ω–æ $(A \\backslash\\{k\\}, k)$. –û–¥–Ω–∞–∫–æ –º—ã –ø–æ–ª—å–∑—É–µ–º—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º $g[A \\backslash\\{k\\}, k]$ —Ç–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ, –∫–æ–≥–¥–∞ $g[A \\backslash\\{k\\}, k]=g[A \\backslash\\{k\\}, k+1]$. –ó–Ω–∞—á–∏—Ç, –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–º –º–∞—Å—Å–∏–≤–æ–º –≤–º–µ—Å—Ç–æ –¥–≤—É–º–µ—Ä–Ω–æ–≥–æ. –ü–æ–ª—É—á–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O\\left(2^{n} \\cdot n\\right)$, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–µ $O\\left(2^{n}\\right)$ –ø–∞–º—è—Ç–∏.\n1 2 3 4 5 6 for mask = 0..((1 \u003c\u003c n) - 1): g[mask] = f[mask] for k = 0..(n - 1): for mask = 0..((1 \u003c\u003c n) - 1): if (mask \u003e\u003e k) \u0026 1: g[mask] += g[mask - (1 \u003c\u003c k)] –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∫–æ–º–º–∏–≤–æ—è–∂—ë—Ä–∞ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 fill(l, inf) l[1, 0] = 0 # 1 - –Ω–æ–º–µ—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–∞ 0 # –Ω–æ–º–µ—Ä–∞ –º–Ω–æ–∂–µ—Å—Ç–≤, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö 0 - –≤—Å–µ –Ω–µ—á—ë—Ç–Ω—ã–µ —á–∏—Å–ª–∞ for (mask = 1; mask \u003c (1 \u003c\u003c n); mask += 2): for v = 1..(n - 1): # –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—à–∏–Ω—É –ø—Ä–µ—Ñ–∏–∫—Å–∞ –º–∞—Ä—â—Ä—É—Ç–∞ if ((mask \u003e\u003e v) \u0026 1) == 0: # v –Ω–µ –ª–µ–∂–∏—Ç –≤ –ø—Ä–µ—Ñ–∏–∫—Å–µ continue for u = 0..(n - 1): # –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Ç–æ—Ä–æ–π –∫–æ–Ω–µ—Ü –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–±—Ä–∞ if u == v or ((mask \u003e\u003e u) \u0026 1) == 0: continue l[mask, v] = min(l[mask, v], l[mask - (1 \u003c\u003c v), u] + d[u, v]) res = inf for v = 1..(n - 1): res = min(res, l[(1 \u003c\u003c n) - 1, v] + d[v, 0]) –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏.",
    "description": "–ö–æ–º–º–∏–≤–æ—è–∂—ë—Ä (travelling salesman) —Ö–æ—á–µ—Ç –ø–æ—Å–µ—Ç–∏—Ç—å –∫–∞–∂–¥—ã–π –∏–∑ $n$ –≥–æ—Ä–æ–¥–æ–≤ –ø–æ –æ–¥–Ω–æ–º—É —Ä–∞–∑—É –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ —Å–≤–æ–π —Ä–æ–¥–Ω–æ–π –≥–æ—Ä–æ–¥. –û–Ω –∑–Ω–∞–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –≤—Å–µ–º–∏ –ø–∞—Ä–∞–º–∏ –≥–æ—Ä–æ–¥–æ–≤. –ö–∞–∫–æ–π –ø–æ—Ä—è–¥–æ–∫ –ø–æ—Å–µ—â–µ–Ω–∏—è –≥–æ—Ä–æ–¥–æ–≤ –æ–ø—Ç–∏–º–∞–ª–µ–Ω?\n–ë–æ–ª–µ–µ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ: –¥–∞–Ω –ø–æ–ª–Ω—ã–π (–µ—Å—Ç—å —Ä–µ–±—Ä–æ –º–µ–∂–¥—É –∫–∞–∂–¥–æ–π –ø–∞—Ä–æ–π –≤–µ—Ä—à–∏–Ω) –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π –Ω–µ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥—Ä–∞—Ñ –Ω–∞ $n$ –≤–µ—Ä—à–∏–Ω–∞—Ö; –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –≥–∞–º–∏–ª—å—Ç–æ–Ω–æ–≤ —Ü–∏–∫–ª (—Ü–∏–∫–ª, –ø—Ä–æ—Ö–æ–¥—è—â–∏–π –ø–æ –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω–µ —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑), –∏–º–µ—é—â–∏–π –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω—É—é –¥–ª–∏–Ω—É. –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –≤–µ—Ä—à–∏–Ω–∞–º–∏ $u$ –∏ $v$ –±—É–¥–µ–º –æ–±–æ–∑–Ω–∞—á–∞—Ç—å –∫–∞–∫ $d_{u, v}$.",
    "tags": [],
    "title": "–ó–∞–¥–∞—á–∞ –∫–æ–º–º–∏–≤–æ—è–∂—ë—Ä–∞",
    "uri": "/basics/dynamic_programming/travelling_salesman_problem/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è¬†\u003e¬†–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –í–µ—Å–Ω–∞ 2026.¬†\u003e¬†17. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ",
    "content": "–ù–∞—É—á–∏–º—Å—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω–æ–º—É –æ–±—ä–µ–∫—Ç—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–µ) –µ–≥–æ –Ω–æ–º–µ—Ä –≤ —Å–ø–∏—Å–∫–µ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (—Å–ø–∏—Å–∫–µ –≤—Å–µ—Ö –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã), —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–æ–º –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏; –∏–ª–∏, –Ω–∞–æ–±–æ—Ä–æ—Ç, –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç –ø–æ –µ–≥–æ –Ω–æ–º–µ—Ä—É.\n–≠—Ç–æ –±—ã–≤–∞–µ—Ç –ø–æ–ª–µ–∑–Ω–æ, –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç –∫–∞–∫ –º–æ–∂–Ω–æ –º–µ–Ω—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –±–∏—Ç, –∞ —Ç–∞–∫–∂–µ –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏–Ω–¥–µ–∫—Å–∞ –º–∞—Å—Å–∏–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –º–µ—Ç–æ–¥–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º).\n–ù–æ–º–µ—Ä –ø–æ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–µ –ö–∞–∫ –≤—ã—á–∏—Å–ª–∏—Ç—å –Ω–æ–º–µ—Ä –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ $p_{1}, \\ldots, p_{n}$ —á–∏—Å–µ–ª $1, \\ldots, n$ –≤ —Å–ø–∏—Å–∫–µ –≤—Å–µ—Ö –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫ –¥–ª–∏–Ω—ã $n$, —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã—Ö –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏? –ù–∞–ø—Ä–∏–º–µ—Ä, —É –Ω–∞—Å –µ—Å—Ç—å —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫ –¥–ª–∏–Ω—ã 3:\n$$ \\begin{array}{|l|l|} \\hline 0 \u0026 1,2,3 \\\\ \\hline 1 \u0026 1,3,2 \\\\ \\hline 2 \u0026 2,1,3 \\\\ \\hline 3 \u0026 2,3,1 \\\\ \\hline 4 \u0026 3,1,2 \\\\ \\hline 5 \u0026 3,2,1 \\\\ \\hline \\end{array} $$–ù–æ–º–µ—Ä –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ $p$ ‚Äî —ç—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫, –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –º–µ–Ω—å—à–∏—Ö $p$. –ü—É—Å—Ç—å $q$ ‚Äî –æ–¥–Ω–∞ –∏–∑ —Ç–∞–∫–∏—Ö –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫. –¢–æ–≥–¥–∞ $q_{1}=p_{1}, \\ldots, q_{k-1}=p_{k-1}, x=q_{k} \u003c p_{k}$ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ $k$. –ü—Ä–∏ —ç—Ç–æ–º –¥–ª—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö $k, x \u003c p_{k}$ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ( $n-k$ )! —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫ $q$, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–∏—Ö —É—Å–ª–æ–≤–∏—è–º –≤—ã—à–µ (—Ç–∞–∫ –∫–∞–∫ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è $n-k$ —á–∏—Å–µ–ª –º–æ–≥—É—Ç –∏–¥—Ç–∏ –≤ –ª—é–±–æ–º –ø–æ—Ä—è–¥–∫–µ).\n–ü–æ–ª—É—á–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º: –ø–µ—Ä–µ–±–µ—Ä—ë–º $k$ ‚Äî –ø–æ–∑–∏—Ü–∏—é —Å–∞–º–æ–≥–æ –ª–µ–≤–æ–≥–æ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏—è $q$ –∏ $p$, –ø–µ—Ä–µ–±–µ—Ä—ë–º $x \u003c p_{k}$ ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ $q_{k}$, –∏ –ø—Ä–æ—Å—É–º–º–∏—Ä—É–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫ $q$ –ø–æ –≤—Å–µ–º —Ç–∞–∫–∏–º $k, x$.\n1 2 3 4 5 6 7 8 9 10 getNum(p, n): num = 0 fill(used, False) # —Å–ø–∏—Å–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ p[1..k) for k = 1..n: for x = 1..(p[k] - 1): if used[x]: continue num += factorial[n - k] used[p[k]] = True return num –¢–æ—Ç –∂–µ –º–µ—Ç–æ–¥ (–ø–µ—Ä–µ–±—Ä–∞—Ç—å –ø–æ–∑–∏—Ü–∏—é –∏ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏—è, –ø—Ä–æ—Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å –ø–æ –Ω–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–æ—Å–æ–±–æ–≤ ‚Äú–∑–∞–∫–æ–Ω—á–∏—Ç—å‚Äù –æ–±—ä–µ–∫—Ç) —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Å–æ –º–Ω–æ–≥–∏–º–∏ –¥—Ä—É–≥–∏–º–∏ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏. –†–∞–∑–±–µ—Ä—ë–º –µ—â—ë –æ–¥–∏–Ω –ø—Ä–∏–º–µ—Ä - –ø–æ–∏—Å–∫ –Ω–æ–º–µ—Ä–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å–∫–æ–±–æ—á–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.\n–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–∫–æ–±–æ—á–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –°–∫–æ–±–æ—á–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å - —ç—Ç–æ –ª—é–±–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏–º–≤–æ–ª–æ–≤ ‚Äò(‚Äô (–æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞) –∏ ‚Äò)‚Äô (–∑–∞–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞).\n–ë–∞–ª–∞–Ω—Å–æ–º —Å–∫–æ–±–æ—á–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±—É–¥–µ–º –Ω–∞–∑—ã–≤–∞—Ç—å —Ä–∞–∑–Ω–æ—Å—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—Ç–∫—Ä—ã–≤–∞—é—â–∏—Ö –∏ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏—Ö —Å–∫–æ–±–æ–∫ –≤ –Ω–µ–π.\n–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–∫–æ–±–æ—á–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–ü–°–ü) - —ç—Ç–æ —Ç–∞–∫–∞—è —Å–∫–æ–±–æ—á–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑ $2 n$ —Å–∏–º–≤–æ–ª–æ–≤, —á—Ç–æ –±–∞–ª–∞–Ω—Å –ª—é–±–æ–≥–æ –µ—ë –ø—Ä–µ—Ñ–∏–∫—Å–∞ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–µ–Ω, –∞ –±–∞–ª–∞–Ω—Å –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–≤–µ–Ω –Ω—É–ª—é. –ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å–ø–∏—Å–æ–∫ –ü–°–ü –¥–ª–∏–Ω—ã 8:\n$$ \\begin{array}{|c|c|c|c|} \\hline 0 \u0026 ((()))) \u0026 7 \u0026 (())(()) \\\\ \\hline 1 \u0026 ((()())) \u0026 8 \u0026 (())()() \\\\ \\hline 2 \u0026 ((())()) \u0026 9 \u0026 ()((())) \\\\ \\hline 3 \u0026 ((()))() \u0026 10 \u0026 ()(()()) \\\\ \\hline 4 \u0026 (()(())) \u0026 11 \u0026 ()(())() \\\\ \\hline 5 \u0026 (()()()) \u0026 12 \u0026 ()()(()) \\\\ \\hline 6 \u0026 (()())() \u0026 13 \u0026 ()()()() \\\\ \\hline \\end{array} $$–ù–æ–º–µ—Ä –ø–æ –ü–°–ü –ë—É–¥–µ–º –∏—Å–∫–∞—Ç—å –Ω–æ–º–µ—Ä –ü–°–ü –∞ –¥–ª–∏–Ω—ã $2 n$ —Ç–µ–º –∂–µ –º–µ—Ç–æ–¥–æ–º: –ø—É—Å—Ç—å $b$ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –º–µ–Ω—å—à–µ $a$, –ø—Ä–∏—á—ë–º $b_{1}=a_{1}, \\ldots, b_{k-1}=a_{k-1}$; ‚Äò(‚Äô $\\left.=b_{k} \u003c a_{k}={ }^{\\prime}\\right)^{\\prime}$. –°–∫–æ–ª—å–∫–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç–∞–∫–∏—Ö –ü–°–ü $b$ ?\n–ü–æ—Å–∫–æ–ª—å–∫—É –±–∞–ª–∞–Ω—Å –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ—Ñ–∏–∫—Å–∞ $b$ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–µ–Ω, –±–∞–ª–∞–Ω—Å –∫–∞–∂–¥–æ–≥–æ —Å—É—Ñ—Ñ–∏–∫—Å–∞ $b$ –Ω–µ–ø–æ–ª–æ–∂–∏—Ç–µ–ª–µ–Ω. –¢–æ–≥–¥–∞, –µ—Å–ª–∏ –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å —Å—É—Ñ—Ñ–∏–∫—Å $b_{k+1}, \\ldots, b_{2 n}$ –∏ –∑–∞–º–µ–Ω–∏—Ç—å –æ—Ç–∫—Ä—ã–≤–∞—é—â–∏–µ —Å–∫–æ–±–∫–∏ –Ω–∞ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–µ, –∞ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–µ - –Ω–∞ –æ—Ç–∫—Ä—ã–≤–∞—é—â–∏–µ, —Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è —Å–∫–æ–±–æ—á–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª–∏–Ω—ã $2 n-k$, –±–∞–ª–∞–Ω—Å –ª—é–±–æ–≥–æ –ø—Ä–µ—Ñ–∏–∫—Å–∞ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–µ–Ω, –∞ –±–∞–ª–∞–Ω—Å –µ—ë —Ü–µ–ª–∏–∫–æ–º —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –±–∞–ª–∞–Ω—Å–æ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ $b_{1}, \\ldots, b_{k}$. –ü—Ä–µ–¥–ø–æ–¥—Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–∫–∏—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –¥–ª—è –∫–∞–∂–¥–æ–π –¥–ª–∏–Ω—ã –∏ –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º (–ø–µ—Ä–µ—Ö–æ–¥ - –ø–µ—Ä–µ–±–æ—Ä —Ç–∏–ø–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∫–æ–±–∫–∏).\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 fill(cnt, 0) for l = 1..(2 * MAXN): for b = 0..l: cnt[l, b] = cnt[l - 1, b + 1] # –∑–∞–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞ if b \u003e 0: cnt[l, b] += cnt[l - 1, b - 1] # –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞ getNum(a, n): num = 0 b = 0 # –±–∞–ª–∞–Ω—Å for k = 1..(2 * n): if a[k] == ')': num += cnt[2 * n - k, b + 1] b -= 1 else: b += 1 return num –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ –Ω–æ–º–µ—Ä—É –í–µ—Ä–Ω—ë–º—Å—è –∫ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞–º –∏ —Ä–µ—à–∏–º –æ–±—Ä–∞—Ç–Ω—É—é –∑–∞–¥–∞—á—É: –ø—É—Å—Ç—å –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫—É, –∏–º–µ—é—â—É—é –∑–∞–¥–∞–Ω–Ω—ã–π –Ω–æ–º–µ—Ä num –≤ —Å–ø–∏—Å–∫–µ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫ –¥–ª–∏–Ω—ã $n$.\n–î–ª—è –ª—é–±–æ–≥–æ $x$ –æ—Ç 1 –¥–æ $n$ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ( $n-1$ )! –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫, –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö—Å—è —Å $x$. –¢–æ–≥–¥–∞ –ø–µ—Ä–≤—ã–π —Å–∏–º–≤–æ–ª –∏—Å–∫–æ–º–æ–π –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ - –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ $x$ —Ç–∞–∫–æ–µ, —á—Ç–æ $x \\cdot(n-1)!\u003en u m$. –û—Å—Ç–∞—ë—Ç—Å—è –Ω–∞–π—Ç–∏ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫—É —Å –Ω–æ–º–µ—Ä–æ–º $n u m-x \\cdot(n-1)$ ! –≤ —Å–ø–∏—Å–∫–µ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫, –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö—Å—è —Å $x$. –î–ª—è —ç—Ç–æ–≥–æ –±—É–¥–µ–º –ø–æ–≤—Ç–æ—Ä—è—Ç—å —Ç–µ –∂–µ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è, –Ω–æ –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ (–≤—Ç–æ—Ä–æ–≥–æ, —Ç—Ä–µ—Ç—å–µ–≥–æ, –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ; –Ω–∞–¥–æ –Ω–µ –∑–∞–±—ã—Ç—å, —á—Ç–æ –æ–¥–∏–Ω —Å–∏–º–≤–æ–ª –Ω–µ –º–æ–∂–µ—Ç –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å—Å—è –≤ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑).\n1 2 3 4 5 6 7 8 9 10 11 12 getPermutation(num, n): fill(used, False) vector\u003cint\u003e p for k = 1..n: for x = 1..n: if used[x]: continue if num \u003c factorial[n - k]: p.push_back(x), used[x] = True break num -= factorial[n - k] return p –¢–æ—Ç –∂–µ –º–µ—Ç–æ–¥ –æ–ø—è—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Å–æ –º–Ω–æ–≥–∏–º–∏ –¥—Ä—É–≥–∏–º–∏ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏. –í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞ –≤–µ—Ä–Ω—ë–º—Å—è –∫ –ü–°–ü.\n–ü–°–ü –ø–æ –Ω–æ–º–µ—Ä—É –ë—É–¥–µ–º —Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –æ—á–µ—Ä–µ–¥–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –æ—Ç–∫—Ä—ã–≤–∞—é—â—É—é —Å–∫–æ–±–∫—É, –µ—Å–ª–∏ –Ω–æ–º–µ—Ä –ü–°–ü –º–µ–Ω—å—à–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–ø–æ—Å–æ–±–æ–≤ –∑–∞–∫–æ–Ω—á–∏—Ç—å –ü–°–ü –ø–æ—Å–ª–µ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —ç—Ç–æ–π —Å–∫–æ–±–∫–∏; –∏–Ω–∞—á–µ –±—É–¥–µ–º —Å—Ç–∞–≤–∏—Ç—å –∑–∞–∫—Ä—ã–≤–∞—é—â—É—é —Å–∫–æ–±–∫—É –∏ —É–º–µ–Ω—å—à–∞—Ç—å –Ω–æ–º–µ—Ä –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ ‚Äú–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö‚Äù –ü–°–ü (—Ç–µ—Ö, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞ —ç—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏ —Å—Ç–æ–∏—Ç –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞).\n1 2 3 4 5 6 7 8 9 10 getCBS(num, n): b = 0 vector\u003cchar\u003e a for k = 1..(2 * n): if num \u003c cnt[2 * n - k, b + 1]: a.push_back('('), b += 1 else: num -= cnt[2 * n - k, b + 1] a.push_back(')'), b -= 1 return a",
    "description": "–ù–∞—É—á–∏–º—Å—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω–æ–º—É –æ–±—ä–µ–∫—Ç—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–µ) –µ–≥–æ –Ω–æ–º–µ—Ä –≤ —Å–ø–∏—Å–∫–µ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (—Å–ø–∏—Å–∫–µ –≤—Å–µ—Ö –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã), —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–æ–º –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏; –∏–ª–∏, –Ω–∞–æ–±–æ—Ä–æ—Ç, –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç –ø–æ –µ–≥–æ –Ω–æ–º–µ—Ä—É.\n–≠—Ç–æ –±—ã–≤–∞–µ—Ç –ø–æ–ª–µ–∑–Ω–æ, –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç –∫–∞–∫ –º–æ–∂–Ω–æ –º–µ–Ω—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –±–∏—Ç, –∞ —Ç–∞–∫–∂–µ –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏–Ω–¥–µ–∫—Å–∞ –º–∞—Å—Å–∏–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –º–µ—Ç–æ–¥–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º).\n–ù–æ–º–µ—Ä –ø–æ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–µ –ö–∞–∫ –≤—ã—á–∏—Å–ª–∏—Ç—å –Ω–æ–º–µ—Ä –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ $p_{1}, \\ldots, p_{n}$ —á–∏—Å–µ–ª $1, \\ldots, n$ –≤ —Å–ø–∏—Å–∫–µ –≤—Å–µ—Ö –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫ –¥–ª–∏–Ω—ã $n$, —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã—Ö –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏? –ù–∞–ø—Ä–∏–º–µ—Ä, —É –Ω–∞—Å –µ—Å—Ç—å —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫ –¥–ª–∏–Ω—ã 3:",
    "tags": [],
    "title": "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞ –ø–æ –æ–±—ä–µ–∫—Ç—É –∏ –æ–±—ä–µ–∫—Ç–∞ –ø–æ –Ω–æ–º–µ—Ä—É",
    "uri": "/basics/dynamic_programming/generate_number_by_object/index.html"
  },
  {
    "breadcrumb": "",
    "content": "–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Å–∞–π—Ç —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ –∫—É—Ä—Å–∞ ‚Äú–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è‚Äù (–≤–µ—Å–µ–Ω–Ω–∏–π —Å–µ–º–µ—Å—Ç—Ä 2025/26 —É—á–µ–±–Ω–æ–≥–æ –≥–æ–¥–∞).\n–û –∫—É—Ä—Å–µ –ö—É—Ä—Å —á–∏—Ç–∞–µ—Ç—Å—è –Ω–∞ –∫–∞—Ñ–µ–¥—Ä–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞ –ø—Ä–∏–∫–ª–∞–¥–Ω—ã—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥—Å–∫–æ–≥–æ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞.\n–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –≤–∫–ª—é—á–∞—é—Ç 79 –≤–æ–ø—Ä–æ—Å–æ–≤ –∫ —ç–∫–∑–∞–º–µ–Ω—É, –æ—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏—Ö —Å–ª–µ–¥—É—é—â–∏–µ —Ç–µ–º—ã:\n–ê–Ω–∞–ª–∏–∑ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –ë–∞–∑–æ–≤—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –ê–ª–≥–æ—Ä–∏—Ç–º—ã —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ –ø–æ–∏—Å–∫–∞ –î–≤–æ–∏—á–Ω—ã–µ –∫—É—á–∏ –∏ —Ö–µ—à-—Ç–∞–±–ª–∏—Ü—ã –ß–∏—Å–ª–µ–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è –ê–ª–≥–æ—Ä–∏—Ç–º—ã –Ω–∞ –≥—Ä–∞—Ñ–∞—Ö –ñ–∞–¥–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ù–∞–≤–∏–≥–∞—Ü–∏—è –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—é —Å–ª–µ–≤–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –Ω—É–∂–Ω–æ–º—É —Ä–∞–∑–¥–µ–ª—É. –ö–∞–∂–¥—ã–π —Ä–∞–∑–¥–µ–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, —Ç–µ–æ—Ä–µ–º—ã —Å –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞–º–∏ –∏ –ø—Ä–∏–º–µ—Ä—ã.\n–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: —Ñ–µ–≤—Ä–∞–ª—å 2026",
    "description": "–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Å–∞–π—Ç —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ –∫—É—Ä—Å–∞ ‚Äú–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è‚Äù (–≤–µ—Å–µ–Ω–Ω–∏–π —Å–µ–º–µ—Å—Ç—Ä 2025/26 —É—á–µ–±–Ω–æ–≥–æ –≥–æ–¥–∞).\n–û –∫—É—Ä—Å–µ –ö—É—Ä—Å —á–∏—Ç–∞–µ—Ç—Å—è –Ω–∞ –∫–∞—Ñ–µ–¥—Ä–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞ –ø—Ä–∏–∫–ª–∞–¥–Ω—ã—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥—Å–∫–æ–≥–æ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞.\n–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –≤–∫–ª—é—á–∞—é—Ç 79 –≤–æ–ø—Ä–æ—Å–æ–≤ –∫ —ç–∫–∑–∞–º–µ–Ω—É, –æ—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏—Ö —Å–ª–µ–¥—É—é—â–∏–µ —Ç–µ–º—ã:",
    "tags": [],
    "title": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è",
    "uri": "/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è",
    "content": "",
    "description": "",
    "tags": [],
    "title": "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏",
    "uri": "/categories/index.html"
  },
  {
    "breadcrumb": "–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è",
    "content": "",
    "description": "",
    "tags": [],
    "title": "–¢–µ–≥–∏",
    "uri": "/tags/index.html"
  }
]
